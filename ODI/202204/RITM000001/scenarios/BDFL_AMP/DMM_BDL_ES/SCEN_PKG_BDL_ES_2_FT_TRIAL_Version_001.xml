<?xml version="1.0" encoding="ISO-8859-1"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.09" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="MOdAQXkudYsNEL70WfqsOlIdOYo/KQYKtfY1U9eNHYQ=" keyVect="rP9SF0TAfhQPjAcESk9ddg==" exportKeySalt="06744a49-cc30-4d89-8312-f6ce2bcc0d60" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpScen">
		<Field name="CecSessBehavior" type="java.lang.String">null</Field>
	<Field name="CecSessPollIntv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-06-07 16:04:27.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[TST_AGALLI]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[87e91f33-bacd-421c-b684-04b519a919bd]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndPromptParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="IsMaterialized" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IDeploySpec" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IMapping" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IPackage" type="com.sunopsis.sql.DbInt"><![CDATA[9241]]></Field>
	<Field name="IPop" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScenFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtScen" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-06-07 16:04:51.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[TST_AGALLI]]></Field>
	<Field name="MaxCecSess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="RestartType" type="java.lang.String">null</Field>
	<Field name="ScenName" type="java.lang.String"><![CDATA[PKG_BDL_ES_2_FT_TRIAL]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenSnapshotNo" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="ScenVersion" type="java.lang.String"><![CDATA[001]]></Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7d0a0a47-c86f-4e3c-8097-3d2fa7938063]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[243754]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-10-01 19:13:06.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[322]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-10-01 19:18:28.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9899bb17-3c4d-4958-a9e8-2beab6ffaebb]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[235926]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-13 22:18:46.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[438]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-13 22:26:04.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[acbe84d5-53b2-4c85-bf41-6886e07fe955]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[577766]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[577766]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[457056]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-18 18:03:20.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[823]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-18 18:17:03.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b99868c9-a139-469c-8d35-f43d15bdaa66]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[577854]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[577854]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[459018]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-27 14:29:34.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[699]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-27 14:41:13.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1d6e8f2f-5edf-42d6-b7cc-ec19832401f4]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[577847]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[577847]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[458329]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-25 11:38:13.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[733]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-25 11:50:26.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1918854c-2a47-4358-a2be-37fcbfe7749b]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[235682]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-13 11:25:34.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[466]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-13 11:33:20.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ca927d22-f253-475a-b765-e8a363a1d32c]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[878426]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[878426]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[460271]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-06-06 15:46:09.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[924]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-06-06 16:01:33.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[dc0032c5-fc34-46a2-9ad6-6d830b477564]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[235981]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-14 08:37:25.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[471]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-14 08:45:16.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b01423db-f743-45cf-b6e1-78ff24cea5b0]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[243848]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-10-04 11:22:45.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[343]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-10-04 11:28:28.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3fe4a234-d93d-4adb-997d-fb9cd08d1ea2]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233483]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 15:09:41.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1618]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 15:36:39.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c7d5bf6f-d0d0-407b-9af8-07d73b2ab6b8]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[232966]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-06-25 17:40:13.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[493]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-06-25 17:48:26.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[39f6872e-1792-48be-a9f7-9e339397f6a7]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233496]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 17:49:16.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[557]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 17:58:33.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[df88ffaf-ff6f-4b93-9b74-14b63ab6e6f7]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[782620]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[782620]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[449688]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-04-04 10:09:39.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[437]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-04-04 10:16:56.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fba80d6c-f5ab-4e8f-a4c7-5937cfeee830]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233414]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 08:27:47.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[696]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 08:39:23.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d291b1c0-51e0-4b12-aca1-323ba2782d4a]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233547]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 20:15:03.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[733]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 20:27:16.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String"><![CDATA[ODI-1217: Session PKG_BDL_ES_2_FT_TRIAL (232965) fails with return code ODI-1298.
ODI-1226: Step MAP_ES_FT_TRIAL fails after 1 attempt(s).
ODI-1240: Flow MAP_ES_FT_TRIAL fails while performing a Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- operation. This flow loads target table FT_TRIAL.
ODI-1298: Serial task "SERIAL-MAP_MAIN- (40)" failed because child task "SERIAL-EU-LOG_MKT_REP_BDFL_UNIT (70)" is in error.
ODI-1298: Serial task "SERIAL-EU-LOG_MKT_REP_BDFL_UNIT (70)" failed because child task "Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- (120)" is in error.
ODI-1228: Task Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- fails on the target connection PHY_BDFL_DMM_ES.
Caused By: java.sql.SQLSyntaxErrorException: ORA-02149: Specified partition does not exist

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:510)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:462)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1105)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:551)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:269)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:656)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:230)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:42)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:929)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1280)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1921)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1876)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:304)
	at oracle.odi.runtime.agent.execution.sql.SQLCommand.execute(SQLCommand.java:208)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:142)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:28)
	at oracle.odi.runtime.agent.execution.TaskExecutionHandler.handleTask(TaskExecutionHandler.java:52)
	at oracle.odi.runtime.agent.execution.SessionTask.processTask(SessionTask.java:217)
	at oracle.odi.runtime.agent.execution.SessionTask.doExecuteTask(SessionTask.java:129)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.execute(AbstractSessionTask.java:886)
	at oracle.odi.runtime.agent.execution.SessionExecutor$SerialTrain.runTasks(SessionExecutor.java:2224)
	at oracle.odi.runtime.agent.execution.SessionExecutor.executeSession(SessionExecutor.java:610)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:718)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:611)
	at oracle.odi.core.persistence.dwgobject.DwgObjectTemplate.execute(DwgObjectTemplate.java:203)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor.doProcessStartAgentTask(TaskExecutorAgentRequestProcessor.java:800)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor.access$2700(StartScenRequestProcessor.java:85)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor$StartScenTask.doExecute(StartScenRequestProcessor.java:917)
	at oracle.odi.runtime.agent.processor.task.AgentTask.execute(AgentTask.java:180)
	at oracle.odi.runtime.agent.support.DefaultAgentTaskExecutor$2.run(DefaultAgentTaskExecutor.java:108)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at oracle.odi.runtime.agent.execution.job.OdiJob.call(OdiJob.java:73)
	at oracle.odi.runtime.agent.execution.job.OdiJob.call(OdiJob.java:73)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: Error : 2149, Position : 0, Sql = 
insert /*+ APPEND */ into	DMM_BDL_ANL.FT_TRIAL
 PARTITION(P_ES)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	ORDER_DATE_DT,
	ORDER_NUMBER_ID,
	ORDER_TYPE_CODE_CD,
	ORDER_LINE_NUMBER_ID,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIATYPE_HK,
	TEST_RESULT_HK,
	MARKET_TYPE_HK,
	PRODUCT_HK,
	DOCUMENT_HK,
	PRODUCT_HST_SK,
	CREATION_DATE_SK,
	DELIVERY_DATE_SK,
	CANCELLATION_DATE_SK,
	RETURN_DATE_SK,
	HOLD_DATE_SK,
	SALE_DATE_SK,
	D51_CREATION_DATE_DT,
	D130_DELIVERY_DATE_DT,
	D131_CANCELLATION_DATE_DT,
	D132_RETURN_DATE_DT,
	D133_HOLD_DATE_DT,
	D133_SALE_DATE_DT,
	D134_REASON_CODE_CD,
	D41_DOCUMENT_STATUS_CD,
	D40_UPDATE_STATUS_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	D_SIDE_CODE_CD,
	M8_CLIENT_ID,
	M7_DOCUMENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M6_TRIAL_QT,
	M_VAT_AM,
	M9_UNIT_LISTPRICE_NET_AM,
	M326_UNIT_PROP_PRICE_NET_AM,
	M326_UNIT_PROP_PRICE_GROSS_AM,
	M326_UNIT_CALC_PRICE_NET_AM,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	ITR_CANDIDATE_FL,
	ITR_DOCUMENT_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	PREVIOUS_DOCUMENT_DT,
	PREVIOUS_DOCUMENT_NUMBER_ID,
	PREVIOUS_DOCUMENT_TYPE_CD,
	PREVIOUS_DOCUMENT_CLOSING_DT,
	TRIAL_WITH_UP_FL 
) 
select
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	ORDER_DATE_DT,
	ORDER_NUMBER_ID,
	ORDER_TYPE_CODE_CD,
	ORDER_LINE_NUMBER_ID,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIATYPE_HK,
	TEST_RESULT_HK,
	MARKET_TYPE_HK,
	PRODUCT_HK,
	DOCUMENT_HK,
	PRODUCT_HST_SK,
	CREATION_DATE_SK,
	DELIVERY_DATE_SK,
	CANCELLATION_DATE_SK,
	RETURN_DATE_SK,
	HOLD_DATE_SK,
	SALE_DATE_SK,
	D51_CREATION_DATE_DT,
	D130_DELIVERY_DATE_DT,
	D131_CANCELLATION_DATE_DT,
	D132_RETURN_DATE_DT,
	D133_HOLD_DATE_DT,
	D133_SALE_DATE_DT,
	D134_REASON_CODE_CD,
	D41_DOCUMENT_STATUS_CD,
	D40_UPDATE_STATUS_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	D_SIDE_CODE_CD,
	M8_CLIENT_ID,
	M7_DOCUMENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M6_TRIAL_QT,
	M_VAT_AM,
	M9_UNIT_LISTPRICE_NET_AM,
	M326_UNIT_PROP_PRICE_NET_AM,
	M326_UNIT_PROP_PRICE_GROSS_AM,
	M326_UNIT_CALC_PRICE_NET_AM,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	ITR_CANDIDATE_FL,
	ITR_DOCUMENT_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	PREVIOUS_DOCUMENT_DT,
	PREVIOUS_DOCUMENT_NUMBER_ID,
	PREVIOUS_DOCUMENT_TYPE_CD,
	PREVIOUS_DOCUMENT_CLOSING_DT,
	TRIAL_WITH_UP_FL   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	231589 X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'MAP_ES_FT_TRIAL' || ' (' || 'CTX_ES' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_5.COMPANY_CD_1 X_AUD_COMPANY_CD,
	INLINE_VIEW_5.COMPANY_CD_1 COMPANY_CD,
	INLINE_VIEW_5.DIVISION_CD_1 DIVISION_CD,
	INLINE_VIEW_5.ORDER_DATE_DT ORDER_DATE_DT,
	INLINE_VIEW_5.ORDER_NUMBER_ID ORDER_NUMBER_ID,
	INLINE_VIEW_5.ORDER_TYPE_CODE_CD ORDER_TYPE_CODE_CD,
	INLINE_VIEW_5.ORDER_LINE_NUMBER_ID ORDER_LINE_NUMBER_ID,
	STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1|| DM_SHOP.DIVISION_CD) COMPANY_HK,
	CASE
  WHEN INLINE_VIEW_5.MASTER_CUSTOMER_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_5.MASTER_COMPANY_CD || INLINE_VIEW_5.MASTER_DIVISION_CD || INLINE_VIEW_5.MASTER_CUSTOMER_CD ) 
  ELSE STANDARD_HASH ('-1')
END CUSTOMER_HK,
	NVL(FT_CUSTOMER_BASE.CLC_STATUS_HK,'D961F70D39EE00CF78D4D476B80EF3AD5ABE128C') CLC_STATUS_HK,
	INLINE_VIEW_5.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_5.COL_3 SHOP_HK,
	CASE
  WHEN INLINE_VIEW_5.DAYCENTER_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.DAYCENTER_CODE|| INLINE_VIEW_5.SHOP_CODE)
  ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_5.LOCATION_TYPE_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.LOCATION_TYPE_CODE)
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_5.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1|| INLINE_VIEW_5.DIVISION_CD_1|| INLINE_VIEW_5.EMPLOYEE_CD|| INLINE_VIEW_5.SHOP_CD)
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_5.PROMOTER_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE ||INLINE_VIEW_5.PROMOTER_CODE|| INLINE_VIEW_5.SHOP_CODE)
  ELSE STANDARD_HASH ('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_5.CAMPAIGN_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.CAMPAIGN_CODE )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_5.MEDIATYPE_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.MEDIATYPE_CODE)
  ELSE STANDARD_HASH ('-1')
END MEDIATYPE_HK,
	STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1 || INLINE_VIEW_5.DIVISION_CD_1
||
CASE WHEN INLINE_VIEW_5.TESTRESULT_LEFT IN('IN','ND') THEN '-1'
ELSE COALESCE( INLINE_VIEW_5.TESTRESULT_LEFT, '-1')
END
||
CASE WHEN INLINE_VIEW_5.TESTRESULT_RIGHT IN('IN','ND') THEN '-1'
ELSE COALESCE( INLINE_VIEW_5.TESTRESULT_RIGHT, '-1')
END
) TEST_RESULT_HK,
	CASE
  WHEN INLINE_VIEW_5.MARKET_TYPE_CD IS NOT NULL
  THEN 
  (STANDARD_HASH(INLINE_VIEW_5.COMPANY_CD_1||INLINE_VIEW_5.DIVISION_CD_1
  ||
  CASE 
   WHEN 
    INLINE_VIEW_5.DOCUMENT_NUMBER_REF_ID IS NULL and INLINE_VIEW_5.MARKET_TYPE_CD ='11'  
   THEN 'ML'
   WHEN
    INLINE_VIEW_5.MARKET_TYPE_CD ='14'  
   THEN 'MS'
   WHEN
    INLINE_VIEW_5.DOCUMENT_NUMBER_REF_ID IS NOT NULL and INLINE_VIEW_5.MARKET_TYPE_CD ='11'
   THEN 'MRL'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='MR'
   THEN 'MRS'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='15'
   THEN 'MI'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='12'
   THEN 'MIL'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='RI'
   THEN 'MIS'
   else INLINE_VIEW_5.MARKET_TYPE_CD 
  end))
  ELSE STANDARD_HASH ('-1')
END MARKET_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1 || INLINE_VIEW_5.DIVISION_CD_1|| INLINE_VIEW_5.PRODUCT_CD) PRODUCT_HK,
	CASE
WHEN (INLINE_VIEW_5.COMPANY_CD_1 IS NOT NULL) AND (INLINE_VIEW_5.DIVISION_CD_1 IS NOT NULL) AND (INLINE_VIEW_5.ORDER_DATE_DT IS NOT NULL)
  AND (INLINE_VIEW_5.ORDER_NUMBER_ID IS NOT NULL) AND (INLINE_VIEW_5.ORDER_TYPE_CODE_CD IS NOT NULL)
THEN STANDARD_HASH (INLINE_VIEW_5.COMPANY_CD_1||INLINE_VIEW_5.DIVISION_CD_1||INLINE_VIEW_5.ORDER_DATE_DT||INLINE_VIEW_5.ORDER_NUMBER_ID||INLINE_VIEW_5.ORDER_TYPE_CODE_CD)
ELSE
STANDARD_HASH (-1)
END DOCUMENT_HK,
	INLINE_VIEW_5.PRODUCT_HST_SK PRODUCT_HST_SK,
	extract (year from INLINE_VIEW_5.CREATION_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.CREATION_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.CREATION_DATE_DT) CREATION_DATE_SK,
	extract (year from INLINE_VIEW_5.DELIVERY_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.DELIVERY_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.DELIVERY_DATE_DT) DELIVERY_DATE_SK,
	extract (year from INLINE_VIEW_5.CANCELLATION_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.CANCELLATION_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.CANCELLATION_DATE_DT) CANCELLATION_DATE_SK,
	extract (year from INLINE_VIEW_5.RETURN_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.RETURN_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.RETURN_DATE_DT) RETURN_DATE_SK,
	extract (year from INLINE_VIEW_5.HOLD_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.HOLD_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.HOLD_DATE_DT) HOLD_DATE_SK,
	extract (year from INLINE_VIEW_5.SALE_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.SALE_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.SALE_DATE_DT) SALE_DATE_SK,
	TRUNC(INLINE_VIEW_5.CREATION_DATE_DT) D51_CREATION_DATE_DT,
	TRUNC(INLINE_VIEW_5.DELIVERY_DATE_DT) D130_DELIVERY_DATE_DT,
	TRUNC(INLINE_VIEW_5.CANCELLATION_DATE_DT) D131_CANCELLATION_DATE_DT,
	TRUNC(INLINE_VIEW_5.RETURN_DATE_DT) D132_RETURN_DATE_DT,
	TRUNC(INLINE_VIEW_5.HOLD_DATE_DT) D133_HOLD_DATE_DT,
	TRUNC(INLINE_VIEW_5.SALE_DATE_DT) D133_SALE_DATE_DT,
	INLINE_VIEW_5.REASON_CD D134_REASON_CODE_CD,
	INLINE_VIEW_5.STATUS_CD D41_DOCUMENT_STATUS_CD,
	TRUNC(INLINE_VIEW_5.UPDATE_STATUS_DT) D40_UPDATE_STATUS_DATE_DT,
	FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	INLINE_VIEW_5.COL_4 D_CLC_REFERENCE_DATE_DT,
	INLINE_VIEW_5.SIDE_CD D_SIDE_CODE_CD,
	INLINE_VIEW_5.MASTER_COMPANY_CD|| INLINE_VIEW_5.MASTER_DIVISION_CD|| INLINE_VIEW_5.MASTER_CUSTOMER_CD M8_CLIENT_ID,
	INLINE_VIEW_5.COMPANY_CD_1||INLINE_VIEW_5.DIVISION_CD_1||TO_CHAR(INLINE_VIEW_5.ORDER_DATE_DT,'YYYYMMDD')||INLINE_VIEW_5.ORDER_NUMBER_ID||INLINE_VIEW_5.ORDER_TYPE_CODE_CD M7_DOCUMENT_ID,
	CASE WHEN INLINE_VIEW_5.CREATION_DATE_DT IS NOT NULL THEN
INLINE_VIEW_5.MASTER_COMPANY_CD||
INLINE_VIEW_5.MASTER_DIVISION_CD||
INLINE_VIEW_5.MASTER_CUSTOMER_CD||
INLINE_VIEW_5.SHOP_CD||
TO_CHAR(INLINE_VIEW_5.CREATION_DATE_DT,'YYYYMM')
ELSE NULL
END M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_5.QUANTITY_QT M6_TRIAL_QT,
	INLINE_VIEW_5.VAT_RT M_VAT_AM,
	INLINE_VIEW_5.LIST_PRICE_AMOUNT_AM*INLINE_VIEW_5.QUANTITY_QT M9_UNIT_LISTPRICE_NET_AM,
	INLINE_VIEW_5.NET_AMOUNT_AM M326_UNIT_PROP_PRICE_NET_AM,
	INLINE_VIEW_5.GROSS_AMOUNT_AM M326_UNIT_PROP_PRICE_GROSS_AM,
	INLINE_VIEW_5.NET_AMOUNT_CALCULATED_AM M326_UNIT_CALC_PRICE_NET_AM,
	CASE
  WHEN DM_SHOP.D_SHOP_ORIGIN_CD='A' AND  INLINE_VIEW_5.CREATION_DATE_DT>= DM_SHOP.D_START_DATE_DT  AND INLINE_VIEW_5.CREATION_DATE_DT<= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, -12)
      THEN 1 
  WHEN DM_SHOP.D_SHOP_ORIGIN_CD='N' AND INLINE_VIEW_5.CREATION_DATE_DT>= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) AND INLINE_VIEW_5.CREATION_DATE_DT<= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, - 12)
      THEN 1 
  ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL THEN 0 ELSE NULL END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE
    WHEN DM_SHOP.D_SHOP_ORIGIN_CD='A' AND INLINE_VIEW_5.CREATION_DATE_DT>= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) AND INLINE_VIEW_5.CREATION_DATE_DT<= DM_SHOP.D_END_DATE_DT 
         THEN 1
    WHEN DM_SHOP.D_SHOP_ORIGIN_CD='N' AND INLINE_VIEW_5.CREATION_DATE_DT>= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 24) AND INLINE_VIEW_5.CREATION_DATE_DT <= DM_SHOP.D_END_DATE_DT 
        THEN 1 
    ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL THEN 0 ELSE NULL END
END M_SAME_STORE_GROWTH_CY_FL,
	1 ITR_CANDIDATE_FL,
	CASE WHEN TRUNC(INLINE_VIEW_5.DELIVERY_DATE_DT)= TRUNC(INLINE_VIEW_5.CREATION_DATE_DT) AND INLINE_VIEW_5.MASTER_COMPANY_CD IS NOT NULL THEN 1 
ELSE 0
END ITR_DOCUMENT_FL,
	FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	FT_CUSTOMER_BASE.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	FT_CUSTOMER_BASE.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	FT_CUSTOMER_BASE.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE 
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) IS NULL 
            THEN NULL
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT)
    ELSE 3651
END TEST_AGEING_SK,
	CASE 
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) IS NULL 
            THEN NULL
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT)
    ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_DT PREVIOUS_DOCUMENT_DT,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_NUMBER_ID PREVIOUS_DOCUMENT_NUMBER_ID,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_TYPE_CD PREVIOUS_DOCUMENT_TYPE_CD,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_CLOSING_DT PREVIOUS_DOCUMENT_CLOSING_DT,
	CASE
  WHEN INLINE_VIEW_5.PREVIOUS_DOCUMENT_TYPE_CD IN ('UP','UR', 'UA', 'UV')
  THEN 1
  ELSE 0
END TRIAL_WITH_UP_FL 
from	DMM_BDL_ANL.FT_CUSTOMER_BASE PARTITION(P_ES) FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW_4.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_4.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_4.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_4.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_4.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_4.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_4.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_4.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_4.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_4.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_4.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_4.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_4.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_4.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_4.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_4.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_4.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_4.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_4.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_4.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_4.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW_4.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW_4.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_4.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_4.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_4.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW_4.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW_4.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW_4.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW_4.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW_4.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW_4.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW_4.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW_4.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW_4.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW_4.COL AS COL ,
  INLINE_VIEW_4.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_4.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_4.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_4.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_4.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_4.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_4.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_4.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_4.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_4.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_4.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_4.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_4.REASON_CD AS REASON_CD ,
  INLINE_VIEW_4.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_4.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_4.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_4.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_4.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_4.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_4.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_4.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_4.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_4.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_4.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_4.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_4.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_4.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_4.VAT_RT AS VAT_RT ,
  INLINE_VIEW_4.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_4.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_4.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_4.COL_1 AS COL_1 ,
  INLINE_VIEW_4.X_AUD_FROM_TS_1 AS X_AUD_FROM_TS_1 ,
  INLINE_VIEW_4.X_AUD_TO_TS_1 AS X_AUD_TO_TS_1 ,
  INLINE_VIEW_4.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  INLINE_VIEW_4.PRODUCT_HK AS PRODUCT_HK ,
  INLINE_VIEW_4.COL_2 AS COL_2 ,
  INLINE_VIEW_4.COL_3 AS COL_3 ,
  INLINE_VIEW_4.COL_4 AS COL_4   
FROM 
  (
SELECT 
  INLINE_VIEW_3.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_3.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_3.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_3.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_3.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_3.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_3.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_3.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_3.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_3.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_3.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_3.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_3.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_3.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_3.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_3.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_3.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_3.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_3.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_3.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW_3.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW_3.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_3.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_3.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_3.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW_3.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW_3.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW_3.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW_3.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW_3.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW_3.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW_3.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW_3.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW_3.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW_3.COL AS COL ,
  INLINE_VIEW_3.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_3.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_3.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_3.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_3.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_3.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_3.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_3.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_3.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_3.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_3.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_3.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_3.REASON_CD AS REASON_CD ,
  INLINE_VIEW_3.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_3.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_3.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_3.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_3.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_3.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_3.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_3.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_3.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_3.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_3.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_3.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_3.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_3.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_3.VAT_RT AS VAT_RT ,
  INLINE_VIEW_3.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_3.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_3.COL_1 AS COL_1 ,
  DM_PRODUCT_HST_1.X_AUD_FROM_TS AS X_AUD_FROM_TS_1 ,
  DM_PRODUCT_HST_1.X_AUD_TO_TS AS X_AUD_TO_TS_1 ,
  DM_PRODUCT_HST_1.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  DM_PRODUCT_HST_1.PRODUCT_HK AS PRODUCT_HK ,
  ROW_NUMBER() 
OVER 
(PARTITION BY
INLINE_VIEW_3.COMPANY_CD_1,
INLINE_VIEW_3.DIVISION_CD_1,
INLINE_VIEW_3.ORDER_DATE_DT,
INLINE_VIEW_3.ORDER_NUMBER_ID,
INLINE_VIEW_3.ORDER_TYPE_CODE_CD,
INLINE_VIEW_3.ORDER_LINE_NUMBER_ID
ORDER BY INLINE_VIEW_3.X_AUD_FROM_TS, DM_PRODUCT_HST_1.X_AUD_FROM_TS) AS COL_2 ,
  CASE
  WHEN INLINE_VIEW_3.SHOP_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_3.COMPANY_CD_1|| INLINE_VIEW_3.DIVISION_CD_1|| INLINE_VIEW_3.SHOP_CD)
  ELSE STANDARD_HASH ('-1')
END AS COL_3 ,
  CASE 
  WHEN INLINE_VIEW_3.STATUS_ID = 6 
    THEN TRUNC(INLINE_VIEW_3.CREATION_DATE_DT) - 1
    ELSE TRUNC(INLINE_VIEW_3.CREATION_DATE_DT) - 30
END AS COL_4   
FROM 
  (
SELECT 
  DM_PRODUCT_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_PRODUCT_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_PRODUCT_HST.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  DM_PRODUCT_HST.PRODUCT_HK AS PRODUCT_HK   
FROM 
  DMM_BDL_ANL.DM_PRODUCT_HST PARTITION(P_ES) DM_PRODUCT_HST  
  ) DM_PRODUCT_HST_1  RIGHT OUTER JOIN  (
SELECT 
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.D15_COMPANY_CD AS D15_COMPANY_CD ,
  DM_CUSTOMER_HST.D15_DIVISION_CD AS D15_DIVISION_CD ,
  DM_CUSTOMER_HST.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_1.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_1.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_1.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_1.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_1.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_2.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_2.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_2.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_2.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_2.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_2.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_2.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_2.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW_2.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW_2.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_2.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_2.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_2.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW_2.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW_2.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW_2.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW_2.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW_2.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW_2.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW_2.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW_2.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW_2.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW_2.COL AS COL ,
  INLINE_VIEW_2.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_2.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_2.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_2.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_2.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_2.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_2.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  INLINE_VIEW_2.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_2.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_2.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_2.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_2.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_2.REASON_CD AS REASON_CD ,
  INLINE_VIEW_2.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_2.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_2.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_2.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_2.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_2.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_2.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_2.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_2.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_2.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_2.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_2.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_2.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_2.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_2.VAT_RT AS VAT_RT ,
  INLINE_VIEW_2.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_2.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_2.COL_1 AS COL_1   
FROM 
  DMM_BDL_ANL.DM_CUSTOMER_HST PARTITION(P_ES) DM_CUSTOMER_HST  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW.REASON_CD AS REASON_CD ,
  INLINE_VIEW.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW.VAT_RT AS VAT_RT ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW.COL_1 AS COL_1   
FROM 
  (
SELECT 
  ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT1_1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  ALL_ACTIVITY_ES_TT1_1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  ALL_ACTIVITY_ES_TT1_1.DT_INSERT AS DT_INSERT ,
  ALL_ACTIVITY_ES_TT1_1.IS_TEST_FL AS IS_TEST_FL ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT_2.COMPANY_CODE AS COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT_2.DIVISION_CODE AS DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT_2.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT_2.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT_2.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT_2.ACTIVITY_DATE AS ACTIVITY_DATE_1 ,
  ALL_ACTIVITY_ES_TT_2.CUSTOMER_CODE AS CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT_2.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  ALL_ACTIVITY_ES_TT_2.PROMOTER_CODE AS PROMOTER_CODE ,
  ALL_ACTIVITY_ES_TT_2.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  ALL_ACTIVITY_ES_TT_2.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  ALL_ACTIVITY_ES_TT_2.DAYCENTER_CODE AS DAYCENTER_CODE ,
  ALL_ACTIVITY_ES_TT_2.REFERENCE_DATE AS REFERENCE_DATE ,
  ALL_ACTIVITY_ES_TT_2.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  ALL_ACTIVITY_ES_TT_2.IS_TRIAL_FL AS IS_TRIAL_FL ,
  ALL_ACTIVITY_ES_TT_2.COL AS COL ,
  FT_TRIAL_ES_TT.COMPANY_CD AS COMPANY_CD ,
  FT_TRIAL_ES_TT.DIVISION_CD AS DIVISION_CD ,
  FT_TRIAL_ES_TT.ORDER_DATE_DT AS ORDER_DATE_DT ,
  FT_TRIAL_ES_TT.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  FT_TRIAL_ES_TT.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  FT_TRIAL_ES_TT.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  FT_TRIAL_ES_TT.CUSTOMER_CD AS CUSTOMER_CD ,
  FT_TRIAL_ES_TT.SHOP_CD AS SHOP_CD ,
  FT_TRIAL_ES_TT.PRODUCT_CD AS PRODUCT_CD ,
  FT_TRIAL_ES_TT.STATUS_CD AS STATUS_CD ,
  FT_TRIAL_ES_TT.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FT_TRIAL_ES_TT.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  FT_TRIAL_ES_TT.REASON_CD AS REASON_CD ,
  FT_TRIAL_ES_TT.SIDE_CD AS SIDE_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  FT_TRIAL_ES_TT.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  FT_TRIAL_ES_TT.CREATION_DATE_DT AS CREATION_DATE_DT ,
  FT_TRIAL_ES_TT.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  FT_TRIAL_ES_TT.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  FT_TRIAL_ES_TT.RETURN_DATE_DT AS RETURN_DATE_DT ,
  FT_TRIAL_ES_TT.HOLD_DATE_DT AS HOLD_DATE_DT ,
  FT_TRIAL_ES_TT.SALE_DATE_DT AS SALE_DATE_DT ,
  FT_TRIAL_ES_TT.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  FT_TRIAL_ES_TT.QUANTITY_QT AS QUANTITY_QT ,
  FT_TRIAL_ES_TT.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  FT_TRIAL_ES_TT.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  FT_TRIAL_ES_TT.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  FT_TRIAL_ES_TT.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  FT_TRIAL_ES_TT.VAT_RT AS VAT_RT ,
  FT_TRIAL_ES_TT.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FT_TRIAL_ES_TT.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  ROW_NUMBER() over(partition by 
                  FT_TRIAL_ES_TT.MASTER_COMPANY_CD
                 ,FT_TRIAL_ES_TT.MASTER_DIVISION_CD
                 ,FT_TRIAL_ES_TT.ORDER_DATE_DT
                 ,FT_TRIAL_ES_TT.ORDER_NUMBER_ID
                 ,FT_TRIAL_ES_TT.ORDER_TYPE_CODE_CD
                 ,FT_TRIAL_ES_TT.ORDER_LINE_NUMBER_ID 
                 order by ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE  desc, ALL_ACTIVITY_ES_TT1_1.DT_INSERT DESC) AS COL_1   
FROM 
  (BDFL.FTB_TRIAL_BASE PARTITION(P_ES_PT) FT_TRIAL_ES_TT  LEFT OUTER JOIN  (
SELECT 
  ALL_ACTIVITY_ES_TT_1.COMPANY_CODE AS COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT_1.DIVISION_CODE AS DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT_1.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT_1.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT_1.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT_1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT_1.CUSTOMER_CODE AS CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT_1.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  ALL_ACTIVITY_ES_TT_1.PROMOTER_CODE AS PROMOTER_CODE ,
  ALL_ACTIVITY_ES_TT_1.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  ALL_ACTIVITY_ES_TT_1.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  ALL_ACTIVITY_ES_TT_1.DAYCENTER_CODE AS DAYCENTER_CODE ,
  ALL_ACTIVITY_ES_TT_1.REFERENCE_DATE AS REFERENCE_DATE ,
  ALL_ACTIVITY_ES_TT_1.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  ALL_ACTIVITY_ES_TT_1.IS_TRIAL_FL AS IS_TRIAL_FL ,
  ALL_ACTIVITY_ES_TT_1.COL AS COL   
FROM 
  (
SELECT 
  ALL_ACTIVITY_ES_TT.COMPANY_CODE AS COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT.DIVISION_CODE AS DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT.CUSTOMER_CODE AS CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  ALL_ACTIVITY_ES_TT.PROMOTER_CODE AS PROMOTER_CODE ,
  ALL_ACTIVITY_ES_TT.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  ALL_ACTIVITY_ES_TT.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  ALL_ACTIVITY_ES_TT.DAYCENTER_CODE AS DAYCENTER_CODE ,
  ALL_ACTIVITY_ES_TT.REFERENCE_DATE AS REFERENCE_DATE ,
  ALL_ACTIVITY_ES_TT.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  ALL_ACTIVITY_ES_TT.IS_TRIAL_FL AS IS_TRIAL_FL ,
  rank() over(partition by  ALL_ACTIVITY_ES_TT.REFERENCE_DATE , 
ALL_ACTIVITY_ES_TT.REFERENCE_NUMBER   
order by ALL_ACTIVITY_ES_TT.ACTIVITY_DATE  desc,ALL_ACTIVITY_ES_TT.ACTIVITY_ID desc, ALL_ACTIVITY_ES_TT.LAPTOP_CODE, ALL_ACTIVITY_ES_TT.SHOP_CODE, ALL_ACTIVITY_ES_TT.CUSTOMER_CODE) AS COL   
FROM 
  STG_BDFL_ES.ALL_ACTIVITY_ES_TT ALL_ACTIVITY_ES_TT  
WHERE
  (ALL_ACTIVITY_ES_TT.IS_TRIAL_FL=1
) 
  ) ALL_ACTIVITY_ES_TT_1  
WHERE
  (ALL_ACTIVITY_ES_TT_1.COL = 1
) 
  ) ALL_ACTIVITY_ES_TT_2  
    ON  ALL_ACTIVITY_ES_TT_2.COMPANY_CODE = FT_TRIAL_ES_TT.COMPANY_CD 
and ALL_ACTIVITY_ES_TT_2.DIVISION_CODE = FT_TRIAL_ES_TT.DIVISION_CD 
and ALL_ACTIVITY_ES_TT_2.REFERENCE_DATE = FT_TRIAL_ES_TT.ORDER_DATE_DT 
and ALL_ACTIVITY_ES_TT_2.REFERENCE_NUMBER = FT_TRIAL_ES_TT.ORDER_NUMBER_ID
     )  LEFT OUTER JOIN  (
SELECT 
  ALL_ACTIVITY_ES_TT1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  ALL_ACTIVITY_ES_TT1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  ALL_ACTIVITY_ES_TT1.DT_INSERT AS DT_INSERT ,
  ALL_ACTIVITY_ES_TT1.IS_TEST_FL AS IS_TEST_FL ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE   
FROM 
  STG_BDFL_ES.ALL_ACTIVITY_ES_TT ALL_ACTIVITY_ES_TT1  
WHERE
  (ALL_ACTIVITY_ES_TT1.IS_TEST_FL=1
) 
  ) ALL_ACTIVITY_ES_TT1_1  
    ON  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_COMPANY_CODE = FT_TRIAL_ES_TT.MASTER_COMPANY_CD AND
ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_DIVISION_CODE = FT_TRIAL_ES_TT.MASTER_DIVISION_CD AND
ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_CODE = FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD AND
ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE <= FT_TRIAL_ES_TT.CREATION_DATE_DT
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_1=1
) 
  ) INLINE_VIEW_2  LEFT OUTER JOIN  (
SELECT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMAP_.DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMAP_.CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD)) AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  EDW.CL_LIGHT_CUSTOMER_STATUS PARTITION(P_ES) CL_LIGHT_CUSTOMER_STATUS_RMAP_  INNER JOIN  EDW.UM_CU_S_CUSTOMER_MAPPING PARTITION(P_ES_PT) UM_CU_S_CUSTOMER_MAPPING_RMAP_  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) AND   (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) INLINE_VIEW_1  
    ON  INLINE_VIEW_2.MASTER_COMPANY_CD = INLINE_VIEW_1.COMPANY_CD AND
INLINE_VIEW_2.MASTER_DIVISION_CD = INLINE_VIEW_1.DIVISION_CD AND
INLINE_VIEW_2.MASTER_CUSTOMER_CD = INLINE_VIEW_1.CUSTOMER_CD AND
INLINE_VIEW_2.CREATION_DATE_DT - 1 >= INLINE_VIEW_1.STATUS_FROM_DT AND
INLINE_VIEW_2.CREATION_DATE_DT - 1 < NVL(INLINE_VIEW_1.STATUS_TO_DT, TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  
    ON  INLINE_VIEW_2.MASTER_COMPANY_CD = DM_CUSTOMER_HST.D15_COMPANY_CD
AND
INLINE_VIEW_2.MASTER_DIVISION_CD = DM_CUSTOMER_HST.D15_DIVISION_CD
AND
INLINE_VIEW_2.MASTER_CUSTOMER_CD = DM_CUSTOMER_HST.D15_CUSTOMER_CD
AND
TRUNC(
COALESCE(
INLINE_VIEW_2.SALE_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.RETURN_DATE_DT,INLINE_VIEW_2.DELIVERY_DATE_DT,INLINE_VIEW_2.CANCELLATION_DATE_DT,INLINE_VIEW_2.CREATION_DATE_DT)) 
>= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) 
AND
TRUNC(
COALESCE(
INLINE_VIEW_2.SALE_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.RETURN_DATE_DT,INLINE_VIEW_2.DELIVERY_DATE_DT,INLINE_VIEW_2.CANCELLATION_DATE_DT,INLINE_VIEW_2.CREATION_DATE_DT))
<=  TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW_3  
    ON  STANDARD_HASH(INLINE_VIEW_3.COMPANY_CD_1||INLINE_VIEW_3.DIVISION_CD_1||INLINE_VIEW_3.SHOP_CD)=DM_PRODUCT_HST_1.PRODUCT_HK
AND
TRUNC(
COALESCE(
INLINE_VIEW_3.SALE_DATE_DT,INLINE_VIEW_3.HOLD_DATE_DT,INLINE_VIEW_3.RETURN_DATE_DT,INLINE_VIEW_3.DELIVERY_DATE_DT,INLINE_VIEW_3.CANCELLATION_DATE_DT,INLINE_VIEW_3.CREATION_DATE_DT)) 
>= TRUNC(DM_PRODUCT_HST_1.X_AUD_FROM_TS) 
AND
TRUNC(
COALESCE(
INLINE_VIEW_3.SALE_DATE_DT,INLINE_VIEW_3.HOLD_DATE_DT,INLINE_VIEW_3.HOLD_DATE_DT,INLINE_VIEW_3.DELIVERY_DATE_DT,INLINE_VIEW_3.CANCELLATION_DATE_DT,INLINE_VIEW_3.CREATION_DATE_DT))
<=  TRUNC(DM_PRODUCT_HST_1.X_AUD_TO_TS)
  ) INLINE_VIEW_4  
WHERE
  (INLINE_VIEW_4.COL_2 = 1
) 
  ) INLINE_VIEW_5  LEFT OUTER JOIN  DMM_BDL_ANL.DM_SHOP PARTITION(P_ES) DM_SHOP  
    ON  INLINE_VIEW_5.COL_3 = DM_SHOP.SHOP_HK
     )  
    ON  INLINE_VIEW_5.COMPANY_CD_1=FT_CUSTOMER_BASE.COMPANY_CD
AND
INLINE_VIEW_5.DIVISION_CD_1=FT_CUSTOMER_BASE.DIVISION_CD
AND
INLINE_VIEW_5.CUSTOMER_CD_1=FT_CUSTOMER_BASE.CUSTOMER_CD
AND
TRUNC(INLINE_VIEW_5.COL_4) >= FT_CUSTOMER_BASE.VALID_FROM_DT
AND
TRUNC(INLINE_VIEW_5.COL_4) < FT_CUSTOMER_BASE.VALID_TO_DT
where		(1=1)	
)  ODI_GET_FROM
   , OriginalSql =  
insert /*+ APPEND */ into	DMM_BDL_ANL.FT_TRIAL
 PARTITION(P_ES)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	ORDER_DATE_DT,
	ORDER_NUMBER_ID,
	ORDER_TYPE_CODE_CD,
	ORDER_LINE_NUMBER_ID,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIATYPE_HK,
	TEST_RESULT_HK,
	MARKET_TYPE_HK,
	PRODUCT_HK,
	DOCUMENT_HK,
	PRODUCT_HST_SK,
	CREATION_DATE_SK,
	DELIVERY_DATE_SK,
	CANCELLATION_DATE_SK,
	RETURN_DATE_SK,
	HOLD_DATE_SK,
	SALE_DATE_SK,
	D51_CREATION_DATE_DT,
	D130_DELIVERY_DATE_DT,
	D131_CANCELLATION_DATE_DT,
	D132_RETURN_DATE_DT,
	D133_HOLD_DATE_DT,
	D133_SALE_DATE_DT,
	D134_REASON_CODE_CD,
	D41_DOCUMENT_STATUS_CD,
	D40_UPDATE_STATUS_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	D_SIDE_CODE_CD,
	M8_CLIENT_ID,
	M7_DOCUMENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M6_TRIAL_QT,
	M_VAT_AM,
	M9_UNIT_LISTPRICE_NET_AM,
	M326_UNIT_PROP_PRICE_NET_AM,
	M326_UNIT_PROP_PRICE_GROSS_AM,
	M326_UNIT_CALC_PRICE_NET_AM,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	ITR_CANDIDATE_FL,
	ITR_DOCUMENT_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	PREVIOUS_DOCUMENT_DT,
	PREVIOUS_DOCUMENT_NUMBER_ID,
	PREVIOUS_DOCUMENT_TYPE_CD,
	PREVIOUS_DOCUMENT_CLOSING_DT,
	TRIAL_WITH_UP_FL 
) 
select
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	ORDER_DATE_DT,
	ORDER_NUMBER_ID,
	ORDER_TYPE_CODE_CD,
	ORDER_LINE_NUMBER_ID,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIATYPE_HK,
	TEST_RESULT_HK,
	MARKET_TYPE_HK,
	PRODUCT_HK,
	DOCUMENT_HK,
	PRODUCT_HST_SK,
	CREATION_DATE_SK,
	DELIVERY_DATE_SK,
	CANCELLATION_DATE_SK,
	RETURN_DATE_SK,
	HOLD_DATE_SK,
	SALE_DATE_SK,
	D51_CREATION_DATE_DT,
	D130_DELIVERY_DATE_DT,
	D131_CANCELLATION_DATE_DT,
	D132_RETURN_DATE_DT,
	D133_HOLD_DATE_DT,
	D133_SALE_DATE_DT,
	D134_REASON_CODE_CD,
	D41_DOCUMENT_STATUS_CD,
	D40_UPDATE_STATUS_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	D_SIDE_CODE_CD,
	M8_CLIENT_ID,
	M7_DOCUMENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M6_TRIAL_QT,
	M_VAT_AM,
	M9_UNIT_LISTPRICE_NET_AM,
	M326_UNIT_PROP_PRICE_NET_AM,
	M326_UNIT_PROP_PRICE_GROSS_AM,
	M326_UNIT_CALC_PRICE_NET_AM,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	ITR_CANDIDATE_FL,
	ITR_DOCUMENT_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	PREVIOUS_DOCUMENT_DT,
	PREVIOUS_DOCUMENT_NUMBER_ID,
	PREVIOUS_DOCUMENT_TYPE_CD,
	PREVIOUS_DOCUMENT_CLOSING_DT,
	TRIAL_WITH_UP_FL   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	231589 X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'MAP_ES_FT_TRIAL' || ' (' || 'CTX_ES' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_5.COMPANY_CD_1 X_AUD_COMPANY_CD,
	INLINE_VIEW_5.COMPANY_CD_1 COMPANY_CD,
	INLINE_VIEW_5.DIVISION_CD_1 DIVISION_CD,
	INLINE_VIEW_5.ORDER_DATE_DT ORDER_DATE_DT,
	INLINE_VIEW_5.ORDER_NUMBER_ID ORDER_NUMBER_ID,
	INLINE_VIEW_5.ORDER_TYPE_CODE_CD ORDER_TYPE_CODE_CD,
	INLINE_VIEW_5.ORDER_LINE_NUMBER_ID ORDER_LINE_NUMBER_ID,
	STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1|| DM_SHOP.DIVISION_CD) COMPANY_HK,
	CASE
  WHEN INLINE_VIEW_5.MASTER_CUSTOMER_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_5.MASTER_COMPANY_CD || INLINE_VIEW_5.MASTER_DIVISION_CD || INLINE_VIEW_5.MASTER_CUSTOMER_CD ) 
  ELSE STANDARD_HASH ('-1')
END CUSTOMER_HK,
	NVL(FT_CUSTOMER_BASE.CLC_STATUS_HK,'D961F70D39EE00CF78D4D476B80EF3AD5ABE128C') CLC_STATUS_HK,
	INLINE_VIEW_5.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_5.COL_3 SHOP_HK,
	CASE
  WHEN INLINE_VIEW_5.DAYCENTER_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.DAYCENTER_CODE|| INLINE_VIEW_5.SHOP_CODE)
  ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_5.LOCATION_TYPE_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.LOCATION_TYPE_CODE)
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_5.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1|| INLINE_VIEW_5.DIVISION_CD_1|| INLINE_VIEW_5.EMPLOYEE_CD|| INLINE_VIEW_5.SHOP_CD)
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_5.PROMOTER_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE ||INLINE_VIEW_5.PROMOTER_CODE|| INLINE_VIEW_5.SHOP_CODE)
  ELSE STANDARD_HASH ('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_5.CAMPAIGN_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.CAMPAIGN_CODE )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_5.MEDIATYPE_CODE IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_5.COMPANY_CODE|| INLINE_VIEW_5.DIVISION_CODE|| INLINE_VIEW_5.MEDIATYPE_CODE)
  ELSE STANDARD_HASH ('-1')
END MEDIATYPE_HK,
	STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1 || INLINE_VIEW_5.DIVISION_CD_1
||
CASE WHEN INLINE_VIEW_5.TESTRESULT_LEFT IN('IN','ND') THEN '-1'
ELSE COALESCE( INLINE_VIEW_5.TESTRESULT_LEFT, '-1')
END
||
CASE WHEN INLINE_VIEW_5.TESTRESULT_RIGHT IN('IN','ND') THEN '-1'
ELSE COALESCE( INLINE_VIEW_5.TESTRESULT_RIGHT, '-1')
END
) TEST_RESULT_HK,
	CASE
  WHEN INLINE_VIEW_5.MARKET_TYPE_CD IS NOT NULL
  THEN 
  (STANDARD_HASH(INLINE_VIEW_5.COMPANY_CD_1||INLINE_VIEW_5.DIVISION_CD_1
  ||
  CASE 
   WHEN 
    INLINE_VIEW_5.DOCUMENT_NUMBER_REF_ID IS NULL and INLINE_VIEW_5.MARKET_TYPE_CD ='11'  
   THEN 'ML'
   WHEN
    INLINE_VIEW_5.MARKET_TYPE_CD ='14'  
   THEN 'MS'
   WHEN
    INLINE_VIEW_5.DOCUMENT_NUMBER_REF_ID IS NOT NULL and INLINE_VIEW_5.MARKET_TYPE_CD ='11'
   THEN 'MRL'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='MR'
   THEN 'MRS'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='15'
   THEN 'MI'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='12'
   THEN 'MIL'
   WHEN INLINE_VIEW_5.MARKET_TYPE_CD ='RI'
   THEN 'MIS'
   else INLINE_VIEW_5.MARKET_TYPE_CD 
  end))
  ELSE STANDARD_HASH ('-1')
END MARKET_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_5.COMPANY_CD_1 || INLINE_VIEW_5.DIVISION_CD_1|| INLINE_VIEW_5.PRODUCT_CD) PRODUCT_HK,
	CASE
WHEN (INLINE_VIEW_5.COMPANY_CD_1 IS NOT NULL) AND (INLINE_VIEW_5.DIVISION_CD_1 IS NOT NULL) AND (INLINE_VIEW_5.ORDER_DATE_DT IS NOT NULL)
  AND (INLINE_VIEW_5.ORDER_NUMBER_ID IS NOT NULL) AND (INLINE_VIEW_5.ORDER_TYPE_CODE_CD IS NOT NULL)
THEN STANDARD_HASH (INLINE_VIEW_5.COMPANY_CD_1||INLINE_VIEW_5.DIVISION_CD_1||INLINE_VIEW_5.ORDER_DATE_DT||INLINE_VIEW_5.ORDER_NUMBER_ID||INLINE_VIEW_5.ORDER_TYPE_CODE_CD)
ELSE
STANDARD_HASH (-1)
END DOCUMENT_HK,
	INLINE_VIEW_5.PRODUCT_HST_SK PRODUCT_HST_SK,
	extract (year from INLINE_VIEW_5.CREATION_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.CREATION_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.CREATION_DATE_DT) CREATION_DATE_SK,
	extract (year from INLINE_VIEW_5.DELIVERY_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.DELIVERY_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.DELIVERY_DATE_DT) DELIVERY_DATE_SK,
	extract (year from INLINE_VIEW_5.CANCELLATION_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.CANCELLATION_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.CANCELLATION_DATE_DT) CANCELLATION_DATE_SK,
	extract (year from INLINE_VIEW_5.RETURN_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.RETURN_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.RETURN_DATE_DT) RETURN_DATE_SK,
	extract (year from INLINE_VIEW_5.HOLD_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.HOLD_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.HOLD_DATE_DT) HOLD_DATE_SK,
	extract (year from INLINE_VIEW_5.SALE_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_5.SALE_DATE_DT)*100
+  extract (day from INLINE_VIEW_5.SALE_DATE_DT) SALE_DATE_SK,
	TRUNC(INLINE_VIEW_5.CREATION_DATE_DT) D51_CREATION_DATE_DT,
	TRUNC(INLINE_VIEW_5.DELIVERY_DATE_DT) D130_DELIVERY_DATE_DT,
	TRUNC(INLINE_VIEW_5.CANCELLATION_DATE_DT) D131_CANCELLATION_DATE_DT,
	TRUNC(INLINE_VIEW_5.RETURN_DATE_DT) D132_RETURN_DATE_DT,
	TRUNC(INLINE_VIEW_5.HOLD_DATE_DT) D133_HOLD_DATE_DT,
	TRUNC(INLINE_VIEW_5.SALE_DATE_DT) D133_SALE_DATE_DT,
	INLINE_VIEW_5.REASON_CD D134_REASON_CODE_CD,
	INLINE_VIEW_5.STATUS_CD D41_DOCUMENT_STATUS_CD,
	TRUNC(INLINE_VIEW_5.UPDATE_STATUS_DT) D40_UPDATE_STATUS_DATE_DT,
	FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	INLINE_VIEW_5.COL_4 D_CLC_REFERENCE_DATE_DT,
	INLINE_VIEW_5.SIDE_CD D_SIDE_CODE_CD,
	INLINE_VIEW_5.MASTER_COMPANY_CD|| INLINE_VIEW_5.MASTER_DIVISION_CD|| INLINE_VIEW_5.MASTER_CUSTOMER_CD M8_CLIENT_ID,
	INLINE_VIEW_5.COMPANY_CD_1||INLINE_VIEW_5.DIVISION_CD_1||TO_CHAR(INLINE_VIEW_5.ORDER_DATE_DT,'YYYYMMDD')||INLINE_VIEW_5.ORDER_NUMBER_ID||INLINE_VIEW_5.ORDER_TYPE_CODE_CD M7_DOCUMENT_ID,
	CASE WHEN INLINE_VIEW_5.CREATION_DATE_DT IS NOT NULL THEN
INLINE_VIEW_5.MASTER_COMPANY_CD||
INLINE_VIEW_5.MASTER_DIVISION_CD||
INLINE_VIEW_5.MASTER_CUSTOMER_CD||
INLINE_VIEW_5.SHOP_CD||
TO_CHAR(INLINE_VIEW_5.CREATION_DATE_DT,'YYYYMM')
ELSE NULL
END M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_5.QUANTITY_QT M6_TRIAL_QT,
	INLINE_VIEW_5.VAT_RT M_VAT_AM,
	INLINE_VIEW_5.LIST_PRICE_AMOUNT_AM*INLINE_VIEW_5.QUANTITY_QT M9_UNIT_LISTPRICE_NET_AM,
	INLINE_VIEW_5.NET_AMOUNT_AM M326_UNIT_PROP_PRICE_NET_AM,
	INLINE_VIEW_5.GROSS_AMOUNT_AM M326_UNIT_PROP_PRICE_GROSS_AM,
	INLINE_VIEW_5.NET_AMOUNT_CALCULATED_AM M326_UNIT_CALC_PRICE_NET_AM,
	CASE
  WHEN DM_SHOP.D_SHOP_ORIGIN_CD='A' AND  INLINE_VIEW_5.CREATION_DATE_DT>= DM_SHOP.D_START_DATE_DT  AND INLINE_VIEW_5.CREATION_DATE_DT<= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, -12)
      THEN 1 
  WHEN DM_SHOP.D_SHOP_ORIGIN_CD='N' AND INLINE_VIEW_5.CREATION_DATE_DT>= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) AND INLINE_VIEW_5.CREATION_DATE_DT<= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, - 12)
      THEN 1 
  ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL THEN 0 ELSE NULL END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE
    WHEN DM_SHOP.D_SHOP_ORIGIN_CD='A' AND INLINE_VIEW_5.CREATION_DATE_DT>= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) AND INLINE_VIEW_5.CREATION_DATE_DT<= DM_SHOP.D_END_DATE_DT 
         THEN 1
    WHEN DM_SHOP.D_SHOP_ORIGIN_CD='N' AND INLINE_VIEW_5.CREATION_DATE_DT>= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 24) AND INLINE_VIEW_5.CREATION_DATE_DT <= DM_SHOP.D_END_DATE_DT 
        THEN 1 
    ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL THEN 0 ELSE NULL END
END M_SAME_STORE_GROWTH_CY_FL,
	1 ITR_CANDIDATE_FL,
	CASE WHEN TRUNC(INLINE_VIEW_5.DELIVERY_DATE_DT)= TRUNC(INLINE_VIEW_5.CREATION_DATE_DT) AND INLINE_VIEW_5.MASTER_COMPANY_CD IS NOT NULL THEN 1 
ELSE 0
END ITR_DOCUMENT_FL,
	FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	FT_CUSTOMER_BASE.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	FT_CUSTOMER_BASE.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	FT_CUSTOMER_BASE.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE 
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) IS NULL 
            THEN NULL
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT)
    ELSE 3651
END TEST_AGEING_SK,
	CASE 
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) IS NULL 
            THEN NULL
 WHEN  TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_5.COL_4) - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT)
    ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_DT PREVIOUS_DOCUMENT_DT,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_NUMBER_ID PREVIOUS_DOCUMENT_NUMBER_ID,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_TYPE_CD PREVIOUS_DOCUMENT_TYPE_CD,
	INLINE_VIEW_5.PREVIOUS_DOCUMENT_CLOSING_DT PREVIOUS_DOCUMENT_CLOSING_DT,
	CASE
  WHEN INLINE_VIEW_5.PREVIOUS_DOCUMENT_TYPE_CD IN ('UP','UR', 'UA', 'UV')
  THEN 1
  ELSE 0
END TRIAL_WITH_UP_FL 
from	DMM_BDL_ANL.FT_CUSTOMER_BASE PARTITION(P_ES) FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW_4.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_4.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_4.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_4.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_4.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_4.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_4.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_4.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_4.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_4.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_4.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_4.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_4.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_4.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_4.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_4.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_4.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_4.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_4.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_4.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_4.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW_4.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW_4.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_4.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_4.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_4.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW_4.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW_4.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW_4.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW_4.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW_4.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW_4.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW_4.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW_4.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW_4.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW_4.COL AS COL ,
  INLINE_VIEW_4.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_4.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_4.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_4.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_4.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_4.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_4.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_4.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_4.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_4.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_4.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_4.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_4.REASON_CD AS REASON_CD ,
  INLINE_VIEW_4.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_4.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_4.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_4.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_4.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_4.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_4.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_4.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_4.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_4.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_4.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_4.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_4.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_4.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_4.VAT_RT AS VAT_RT ,
  INLINE_VIEW_4.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_4.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_4.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_4.COL_1 AS COL_1 ,
  INLINE_VIEW_4.X_AUD_FROM_TS_1 AS X_AUD_FROM_TS_1 ,
  INLINE_VIEW_4.X_AUD_TO_TS_1 AS X_AUD_TO_TS_1 ,
  INLINE_VIEW_4.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  INLINE_VIEW_4.PRODUCT_HK AS PRODUCT_HK ,
  INLINE_VIEW_4.COL_2 AS COL_2 ,
  INLINE_VIEW_4.COL_3 AS COL_3 ,
  INLINE_VIEW_4.COL_4 AS COL_4   
FROM 
  (
SELECT 
  INLINE_VIEW_3.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_3.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_3.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_3.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_3.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_3.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_3.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_3.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_3.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_3.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_3.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_3.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_3.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_3.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_3.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_3.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_3.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_3.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_3.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_3.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW_3.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW_3.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_3.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_3.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_3.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW_3.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW_3.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW_3.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW_3.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW_3.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW_3.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW_3.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW_3.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW_3.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW_3.COL AS COL ,
  INLINE_VIEW_3.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_3.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_3.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_3.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_3.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_3.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_3.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_3.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_3.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_3.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_3.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_3.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_3.REASON_CD AS REASON_CD ,
  INLINE_VIEW_3.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_3.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_3.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_3.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_3.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_3.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_3.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_3.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_3.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_3.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_3.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_3.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_3.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_3.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_3.VAT_RT AS VAT_RT ,
  INLINE_VIEW_3.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_3.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_3.COL_1 AS COL_1 ,
  DM_PRODUCT_HST_1.X_AUD_FROM_TS AS X_AUD_FROM_TS_1 ,
  DM_PRODUCT_HST_1.X_AUD_TO_TS AS X_AUD_TO_TS_1 ,
  DM_PRODUCT_HST_1.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  DM_PRODUCT_HST_1.PRODUCT_HK AS PRODUCT_HK ,
  ROW_NUMBER() 
OVER 
(PARTITION BY
INLINE_VIEW_3.COMPANY_CD_1,
INLINE_VIEW_3.DIVISION_CD_1,
INLINE_VIEW_3.ORDER_DATE_DT,
INLINE_VIEW_3.ORDER_NUMBER_ID,
INLINE_VIEW_3.ORDER_TYPE_CODE_CD,
INLINE_VIEW_3.ORDER_LINE_NUMBER_ID
ORDER BY INLINE_VIEW_3.X_AUD_FROM_TS, DM_PRODUCT_HST_1.X_AUD_FROM_TS) AS COL_2 ,
  CASE
  WHEN INLINE_VIEW_3.SHOP_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_3.COMPANY_CD_1|| INLINE_VIEW_3.DIVISION_CD_1|| INLINE_VIEW_3.SHOP_CD)
  ELSE STANDARD_HASH ('-1')
END AS COL_3 ,
  CASE 
  WHEN INLINE_VIEW_3.STATUS_ID = 6 
    THEN TRUNC(INLINE_VIEW_3.CREATION_DATE_DT) - 1
    ELSE TRUNC(INLINE_VIEW_3.CREATION_DATE_DT) - 30
END AS COL_4   
FROM 
  (
SELECT 
  DM_PRODUCT_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_PRODUCT_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_PRODUCT_HST.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  DM_PRODUCT_HST.PRODUCT_HK AS PRODUCT_HK   
FROM 
  DMM_BDL_ANL.DM_PRODUCT_HST PARTITION(P_ES) DM_PRODUCT_HST  
  ) DM_PRODUCT_HST_1  RIGHT OUTER JOIN  (
SELECT 
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.D15_COMPANY_CD AS D15_COMPANY_CD ,
  DM_CUSTOMER_HST.D15_DIVISION_CD AS D15_DIVISION_CD ,
  DM_CUSTOMER_HST.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_1.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_1.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_1.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_1.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_1.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_2.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_2.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_2.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_2.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_2.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_2.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_2.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_2.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW_2.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW_2.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_2.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_2.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_2.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW_2.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW_2.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW_2.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW_2.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW_2.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW_2.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW_2.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW_2.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW_2.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW_2.COL AS COL ,
  INLINE_VIEW_2.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_2.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_2.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_2.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_2.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_2.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_2.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  INLINE_VIEW_2.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_2.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_2.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_2.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_2.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_2.REASON_CD AS REASON_CD ,
  INLINE_VIEW_2.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_2.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_2.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_2.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_2.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_2.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_2.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_2.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_2.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_2.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_2.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_2.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_2.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_2.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_2.VAT_RT AS VAT_RT ,
  INLINE_VIEW_2.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_2.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_2.COL_1 AS COL_1   
FROM 
  DMM_BDL_ANL.DM_CUSTOMER_HST PARTITION(P_ES) DM_CUSTOMER_HST  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW.COMPANY_CODE AS COMPANY_CODE ,
  INLINE_VIEW.DIVISION_CODE AS DIVISION_CODE ,
  INLINE_VIEW.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_1 AS ACTIVITY_DATE_1 ,
  INLINE_VIEW.CUSTOMER_CODE AS CUSTOMER_CODE ,
  INLINE_VIEW.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  INLINE_VIEW.PROMOTER_CODE AS PROMOTER_CODE ,
  INLINE_VIEW.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  INLINE_VIEW.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  INLINE_VIEW.DAYCENTER_CODE AS DAYCENTER_CODE ,
  INLINE_VIEW.REFERENCE_DATE AS REFERENCE_DATE ,
  INLINE_VIEW.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  INLINE_VIEW.IS_TRIAL_FL AS IS_TRIAL_FL ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW.REASON_CD AS REASON_CD ,
  INLINE_VIEW.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW.VAT_RT AS VAT_RT ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW.COL_1 AS COL_1   
FROM 
  (
SELECT 
  ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT1_1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  ALL_ACTIVITY_ES_TT1_1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  ALL_ACTIVITY_ES_TT1_1.DT_INSERT AS DT_INSERT ,
  ALL_ACTIVITY_ES_TT1_1.IS_TEST_FL AS IS_TEST_FL ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT_2.COMPANY_CODE AS COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT_2.DIVISION_CODE AS DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT_2.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT_2.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT_2.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT_2.ACTIVITY_DATE AS ACTIVITY_DATE_1 ,
  ALL_ACTIVITY_ES_TT_2.CUSTOMER_CODE AS CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT_2.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  ALL_ACTIVITY_ES_TT_2.PROMOTER_CODE AS PROMOTER_CODE ,
  ALL_ACTIVITY_ES_TT_2.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  ALL_ACTIVITY_ES_TT_2.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  ALL_ACTIVITY_ES_TT_2.DAYCENTER_CODE AS DAYCENTER_CODE ,
  ALL_ACTIVITY_ES_TT_2.REFERENCE_DATE AS REFERENCE_DATE ,
  ALL_ACTIVITY_ES_TT_2.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  ALL_ACTIVITY_ES_TT_2.IS_TRIAL_FL AS IS_TRIAL_FL ,
  ALL_ACTIVITY_ES_TT_2.COL AS COL ,
  FT_TRIAL_ES_TT.COMPANY_CD AS COMPANY_CD ,
  FT_TRIAL_ES_TT.DIVISION_CD AS DIVISION_CD ,
  FT_TRIAL_ES_TT.ORDER_DATE_DT AS ORDER_DATE_DT ,
  FT_TRIAL_ES_TT.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  FT_TRIAL_ES_TT.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  FT_TRIAL_ES_TT.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  FT_TRIAL_ES_TT.CUSTOMER_CD AS CUSTOMER_CD ,
  FT_TRIAL_ES_TT.SHOP_CD AS SHOP_CD ,
  FT_TRIAL_ES_TT.PRODUCT_CD AS PRODUCT_CD ,
  FT_TRIAL_ES_TT.STATUS_CD AS STATUS_CD ,
  FT_TRIAL_ES_TT.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FT_TRIAL_ES_TT.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  FT_TRIAL_ES_TT.REASON_CD AS REASON_CD ,
  FT_TRIAL_ES_TT.SIDE_CD AS SIDE_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  FT_TRIAL_ES_TT.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  FT_TRIAL_ES_TT.CREATION_DATE_DT AS CREATION_DATE_DT ,
  FT_TRIAL_ES_TT.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  FT_TRIAL_ES_TT.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  FT_TRIAL_ES_TT.RETURN_DATE_DT AS RETURN_DATE_DT ,
  FT_TRIAL_ES_TT.HOLD_DATE_DT AS HOLD_DATE_DT ,
  FT_TRIAL_ES_TT.SALE_DATE_DT AS SALE_DATE_DT ,
  FT_TRIAL_ES_TT.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  FT_TRIAL_ES_TT.QUANTITY_QT AS QUANTITY_QT ,
  FT_TRIAL_ES_TT.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  FT_TRIAL_ES_TT.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  FT_TRIAL_ES_TT.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  FT_TRIAL_ES_TT.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  FT_TRIAL_ES_TT.VAT_RT AS VAT_RT ,
  FT_TRIAL_ES_TT.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FT_TRIAL_ES_TT.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  ROW_NUMBER() over(partition by 
                  FT_TRIAL_ES_TT.MASTER_COMPANY_CD
                 ,FT_TRIAL_ES_TT.MASTER_DIVISION_CD
                 ,FT_TRIAL_ES_TT.ORDER_DATE_DT
                 ,FT_TRIAL_ES_TT.ORDER_NUMBER_ID
                 ,FT_TRIAL_ES_TT.ORDER_TYPE_CODE_CD
                 ,FT_TRIAL_ES_TT.ORDER_LINE_NUMBER_ID 
                 order by ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE  desc, ALL_ACTIVITY_ES_TT1_1.DT_INSERT DESC) AS COL_1   
FROM 
  (BDFL.FTB_TRIAL_BASE PARTITION(P_ES_PT) FT_TRIAL_ES_TT  LEFT OUTER JOIN  (
SELECT 
  ALL_ACTIVITY_ES_TT_1.COMPANY_CODE AS COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT_1.DIVISION_CODE AS DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT_1.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT_1.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT_1.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT_1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT_1.CUSTOMER_CODE AS CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT_1.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  ALL_ACTIVITY_ES_TT_1.PROMOTER_CODE AS PROMOTER_CODE ,
  ALL_ACTIVITY_ES_TT_1.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  ALL_ACTIVITY_ES_TT_1.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  ALL_ACTIVITY_ES_TT_1.DAYCENTER_CODE AS DAYCENTER_CODE ,
  ALL_ACTIVITY_ES_TT_1.REFERENCE_DATE AS REFERENCE_DATE ,
  ALL_ACTIVITY_ES_TT_1.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  ALL_ACTIVITY_ES_TT_1.IS_TRIAL_FL AS IS_TRIAL_FL ,
  ALL_ACTIVITY_ES_TT_1.COL AS COL   
FROM 
  (
SELECT 
  ALL_ACTIVITY_ES_TT.COMPANY_CODE AS COMPANY_CODE ,
  ALL_ACTIVITY_ES_TT.DIVISION_CODE AS DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT.CUSTOMER_CODE AS CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT.CAMPAIGN_CODE AS CAMPAIGN_CODE ,
  ALL_ACTIVITY_ES_TT.PROMOTER_CODE AS PROMOTER_CODE ,
  ALL_ACTIVITY_ES_TT.LOCATION_TYPE_CODE AS LOCATION_TYPE_CODE ,
  ALL_ACTIVITY_ES_TT.MEDIATYPE_CODE AS MEDIATYPE_CODE ,
  ALL_ACTIVITY_ES_TT.DAYCENTER_CODE AS DAYCENTER_CODE ,
  ALL_ACTIVITY_ES_TT.REFERENCE_DATE AS REFERENCE_DATE ,
  ALL_ACTIVITY_ES_TT.REFERENCE_NUMBER AS REFERENCE_NUMBER ,
  ALL_ACTIVITY_ES_TT.IS_TRIAL_FL AS IS_TRIAL_FL ,
  rank() over(partition by  ALL_ACTIVITY_ES_TT.REFERENCE_DATE , 
ALL_ACTIVITY_ES_TT.REFERENCE_NUMBER   
order by ALL_ACTIVITY_ES_TT.ACTIVITY_DATE  desc,ALL_ACTIVITY_ES_TT.ACTIVITY_ID desc, ALL_ACTIVITY_ES_TT.LAPTOP_CODE, ALL_ACTIVITY_ES_TT.SHOP_CODE, ALL_ACTIVITY_ES_TT.CUSTOMER_CODE) AS COL   
FROM 
  STG_BDFL_ES.ALL_ACTIVITY_ES_TT ALL_ACTIVITY_ES_TT  
WHERE
  (ALL_ACTIVITY_ES_TT.IS_TRIAL_FL=1
) 
  ) ALL_ACTIVITY_ES_TT_1  
WHERE
  (ALL_ACTIVITY_ES_TT_1.COL = 1
) 
  ) ALL_ACTIVITY_ES_TT_2  
    ON  ALL_ACTIVITY_ES_TT_2.COMPANY_CODE = FT_TRIAL_ES_TT.COMPANY_CD 
and ALL_ACTIVITY_ES_TT_2.DIVISION_CODE = FT_TRIAL_ES_TT.DIVISION_CD 
and ALL_ACTIVITY_ES_TT_2.REFERENCE_DATE = FT_TRIAL_ES_TT.ORDER_DATE_DT 
and ALL_ACTIVITY_ES_TT_2.REFERENCE_NUMBER = FT_TRIAL_ES_TT.ORDER_NUMBER_ID
     )  LEFT OUTER JOIN  (
SELECT 
  ALL_ACTIVITY_ES_TT1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  ALL_ACTIVITY_ES_TT1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  ALL_ACTIVITY_ES_TT1.DT_INSERT AS DT_INSERT ,
  ALL_ACTIVITY_ES_TT1.IS_TEST_FL AS IS_TEST_FL ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE   
FROM 
  STG_BDFL_ES.ALL_ACTIVITY_ES_TT ALL_ACTIVITY_ES_TT1  
WHERE
  (ALL_ACTIVITY_ES_TT1.IS_TEST_FL=1
) 
  ) ALL_ACTIVITY_ES_TT1_1  
    ON  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_COMPANY_CODE = FT_TRIAL_ES_TT.MASTER_COMPANY_CD AND
ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_DIVISION_CODE = FT_TRIAL_ES_TT.MASTER_DIVISION_CD AND
ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_CODE = FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD AND
ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE <= FT_TRIAL_ES_TT.CREATION_DATE_DT
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_1=1
) 
  ) INLINE_VIEW_2  LEFT OUTER JOIN  (
SELECT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMAP_.DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMAP_.CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD)) AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  EDW.CL_LIGHT_CUSTOMER_STATUS PARTITION(P_ES) CL_LIGHT_CUSTOMER_STATUS_RMAP_  INNER JOIN  EDW.UM_CU_S_CUSTOMER_MAPPING PARTITION(P_ES_PT) UM_CU_S_CUSTOMER_MAPPING_RMAP_  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) AND   (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) INLINE_VIEW_1  
    ON  INLINE_VIEW_2.MASTER_COMPANY_CD = INLINE_VIEW_1.COMPANY_CD AND
INLINE_VIEW_2.MASTER_DIVISION_CD = INLINE_VIEW_1.DIVISION_CD AND
INLINE_VIEW_2.MASTER_CUSTOMER_CD = INLINE_VIEW_1.CUSTOMER_CD AND
INLINE_VIEW_2.CREATION_DATE_DT - 1 >= INLINE_VIEW_1.STATUS_FROM_DT AND
INLINE_VIEW_2.CREATION_DATE_DT - 1 < NVL(INLINE_VIEW_1.STATUS_TO_DT, TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  
    ON  INLINE_VIEW_2.MASTER_COMPANY_CD = DM_CUSTOMER_HST.D15_COMPANY_CD
AND
INLINE_VIEW_2.MASTER_DIVISION_CD = DM_CUSTOMER_HST.D15_DIVISION_CD
AND
INLINE_VIEW_2.MASTER_CUSTOMER_CD = DM_CUSTOMER_HST.D15_CUSTOMER_CD
AND
TRUNC(
COALESCE(
INLINE_VIEW_2.SALE_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.RETURN_DATE_DT,INLINE_VIEW_2.DELIVERY_DATE_DT,INLINE_VIEW_2.CANCELLATION_DATE_DT,INLINE_VIEW_2.CREATION_DATE_DT)) 
>= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) 
AND
TRUNC(
COALESCE(
INLINE_VIEW_2.SALE_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.RETURN_DATE_DT,INLINE_VIEW_2.DELIVERY_DATE_DT,INLINE_VIEW_2.CANCELLATION_DATE_DT,INLINE_VIEW_2.CREATION_DATE_DT))
<=  TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW_3  
    ON  STANDARD_HASH(INLINE_VIEW_3.COMPANY_CD_1||INLINE_VIEW_3.DIVISION_CD_1||INLINE_VIEW_3.SHOP_CD)=DM_PRODUCT_HST_1.PRODUCT_HK
AND
TRUNC(
COALESCE(
INLINE_VIEW_3.SALE_DATE_DT,INLINE_VIEW_3.HOLD_DATE_DT,INLINE_VIEW_3.RETURN_DATE_DT,INLINE_VIEW_3.DELIVERY_DATE_DT,INLINE_VIEW_3.CANCELLATION_DATE_DT,INLINE_VIEW_3.CREATION_DATE_DT)) 
>= TRUNC(DM_PRODUCT_HST_1.X_AUD_FROM_TS) 
AND
TRUNC(
COALESCE(
INLINE_VIEW_3.SALE_DATE_DT,INLINE_VIEW_3.HOLD_DATE_DT,INLINE_VIEW_3.HOLD_DATE_DT,INLINE_VIEW_3.DELIVERY_DATE_DT,INLINE_VIEW_3.CANCELLATION_DATE_DT,INLINE_VIEW_3.CREATION_DATE_DT))
<=  TRUNC(DM_PRODUCT_HST_1.X_AUD_TO_TS)
  ) INLINE_VIEW_4  
WHERE
  (INLINE_VIEW_4.COL_2 = 1
) 
  ) INLINE_VIEW_5  LEFT OUTER JOIN  DMM_BDL_ANL.DM_SHOP PARTITION(P_ES) DM_SHOP  
    ON  INLINE_VIEW_5.COL_3 = DM_SHOP.SHOP_HK
     )  
    ON  INLINE_VIEW_5.COMPANY_CD_1=FT_CUSTOMER_BASE.COMPANY_CD
AND
INLINE_VIEW_5.DIVISION_CD_1=FT_CUSTOMER_BASE.DIVISION_CD
AND
INLINE_VIEW_5.CUSTOMER_CD_1=FT_CUSTOMER_BASE.CUSTOMER_CD
AND
TRUNC(INLINE_VIEW_5.COL_4) >= FT_CUSTOMER_BASE.VALID_FROM_DT
AND
TRUNC(INLINE_VIEW_5.COL_4) < FT_CUSTOMER_BASE.VALID_TO_DT
where		(1=1)	
)  ODI_GET_FROM
   , Error Msg = ORA-02149: Specified partition does not exist

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:514)
	... 36 more
]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[28ecdb1b-a71a-4cc1-bea8-4f28d797a42d]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[232965]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-06-25 16:40:09.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-06-25 16:40:10.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[ODI-1298]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[E]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[83752297-0fc2-4622-9a56-0bbd350678f3]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233489]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 17:01:23.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[667]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 17:12:30.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c4c44669-5516-4748-ac4c-2994f0f227b9]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233719]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-02 11:08:09.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[534]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-02 11:17:03.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[897e7ceb-5d32-4d3b-a932-7511267bbbe6]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[782618]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[782618]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[443457]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-02-25 14:37:13.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[575]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-02-25 14:46:48.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ae472cd0-e007-459e-96e4-49c022be8550]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[782618]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[782618]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[446867]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-03-16 07:32:32.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[669]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-03-16 07:43:41.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String"><![CDATA[ODI-1217: Session PKG_BDL_ES_2_FT_TRIAL (449673) fails with return code ODI-1298.
ODI-1226: Step MAP_ES_FT_TRIAL fails after 1 attempt(s).
ODI-1240: Flow MAP_ES_FT_TRIAL fails while performing a Truncate target table partition-IKM Oracle Control Append for BDFL (multi-partition)- operation. This flow loads target table FT_TRIAL.
ODI-1298: Serial task "SERIAL-MAP_MAIN- (40)" failed because child task "SERIAL-EU-LOG_BDFL_UNIT (70)" is in error.
ODI-1298: Serial task "SERIAL-EU-LOG_BDFL_UNIT (70)" failed because child task "Truncate target table partition-IKM Oracle Control Append for BDFL (multi-partition)- (90)" is in error.
ODI-1228: Task Truncate target table partition-IKM Oracle Control Append for BDFL (multi-partition)- fails on the target connection PHY_BDFL_DMM_ES.
Caused By: java.sql.SQLException: ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:510)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:462)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1105)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:551)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:269)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:656)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:230)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:42)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:929)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1280)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1921)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1876)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:304)
	at oracle.odi.runtime.agent.execution.sql.SQLCommand.execute(SQLCommand.java:208)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:142)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:28)
	at oracle.odi.runtime.agent.execution.TaskExecutionHandler.handleTask(TaskExecutionHandler.java:52)
	at oracle.odi.runtime.agent.execution.SessionTask.processTask(SessionTask.java:216)
	at oracle.odi.runtime.agent.execution.SessionTask.doExecuteTask(SessionTask.java:128)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.execute(AbstractSessionTask.java:886)
	at oracle.odi.runtime.agent.execution.SessionExecutor$SerialTrain.runTasks(SessionExecutor.java:2225)
	at oracle.odi.runtime.agent.execution.SessionExecutor.executeSession(SessionExecutor.java:610)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:718)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:611)
	at oracle.odi.core.persistence.dwgobject.DwgObjectTemplate.execute(DwgObjectTemplate.java:203)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor.doProcessStartAgentTask(TaskExecutorAgentRequestProcessor.java:800)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor.access$2700(StartScenRequestProcessor.java:85)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor$StartScenTask.doExecute(StartScenRequestProcessor.java:917)
	at oracle.odi.runtime.agent.processor.task.AgentTask.execute(AgentTask.java:180)
	at oracle.odi.runtime.agent.support.DefaultAgentTaskExecutor$2.run(DefaultAgentTaskExecutor.java:108)
	at java.lang.Thread.run(Thread.java:748)
Caused by: Error : 54, Position : 24, Sql = alter table DMM_BDL_ANL.FT_TRIAL truncate partition (P_ES)  , OriginalSql = alter table DMM_BDL_ANL.FT_TRIAL truncate partition (P_ES)  , Error Msg = ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:514)
	... 30 more
]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2cc210b8-e2c4-46cc-93eb-01a2430d1d8e]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[449673]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-04-03 11:03:20.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[0]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-04-03 11:03:20.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[ODI-1298]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[E]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[88363340-04e2-48f1-9b28-5e56788ad37a]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[577766]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[577766]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[457546]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-22 22:27:26.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1169]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-22 22:46:55.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9cfab4cf-b469-44c6-aefe-30dffe790821]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[736473]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[234598]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-07 10:27:23.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[800]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-07 10:40:43.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[19d8b33f-62c7-46b9-8075-7084be3dd9c9]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[577766]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[577766]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[457884]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-23 19:21:02.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[643]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-23 19:31:45.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3c5513a2-baf8-46d0-a308-bdab97c96ecf]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[878423]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[878423]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[460061]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-06-01 19:37:23.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[950]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-06-01 19:53:13.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0ff0e173-3f33-4926-9453-5aa0e5435430]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MAX_TS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3877e113-32e5-49c4-9288-f8bcd2ecb0b8]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MIN_TS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a49a85d3-a8c8-4754-b2e8-a11687ccd305]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_NO]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String"><![CDATA[01/01/1900 00:00:00]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[11130137-ce78-4fca-9522-d74a5a562cca]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[65207]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_TS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpExpTxtHeader">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0d5b7aef-f194-41e1-b9bd-ad720b45b413]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[65207]]></Field>
	<Field name="Txt" type="java.lang.String"><![CDATA[Timestamp of the start of an ODI session
Set to '01/01/1900 00:00:00' for the initial data load]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8506ac79-114d-4e25-a9d4-29f08cb66460]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4ceb2873-1f9b-46d7-a58e-5b852158c4ee]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_CONTEXT_PARTITION_CODE]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9061f645-1334-4580-bd96-27ca986e816a]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_TEST_LESS_DAYS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2c4a36a7-7829-4269-adc2-7076725a5c33]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_TRIAL_LESS_DAYS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0f924a65-1252-4e58-acf4-9f1cbe5bfd17]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_NO]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_NO]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8a74fc93-102f-4d19-a139-30548e701878]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_NO]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fa100a36-4290-4248-993b-564e3d586bfd]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_TS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_TS]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[86e68f94-bc13-4e45-b76b-fe64fc5da2d1]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_TS]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a40696c9-3591-4e7b-aaef-2757a52587ce]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_MIN_TS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MIN_TS]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b6c05ebd-1336-4501-8aec-ccb4beae6627]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_MIN_TS]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5f41c65f-4881-4755-9c8e-ea589b570b7e]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_MAX_TS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MAX_TS]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d206a37e-8538-4dd2-ac27-e010af49e71c]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_MAX_TS]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="EXPRESSION1" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN6" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN5" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN7" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILTER7" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="ROW_NUMBER" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN4" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN2" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILTER3" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="EXPRESSION" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="FILTER2" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="FTB_ACTIVITY_BASE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="AGGREGATE" type="XKM" km="XKM SQL Aggregate.GLOBAL"/>
   <node name="VM" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="FTB_ACTIVITY_BASE1" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FT_TRIAL_ES_TT" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FILTER4" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="FTB_ALL_APPOINTMENTS_BASE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FILTER6" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="ALL_ACTIVITY_ES_TT1" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="RMAP_ES_CUSTOMER_STATUS_AP_RMA" type="LKM" km="LKM Oracle to Oracle Pull (DB Link).GLOBAL">
      <option name="SELECT_FROM_SOURCE_VIEW" value="false" default="true"/>
      <option name="USE_STAGE_TABLE" value="false" default="true"/>
      <option name="ADD_DRIVING_SITE_HINT" value="false" default="true"/>
      <option name="CREATE_DB_LINK" value="true" default="true"/>
      <option name="SOURCE_ACCESS_DB_LINK" value="" default="true"/>
   </node>
   <node name="OUTPUTSIGNATURE_RMAP_ES_CUSTOM" type="XKM" km="XKM Oracle Output Signature.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
   </node>
   <node name="DISTINCT__RMAP_ES_CUSTOMER_STA" type="XKM" km="XKM SQL Distinct.GLOBAL"/>
   <node name="EXP_RMAP_ES_CUSTOMER_STATUS" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN_RMAP_ES_CUSTOMER_STATUS" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILT_UM_RMAP_ES_CUSTOMER_STATU" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="UM_CU_S_CUSTOMER_MAPPING_RMAP_" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FILT_CL_RMAP_ES_CUSTOMER_STATU" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="CL_LIGHT_CUSTOMER_STATUS_RMAP_" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="DM_CUSTOMER_HST" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="DM_PRODUCT_HST" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="DM_SHOP" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FT_CUSTOMER_BASE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FT_TRIAL_1" type="IKM" km="IKM Oracle Control Append for BDFL (multi-partition).BDFL_AMP">
      <option name="INSERT" value="true" default="true"/>
      <option name="COMMIT" value="true" default="true"/>
      <option name="SYNC_JRN_DELETE" value="true" default="true"/>
      <option name="FLOW_CONTROL" value="false" default="false"/>
      <option name="RECYCLE_ERRORS" value="false" default="true"/>
      <option name="STATIC_CONTROL" value="false" default="true"/>
      <option name="TRUNCATE" value="true" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="CREATE_TARG_TABLE" value="true" default="true"/>
      <option name="DELETE_TEMPORARY_OBJECTS" value="true" default="true"/>
      <option name="FLOW_TABLE_OPTIONS" value="NOLOGGING" default="true"/>
      <option name="CREATE_FLOW_INDEX" value="true" default="true"/>
      <option name="COMPATIBLE" value="9" default="true"/>
      <option name="VALIDATE" value="false" default="true"/>
      <option name="ANALYZE_TARGET" value="false" default="true"/>
      <option name="HINT_SELECT" value=" " default="true"/>
      <option name="HINT_INSERT_FLOW" value="APPEND" default="true"/>
      <option name="HINT_INSERT_TARGET" value="APPEND" default="true"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
      <option name="FILTER_PARTITION" value="true" default="true"/>
      <option name="HINT_SELECT_TARGET" value="" default="true"/>
   </node>
   <node name="FT_TRIAL_1" type="CKM" km="CKM Oracle for Amplifon.BDFL_AMP">
      <option name="DROP_ERROR_TABLE" value="true" default="true"/>
      <option name="DROP_CHECK_TABLE" value="false" default="true"/>
      <option name="CREATE_ERROR_INDEX" value="true" default="true"/>
      <option name="CREATE_FLOW_INDEX" value="true" default="true"/>
      <option name="COMPATIBLE" value="9" default="true"/>
      <option name="VALIDATE" value="false" default="true"/>
      <option name="ENABLE_EDITION_SUPPORT" value="false" default="true"/>
      <option name="UPGRADE_ERROR_TABLE" value="false" default="true"/>
      <option name="FILTER_CURRENT_FL" value="true" default="true"/>
      <option name="ENABLE_DATA_QUALITY" value="true" default="true"/>
   </node>
   <node name="MED_02" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="MED_01" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN_VM" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILTER1" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="EXPRESSION4" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN8" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN9" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILTER8" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <target name="FT_TRIAL" resource="FT_TRIAL" model="DMM_BDL" logicalSchema="LOG_BDFL_DMM" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6ae4cfe9-56fe-4d8b-acdc-6fae13eaa99e]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[DMM_BDL]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FT_TRIAL]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[MAP_ES_FT_TRIAL]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FT_TRIAL]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6f23cda1-9166-40fd-ae61-e3c6ff583070]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_BEGIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[78f25ad3-4324-4460-a510-61187a13cb6f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_EDW_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[2]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[GENERIC_SQL]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
<?
String dblinkToSrc = "";
if ("".equals(dblinkToSrc)) {
  dblinkToSrc = odiRef.getInfo("SRC_LSCHEMA_NAME");
}
if ("TRUE".equals("TRUE")) {
  dblinkToSrc += "%UNIQUE_SESSION_TAG";
}
dblinkToSrc = dblinkToSrc.replaceAll(" ","");
dblinkToSrc = dblinkToSrc.replaceAll("-","");
dblinkToSrc = odiRef.getFormattedName(dblinkToSrc);
?>
drop database link <?=dblinkToSrc ?>
       ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[539e9d89-2189-419f-a4f3-48dd53965e51]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Prepare: drop database link to source]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[LKM Oracle to Oracle Pull (DB Link)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[329eac0e-f09d-4c24-8a41-e1f0236fac70]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e6fd886b-1450-41d6-9a51-178aaa3717c6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_EDW_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[2]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[GENERIC_SQL]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
<?
String dblinkToSrc = "";
if ("".equals(dblinkToSrc)) {
  dblinkToSrc = odiRef.getInfo("SRC_LSCHEMA_NAME");
}
if ("TRUE".equals("TRUE")) {
  dblinkToSrc += "%UNIQUE_SESSION_TAG";
}
dblinkToSrc = dblinkToSrc.replaceAll(" ","");
dblinkToSrc = dblinkToSrc.replaceAll("-","");
dblinkToSrc = odiRef.getFormattedName(dblinkToSrc);
String srcUserName = odiRef.getInfo("SRC_USER_NAME");
String srcServerInstance = odiRef.getInfo("SRC_DSERV_NAME");
String srcSID = "";
if (srcServerInstance != null && srcServerInstance.trim().length() != 0) {
  srcSID = srcServerInstance;
} else {
  String srcJDBCURL = odiRef.getInfo("SRC_JAVA_URL");
  if (srcJDBCURL !=null && srcJDBCURL.trim().length() != 0) {
    srcSID = srcJDBCURL.substring(srcJDBCURL.lastIndexOf("@") + 1);
    srcSID = srcSID.substring(srcSID.lastIndexOf(":") + 1);
    if (srcSID.lastIndexOf("/") >= 0){
      srcSID = srcSID.substring(srcSID.lastIndexOf("/") + 1);
    }
  }
}
srcSID = srcSID.trim();
if (srcSID.length() == 0) {
  throw new OdiKMException("Failed calculating source SID.");
}
?>
create database link <?=dblinkToSrc ?> connect to <?=srcUserName ?> identified by <@=odiRef.getInfo("SRC_PASS") @> using '<?=srcSID ?>'
       ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3fa6b614-1b5b-4ff3-a779-5e6b2fa05e35]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Create database link to source]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[LKM Oracle to Oracle Pull (DB Link)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6c291192-0828-42fa-9f6d-0a2a9f630abe]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_BDFL_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[ 
insert /*+ APPEND */ into	<?= odiRef.getObjectName("L", "FT_TRIAL", "LOG_BDFL_DMM", "D") ?>
 PARTITION(#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	ORDER_DATE_DT,
	ORDER_NUMBER_ID,
	ORDER_TYPE_CODE_CD,
	ORDER_LINE_NUMBER_ID,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIATYPE_HK,
	TEST_RESULT_HK,
	MARKET_TYPE_HK,
	PRODUCT_HK,
	DOCUMENT_HK,
	PRODUCT_HST_SK,
	CREATION_DATE_SK,
	DELIVERY_DATE_SK,
	CANCELLATION_DATE_SK,
	RETURN_DATE_SK,
	HOLD_DATE_SK,
	SALE_DATE_SK,
	D51_CREATION_DATE_DT,
	D130_DELIVERY_DATE_DT,
	D131_CANCELLATION_DATE_DT,
	D132_RETURN_DATE_DT,
	D133_HOLD_DATE_DT,
	D133_SALE_DATE_DT,
	D134_REASON_CODE_CD,
	D41_DOCUMENT_STATUS_CD,
	D40_UPDATE_STATUS_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	D_SIDE_CODE_CD,
	M8_CLIENT_ID,
	M7_DOCUMENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M6_TRIAL_QT,
	M_VAT_AM,
	M9_UNIT_LISTPRICE_NET_AM,
	M326_UNIT_PROP_PRICE_NET_AM,
	M326_UNIT_PROP_PRICE_GROSS_AM,
	M326_UNIT_CALC_PRICE_NET_AM,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	ITR_CANDIDATE_FL,
	ITR_DOCUMENT_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	PREVIOUS_DOCUMENT_DT,
	PREVIOUS_DOCUMENT_NUMBER_ID,
	PREVIOUS_DOCUMENT_TYPE_CD,
	PREVIOUS_DOCUMENT_CLOSING_DT,
	TRIAL_WITH_UP_FL,
	NEXT_INV_APP_FL,
	NEXT_INV_APP_BOOKING_DT,
	NEXT_INV_APP_SCHEDULING_DT,
	ITR_SK,
	MEDICAL_MEDIATYPE_HK,
	TRIAL_AGEING_SK 
) 
select /*+  */
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	ORDER_DATE_DT,
	ORDER_NUMBER_ID,
	ORDER_TYPE_CODE_CD,
	ORDER_LINE_NUMBER_ID,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIATYPE_HK,
	TEST_RESULT_HK,
	MARKET_TYPE_HK,
	PRODUCT_HK,
	DOCUMENT_HK,
	PRODUCT_HST_SK,
	CREATION_DATE_SK,
	DELIVERY_DATE_SK,
	CANCELLATION_DATE_SK,
	RETURN_DATE_SK,
	HOLD_DATE_SK,
	SALE_DATE_SK,
	D51_CREATION_DATE_DT,
	D130_DELIVERY_DATE_DT,
	D131_CANCELLATION_DATE_DT,
	D132_RETURN_DATE_DT,
	D133_HOLD_DATE_DT,
	D133_SALE_DATE_DT,
	D134_REASON_CODE_CD,
	D41_DOCUMENT_STATUS_CD,
	D40_UPDATE_STATUS_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	D_SIDE_CODE_CD,
	M8_CLIENT_ID,
	M7_DOCUMENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M6_TRIAL_QT,
	M_VAT_AM,
	M9_UNIT_LISTPRICE_NET_AM,
	M326_UNIT_PROP_PRICE_NET_AM,
	M326_UNIT_PROP_PRICE_GROSS_AM,
	M326_UNIT_CALC_PRICE_NET_AM,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	ITR_CANDIDATE_FL,
	ITR_DOCUMENT_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	PREVIOUS_DOCUMENT_DT,
	PREVIOUS_DOCUMENT_NUMBER_ID,
	PREVIOUS_DOCUMENT_TYPE_CD,
	PREVIOUS_DOCUMENT_CLOSING_DT,
	TRIAL_WITH_UP_FL,
	NEXT_INV_APP_FL,
	NEXT_INV_APP_BOOKING_DT,
	NEXT_INV_APP_SCHEDULING_DT,
	ITR_SK,
	MEDICAL_MEDIATYPE_HK,
	TRIAL_AGEING_SK   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	#BDFL_AMP.V_SESSION_NO X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'MAP_ES_FT_TRIAL' || ' (' || '<?=odiRef.getContext("CTX_CODE") ?>' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_7.COMPANY_CD_3 X_AUD_COMPANY_CD,
	INLINE_VIEW_7.COMPANY_CD_3 COMPANY_CD,
	INLINE_VIEW_7.DIVISION_CD_3 DIVISION_CD,
	INLINE_VIEW_7.ORDER_DATE_DT ORDER_DATE_DT,
	INLINE_VIEW_7.ORDER_NUMBER_ID ORDER_NUMBER_ID,
	INLINE_VIEW_7.ORDER_TYPE_CODE_CD ORDER_TYPE_CODE_CD,
	INLINE_VIEW_7.ORDER_LINE_NUMBER_ID ORDER_LINE_NUMBER_ID,
	STANDARD_HASH( INLINE_VIEW_7.COMPANY_CD_3|| INLINE_VIEW_7.DIVISION_CD_4) COMPANY_HK,
	CASE
  WHEN INLINE_VIEW_7.MASTER_CUSTOMER_CD IS NOT NULL
  THEN INLINE_VIEW_7.COL_2
  ELSE STANDARD_HASH ('-1')
END CUSTOMER_HK,
	NVL(INLINE_VIEW_7.CLC_STATUS_HK,'D961F70D39EE00CF78D4D476B80EF3AD5ABE128C') CLC_STATUS_HK,
	INLINE_VIEW_7.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_7.COL_4 SHOP_HK,
	CASE
  WHEN INLINE_VIEW_7.DAYCENTER_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_7.COMPANY_CD_2 || INLINE_VIEW_7.DIVISION_CD_2 || INLINE_VIEW_7.DAYCENTER_CD || INLINE_VIEW_7.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_7.LOCATION_TYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_7.COMPANY_CD_2 || INLINE_VIEW_7.DIVISION_CD_2 || INLINE_VIEW_7.LOCATION_TYPE_CD )
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_7.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_7.COMPANY_CD_3|| INLINE_VIEW_7.DIVISION_CD_3|| INLINE_VIEW_7.EMPLOYEE_CD|| INLINE_VIEW_7.SHOP_CD_1)
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_7.PROMOTER_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_7.COMPANY_CD_2 || INLINE_VIEW_7.DIVISION_CD_2 || INLINE_VIEW_7.PROMOTER_CD || INLINE_VIEW_7.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_7.CAMPAIGN_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_7.COMPANY_CD_2 || INLINE_VIEW_7.DIVISION_CD_2 || INLINE_VIEW_7.CAMPAIGN_CD )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_7.MEDIATYPE_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_7.COMPANY_CD_2 || INLINE_VIEW_7.DIVISION_CD_2 || INLINE_VIEW_7.MEDIATYPE_CD )
  ELSE STANDARD_HASH ('-1')
END MEDIATYPE_HK,
	STANDARD_HASH( INLINE_VIEW_7.COMPANY_CD_3 || INLINE_VIEW_7.DIVISION_CD_3
||
CASE WHEN INLINE_VIEW_7.TESTRESULT_LEFT IN('IN','ND') THEN '-1'
ELSE COALESCE( INLINE_VIEW_7.TESTRESULT_LEFT, '-1')
END
||
CASE WHEN INLINE_VIEW_7.TESTRESULT_RIGHT IN('IN','ND') THEN '-1'
ELSE COALESCE( INLINE_VIEW_7.TESTRESULT_RIGHT, '-1')
END
) TEST_RESULT_HK,
	CASE
  WHEN INLINE_VIEW_7.MARKET_TYPE_CD IS NOT NULL
  THEN 
  (STANDARD_HASH(INLINE_VIEW_7.COMPANY_CD_3||INLINE_VIEW_7.DIVISION_CD_3
  ||
  CASE 
   WHEN 
    INLINE_VIEW_7.DOCUMENT_NUMBER_REF_ID IS NULL and INLINE_VIEW_7.MARKET_TYPE_CD ='11'  
   THEN 'ML'
   WHEN
    INLINE_VIEW_7.MARKET_TYPE_CD ='14'  
   THEN 'MS'
   WHEN
    INLINE_VIEW_7.DOCUMENT_NUMBER_REF_ID IS NOT NULL and INLINE_VIEW_7.MARKET_TYPE_CD ='11'
   THEN 'MRL'
   WHEN INLINE_VIEW_7.MARKET_TYPE_CD ='MR'
   THEN 'MRS'
   WHEN INLINE_VIEW_7.MARKET_TYPE_CD ='15'
   THEN 'MI'
   WHEN INLINE_VIEW_7.MARKET_TYPE_CD ='12'
   THEN 'MIL'
   WHEN INLINE_VIEW_7.MARKET_TYPE_CD ='RI'
   THEN 'MIS'
   else INLINE_VIEW_7.MARKET_TYPE_CD 
  end))
  ELSE STANDARD_HASH ('-1')
END MARKET_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_7.COMPANY_CD_3 || INLINE_VIEW_7.DIVISION_CD_3|| INLINE_VIEW_7.PRODUCT_CD) PRODUCT_HK,
	CASE
WHEN (INLINE_VIEW_7.COMPANY_CD_3 IS NOT NULL) AND (INLINE_VIEW_7.DIVISION_CD_3 IS NOT NULL) AND (INLINE_VIEW_7.ORDER_DATE_DT IS NOT NULL)
  AND (INLINE_VIEW_7.ORDER_NUMBER_ID IS NOT NULL) AND (INLINE_VIEW_7.ORDER_TYPE_CODE_CD IS NOT NULL)
THEN STANDARD_HASH (INLINE_VIEW_7.COMPANY_CD_3||INLINE_VIEW_7.DIVISION_CD_3||INLINE_VIEW_7.ORDER_DATE_DT||INLINE_VIEW_7.ORDER_NUMBER_ID||INLINE_VIEW_7.ORDER_TYPE_CODE_CD)
ELSE
STANDARD_HASH (-1)
END DOCUMENT_HK,
	INLINE_VIEW_7.PRODUCT_HST_SK PRODUCT_HST_SK,
	extract (year from INLINE_VIEW_7.CREATION_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_7.CREATION_DATE_DT)*100
+  extract (day from INLINE_VIEW_7.CREATION_DATE_DT) CREATION_DATE_SK,
	extract (year from INLINE_VIEW_7.DELIVERY_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_7.DELIVERY_DATE_DT)*100
+  extract (day from INLINE_VIEW_7.DELIVERY_DATE_DT) DELIVERY_DATE_SK,
	extract (year from INLINE_VIEW_7.CANCELLATION_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_7.CANCELLATION_DATE_DT)*100
+  extract (day from INLINE_VIEW_7.CANCELLATION_DATE_DT) CANCELLATION_DATE_SK,
	extract (year from INLINE_VIEW_7.RETURN_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_7.RETURN_DATE_DT)*100
+  extract (day from INLINE_VIEW_7.RETURN_DATE_DT) RETURN_DATE_SK,
	extract (year from INLINE_VIEW_7.HOLD_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_7.HOLD_DATE_DT)*100
+  extract (day from INLINE_VIEW_7.HOLD_DATE_DT) HOLD_DATE_SK,
	extract (year from INLINE_VIEW_7.SALE_DATE_DT )*10000
+  extract (MONTH from INLINE_VIEW_7.SALE_DATE_DT)*100
+  extract (day from INLINE_VIEW_7.SALE_DATE_DT) SALE_DATE_SK,
	TRUNC(INLINE_VIEW_7.CREATION_DATE_DT) D51_CREATION_DATE_DT,
	TRUNC(INLINE_VIEW_7.DELIVERY_DATE_DT) D130_DELIVERY_DATE_DT,
	TRUNC(INLINE_VIEW_7.CANCELLATION_DATE_DT) D131_CANCELLATION_DATE_DT,
	TRUNC(INLINE_VIEW_7.RETURN_DATE_DT) D132_RETURN_DATE_DT,
	TRUNC(INLINE_VIEW_7.HOLD_DATE_DT) D133_HOLD_DATE_DT,
	TRUNC(INLINE_VIEW_7.SALE_DATE_DT) D133_SALE_DATE_DT,
	INLINE_VIEW_7.REASON_CD D134_REASON_CODE_CD,
	INLINE_VIEW_7.STATUS_CD D41_DOCUMENT_STATUS_CD,
	TRUNC(INLINE_VIEW_7.UPDATE_STATUS_DT) D40_UPDATE_STATUS_DATE_DT,
	INLINE_VIEW_7.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	INLINE_VIEW_7.COL_5 D_CLC_REFERENCE_DATE_DT,
	INLINE_VIEW_7.SIDE_CD D_SIDE_CODE_CD,
	INLINE_VIEW_7.MASTER_COMPANY_CD|| INLINE_VIEW_7.MASTER_DIVISION_CD|| INLINE_VIEW_7.MASTER_CUSTOMER_CD M8_CLIENT_ID,
	INLINE_VIEW_7.COMPANY_CD_3||INLINE_VIEW_7.DIVISION_CD_3||TO_CHAR(INLINE_VIEW_7.ORDER_DATE_DT,'YYYYMMDD')||INLINE_VIEW_7.ORDER_NUMBER_ID||INLINE_VIEW_7.ORDER_TYPE_CODE_CD M7_DOCUMENT_ID,
	CASE WHEN INLINE_VIEW_7.CREATION_DATE_DT IS NOT NULL THEN
INLINE_VIEW_7.MASTER_COMPANY_CD||
INLINE_VIEW_7.MASTER_DIVISION_CD||
INLINE_VIEW_7.MASTER_CUSTOMER_CD||
INLINE_VIEW_7.SHOP_CD_1||
TO_CHAR(INLINE_VIEW_7.CREATION_DATE_DT,'YYYYMM')
ELSE NULL
END M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_7.QUANTITY_QT M6_TRIAL_QT,
	INLINE_VIEW_7.VAT_RT M_VAT_AM,
	INLINE_VIEW_7.LIST_PRICE_AMOUNT_AM*INLINE_VIEW_7.QUANTITY_QT M9_UNIT_LISTPRICE_NET_AM,
	INLINE_VIEW_7.NET_AMOUNT_AM M326_UNIT_PROP_PRICE_NET_AM,
	INLINE_VIEW_7.GROSS_AMOUNT_AM M326_UNIT_PROP_PRICE_GROSS_AM,
	INLINE_VIEW_7.NET_AMOUNT_CALCULATED_AM M326_UNIT_CALC_PRICE_NET_AM,
	CASE
  WHEN INLINE_VIEW_7.D_SHOP_ORIGIN_CD='A' AND  INLINE_VIEW_7.CREATION_DATE_DT>= INLINE_VIEW_7.D_START_DATE_DT  AND INLINE_VIEW_7.CREATION_DATE_DT<= ADD_MONTHS(INLINE_VIEW_7.D_END_DATE_DT, -12)
      THEN 1 
  WHEN INLINE_VIEW_7.D_SHOP_ORIGIN_CD='N' AND INLINE_VIEW_7.CREATION_DATE_DT>= ADD_MONTHS(INLINE_VIEW_7.D_START_DATE_DT, 12) AND INLINE_VIEW_7.CREATION_DATE_DT<= ADD_MONTHS(INLINE_VIEW_7.D_END_DATE_DT, - 12)
      THEN 1 
  ELSE CASE WHEN INLINE_VIEW_7.D_SHOP_ORIGIN_CD IS NOT NULL THEN 0 ELSE NULL END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE
    WHEN INLINE_VIEW_7.D_SHOP_ORIGIN_CD='A' AND INLINE_VIEW_7.CREATION_DATE_DT>= ADD_MONTHS(INLINE_VIEW_7.D_START_DATE_DT, 12) AND INLINE_VIEW_7.CREATION_DATE_DT<= INLINE_VIEW_7.D_END_DATE_DT 
         THEN 1
    WHEN INLINE_VIEW_7.D_SHOP_ORIGIN_CD='N' AND INLINE_VIEW_7.CREATION_DATE_DT>= ADD_MONTHS(INLINE_VIEW_7.D_START_DATE_DT, 24) AND INLINE_VIEW_7.CREATION_DATE_DT <= INLINE_VIEW_7.D_END_DATE_DT 
        THEN 1 
    ELSE CASE WHEN INLINE_VIEW_7.D_SHOP_ORIGIN_CD IS NOT NULL THEN 0 ELSE NULL END
END M_SAME_STORE_GROWTH_CY_FL,
	NVL(INLINE_VIEW_7.ITR_CANDIDATE_FL, 0) ITR_CANDIDATE_FL,
	NVL(INLINE_VIEW_7.ITR_DOCUMENT_FL, 0) ITR_DOCUMENT_FL,
	INLINE_VIEW_7.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	INLINE_VIEW_7.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	INLINE_VIEW_7.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	INLINE_VIEW_7.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	INLINE_VIEW_7.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	INLINE_VIEW_7.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	INLINE_VIEW_7.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	INLINE_VIEW_7.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	INLINE_VIEW_7.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	INLINE_VIEW_7.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE 
 WHEN  TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.TST_LAST_TEST_DT) IS NULL 
            THEN NULL
 WHEN  TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.TST_LAST_TEST_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.TST_LAST_TEST_DT)
    ELSE 3651
END TEST_AGEING_SK,
	CASE 
 WHEN  TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.INT_LAST_INTERACTION_DT) IS NULL 
            THEN NULL
 WHEN  TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.INT_LAST_INTERACTION_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.INT_LAST_INTERACTION_DT)
    ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_7.PREVIOUS_DOCUMENT_DT PREVIOUS_DOCUMENT_DT,
	INLINE_VIEW_7.PREVIOUS_DOCUMENT_NUMBER_ID PREVIOUS_DOCUMENT_NUMBER_ID,
	INLINE_VIEW_7.PREVIOUS_DOCUMENT_TYPE_CD PREVIOUS_DOCUMENT_TYPE_CD,
	INLINE_VIEW_7.PREVIOUS_DOCUMENT_CLOSING_DT PREVIOUS_DOCUMENT_CLOSING_DT,
	CASE
  WHEN INLINE_VIEW_7.PREVIOUS_DOCUMENT_TYPE_CD IN ('UP','UR', 'UA', 'UV')
  THEN 1
  ELSE 0
END TRIAL_WITH_UP_FL,
	CASE WHEN INLINE_VIEW_7.COMPANY_CD IS NOT NULL THEN 1 
ELSE 0
END NEXT_INV_APP_FL,
	TRUNC(INLINE_VIEW_7.APPOINTMENT_BOOKING_DT) NEXT_INV_APP_BOOKING_DT,
	TRUNC(INLINE_VIEW_7.APPOINTMENT_SCHEDULING_DT) NEXT_INV_APP_SCHEDULING_DT,
	NVL(INLINE_VIEW_7.ITR_CANDIDATE_FL, 0) || NVL(INLINE_VIEW_7.ITR_DOCUMENT_FL, 0) ITR_SK,
	CASE
  WHEN (CASE WHEN  (CASE WHEN INLINE_VIEW_7.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE1_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_7.MEDIATYPE_CD NOT IN  ('05', '06') THEN 'F_VM'
  WHEN (CASE WHEN INLINE_VIEW_7.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE1_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_7.MEDIATYPE_CD  IN  ('05', '06') THEN INLINE_VIEW_7.MEDIATYPE_CD
  WHEN (CASE WHEN INLINE_VIEW_7.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE1_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'O' AND INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN INLINE_VIEW_7.MEDIATYPE_CD
  ELSE INLINE_VIEW_7.MEDIATYPE_CD END) IS NOT NULL
  THEN STANDARD_HASH(INLINE_VIEW_7.COMPANY_CD_3 || INLINE_VIEW_7.DIVISION_CD_3 || (CASE WHEN  (CASE WHEN INLINE_VIEW_7.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE1_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_7.MEDIATYPE_CD NOT IN  ('05', '06') THEN 'F_VM'
  WHEN (CASE WHEN INLINE_VIEW_7.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE1_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_7.MEDIATYPE_CD  IN  ('05', '06') THEN INLINE_VIEW_7.MEDIATYPE_CD
  WHEN (CASE WHEN INLINE_VIEW_7.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE1_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'O' AND INLINE_VIEW_7.MEDIATYPE_CD = '31' THEN INLINE_VIEW_7.MEDIATYPE_CD
  ELSE INLINE_VIEW_7.MEDIATYPE_CD END) )
  ELSE STANDARD_HASH ('-1')
END MEDICAL_MEDIATYPE_HK,
	CASE 
	WHEN  TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.TRI_LAST_TRIAL_ACTIVATION_DT) IS NULL 
            THEN NULL
	WHEN  TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.TRI_LAST_TRIAL_ACTIVATION_DT) < 3651 
            THEN TRUNC(INLINE_VIEW_7.COL_5) - TRUNC(INLINE_VIEW_7.TRI_LAST_TRIAL_ACTIVATION_DT)
    ELSE 3651
END TRIAL_AGEING_SK 
from	(
SELECT 
  INLINE_VIEW_6.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_6.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_6.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_6.APPOINTMENT_ID AS APPOINTMENT_ID ,
  INLINE_VIEW_6.APPOINTMENT_BOOKING_DT AS APPOINTMENT_BOOKING_DT ,
  INLINE_VIEW_6.APPOINTMENT_SCHEDULING_DT AS APPOINTMENT_SCHEDULING_DT ,
  INLINE_VIEW_6.APPOINTMENT_STATUS_CD AS APPOINTMENT_STATUS_CD ,
  INLINE_VIEW_6.REASON_CLOSING_CD AS REASON_CLOSING_CD ,
  INLINE_VIEW_6.INVOICING_APP_FL AS INVOICING_APP_FL ,
  INLINE_VIEW_6.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_6.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_6.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_6.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_6.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_6.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_6.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_6.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_6.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_6.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_6.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_6.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_6.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_6.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_6.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_6.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_6.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_6.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_6.TRI_LAST_TRIAL_ACTIVATION_DT AS TRI_LAST_TRIAL_ACTIVATION_DT ,
  INLINE_VIEW_6.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_6.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_6.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_6.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_6.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_6.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_6.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_6.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_6.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_6.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_6.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_6.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_6.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_6.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_6.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_6.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_6.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_6.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_6.COMPANY_CD_2 AS COMPANY_CD_2 ,
  INLINE_VIEW_6.DIVISION_CD_2 AS DIVISION_CD_2 ,
  INLINE_VIEW_6.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_6.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_6.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW_6.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_6.CUSTOMER_CD_2 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_6.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW_6.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_6.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_6.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_6.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_6.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_6.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW_6.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW_6.COL AS COL ,
  INLINE_VIEW_6.COMPANY_CD_3 AS COMPANY_CD_3 ,
  INLINE_VIEW_6.DIVISION_CD_3 AS DIVISION_CD_3 ,
  INLINE_VIEW_6.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_6.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_6.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_6.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_6.CUSTOMER_CD_3 AS CUSTOMER_CD_3 ,
  INLINE_VIEW_6.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW_6.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_6.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_6.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_6.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_6.REASON_CD AS REASON_CD ,
  INLINE_VIEW_6.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_6.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_6.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_6.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_6.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_6.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_6.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_6.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_6.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_6.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_6.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_6.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_6.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_6.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_6.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_6.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_6.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_6.VAT_RT AS VAT_RT ,
  INLINE_VIEW_6.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_6.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_6.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_6.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_6.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW_6.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW_6.COL_1 AS COL_1 ,
  INLINE_VIEW_6.COL_2 AS COL_2 ,
  INLINE_VIEW_6.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_6.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_6.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_6.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_6.X_AUD_FROM_TS_1 AS X_AUD_FROM_TS_1 ,
  INLINE_VIEW_6.X_AUD_TO_TS_1 AS X_AUD_TO_TS_1 ,
  INLINE_VIEW_6.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  INLINE_VIEW_6.PRODUCT_HK AS PRODUCT_HK ,
  INLINE_VIEW_6.COL_3 AS COL_3 ,
  INLINE_VIEW_6.COL_4 AS COL_4 ,
  INLINE_VIEW_6.COL_5 AS COL_5 ,
  INLINE_VIEW_6.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_6.DIVISION_CD_4 AS DIVISION_CD_4 ,
  INLINE_VIEW_6.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_6.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_6.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_6.COL_6 AS COL_6   
FROM 
  (
SELECT 
  FTB_ALL_APPOINTMENTS_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_ALL_APPOINTMENTS_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_ALL_APPOINTMENTS_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_ID AS APPOINTMENT_ID ,
  FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_BOOKING_DT AS APPOINTMENT_BOOKING_DT ,
  FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_SCHEDULING_DT AS APPOINTMENT_SCHEDULING_DT ,
  FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_STATUS_CD AS APPOINTMENT_STATUS_CD ,
  FTB_ALL_APPOINTMENTS_BASE_1.REASON_CLOSING_CD AS REASON_CLOSING_CD ,
  FTB_ALL_APPOINTMENTS_BASE_1.INVOICING_APP_FL AS INVOICING_APP_FL ,
  INLINE_VIEW_5.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_5.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_5.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_5.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_5.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_5.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_5.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_5.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_5.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_5.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_5.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_5.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_5.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_5.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  INLINE_VIEW_5.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_5.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_5.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_5.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_5.TRI_LAST_TRIAL_ACTIVATION_DT AS TRI_LAST_TRIAL_ACTIVATION_DT ,
  INLINE_VIEW_5.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_5.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_5.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_5.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_5.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_5.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_5.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_5.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_5.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_5.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_5.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_5.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_5.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_5.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_5.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_5.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_5.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_5.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_5.COMPANY_CD_1 AS COMPANY_CD_2 ,
  INLINE_VIEW_5.DIVISION_CD_1 AS DIVISION_CD_2 ,
  INLINE_VIEW_5.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_5.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_5.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW_5.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_5.CUSTOMER_CD_1 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_5.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW_5.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_5.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_5.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_5.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_5.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_5.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW_5.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW_5.COL AS COL ,
  INLINE_VIEW_5.COMPANY_CD_2 AS COMPANY_CD_3 ,
  INLINE_VIEW_5.DIVISION_CD_2 AS DIVISION_CD_3 ,
  INLINE_VIEW_5.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_5.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_5.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_5.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_5.CUSTOMER_CD_2 AS CUSTOMER_CD_3 ,
  INLINE_VIEW_5.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW_5.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_5.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_5.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_5.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_5.REASON_CD AS REASON_CD ,
  INLINE_VIEW_5.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_5.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_5.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_5.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_5.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_5.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_5.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_5.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_5.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_5.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_5.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_5.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_5.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_5.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_5.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_5.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_5.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_5.VAT_RT AS VAT_RT ,
  INLINE_VIEW_5.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_5.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_5.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_5.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_5.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW_5.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW_5.COL_1 AS COL_1 ,
  INLINE_VIEW_5.COL_2 AS COL_2 ,
  INLINE_VIEW_5.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_5.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_5.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_5.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_5.X_AUD_FROM_TS_1 AS X_AUD_FROM_TS_1 ,
  INLINE_VIEW_5.X_AUD_TO_TS_1 AS X_AUD_TO_TS_1 ,
  INLINE_VIEW_5.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  INLINE_VIEW_5.PRODUCT_HK AS PRODUCT_HK ,
  INLINE_VIEW_5.COL_3 AS COL_3 ,
  INLINE_VIEW_5.COL_4 AS COL_4 ,
  INLINE_VIEW_5.COL_5 AS COL_5 ,
  INLINE_VIEW_5.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_5.DIVISION_CD_3 AS DIVISION_CD_4 ,
  INLINE_VIEW_5.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_5.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_5.D_END_DATE_DT AS D_END_DATE_DT ,
  ROW_NUMBER() OVER (PARTITION BY INLINE_VIEW_5.COMPANY_CD_2, INLINE_VIEW_5.DIVISION_CD_2, INLINE_VIEW_5.ORDER_DATE_DT, INLINE_VIEW_5.ORDER_NUMBER_ID, INLINE_VIEW_5.ORDER_TYPE_CODE_CD, INLINE_VIEW_5.ORDER_LINE_NUMBER_ID  ORDER BY FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_SCHEDULING_DT, FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_ID) AS COL_6   
FROM 
  (
SELECT 
  FT_CUSTOMER_BASE.CLC_STATUS_HK AS CLC_STATUS_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  FT_CUSTOMER_BASE.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  FT_CUSTOMER_BASE.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  FT_CUSTOMER_BASE.COMPANY_CD AS COMPANY_CD ,
  FT_CUSTOMER_BASE.DIVISION_CD AS DIVISION_CD ,
  FT_CUSTOMER_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FT_CUSTOMER_BASE.VALID_FROM_DT AS VALID_FROM_DT ,
  FT_CUSTOMER_BASE.VALID_TO_DT AS VALID_TO_DT ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  FT_CUSTOMER_BASE.TRI_LAST_TRIAL_ACTIVATION_DT AS TRI_LAST_TRIAL_ACTIVATION_DT ,
  FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_4.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_4.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_4.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_4.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_4.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_4.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_4.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_4.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_4.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_4.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_4.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_4.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_4.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_4.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_4.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_4.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_4.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_4.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_4.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_4.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_4.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_4.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW_4.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_4.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  INLINE_VIEW_4.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW_4.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_4.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_4.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_4.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_4.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_4.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW_4.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW_4.COL AS COL ,
  INLINE_VIEW_4.COMPANY_CD_1 AS COMPANY_CD_2 ,
  INLINE_VIEW_4.DIVISION_CD_1 AS DIVISION_CD_2 ,
  INLINE_VIEW_4.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_4.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_4.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_4.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_4.CUSTOMER_CD_1 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_4.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW_4.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_4.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_4.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_4.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_4.REASON_CD AS REASON_CD ,
  INLINE_VIEW_4.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_4.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_4.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_4.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_4.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_4.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_4.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_4.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_4.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_4.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_4.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_4.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_4.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_4.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_4.VAT_RT AS VAT_RT ,
  INLINE_VIEW_4.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_4.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_4.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_4.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_4.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW_4.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW_4.COL_1 AS COL_1 ,
  INLINE_VIEW_4.COL_2 AS COL_2 ,
  INLINE_VIEW_4.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_4.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_4.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_4.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_4.X_AUD_FROM_TS_1 AS X_AUD_FROM_TS_1 ,
  INLINE_VIEW_4.X_AUD_TO_TS_1 AS X_AUD_TO_TS_1 ,
  INLINE_VIEW_4.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  INLINE_VIEW_4.PRODUCT_HK AS PRODUCT_HK ,
  INLINE_VIEW_4.COL_3 AS COL_3 ,
  INLINE_VIEW_4.COL_4 AS COL_4 ,
  INLINE_VIEW_4.COL_5 AS COL_5 ,
  DM_SHOP.SHOP_HK AS SHOP_HK ,
  DM_SHOP.DIVISION_CD AS DIVISION_CD_3 ,
  DM_SHOP.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  DM_SHOP.D_START_DATE_DT AS D_START_DATE_DT ,
  DM_SHOP.D_END_DATE_DT AS D_END_DATE_DT   
FROM 
  <?= odiRef.getObjectName("L", "FT_CUSTOMER_BASE", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW_3.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_3.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_3.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_3.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_3.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_3.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_3.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_3.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_3.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_3.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_3.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_3.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_3.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_3.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_3.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_3.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_3.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_3.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_3.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_3.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_3.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW_3.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_3.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_3.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW_3.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_3.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_3.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_3.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_3.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_3.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW_3.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW_3.COL AS COL ,
  INLINE_VIEW_3.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_3.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_3.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_3.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_3.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_3.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_3.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_3.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW_3.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_3.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_3.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_3.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_3.REASON_CD AS REASON_CD ,
  INLINE_VIEW_3.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_3.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_3.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_3.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_3.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_3.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_3.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_3.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_3.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_3.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_3.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_3.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_3.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_3.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_3.VAT_RT AS VAT_RT ,
  INLINE_VIEW_3.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_3.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_3.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_3.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW_3.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW_3.COL_1 AS COL_1 ,
  INLINE_VIEW_3.COL_2 AS COL_2 ,
  INLINE_VIEW_3.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_3.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_3.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_3.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_3.X_AUD_FROM_TS_1 AS X_AUD_FROM_TS_1 ,
  INLINE_VIEW_3.X_AUD_TO_TS_1 AS X_AUD_TO_TS_1 ,
  INLINE_VIEW_3.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  INLINE_VIEW_3.PRODUCT_HK AS PRODUCT_HK ,
  INLINE_VIEW_3.COL_3 AS COL_3 ,
  INLINE_VIEW_3.COL_4 AS COL_4 ,
  INLINE_VIEW_3.COL_5 AS COL_5   
FROM 
  (
SELECT 
  INLINE_VIEW_2.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_2.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_2.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_2.D15_COMPANY_CD AS D15_COMPANY_CD ,
  INLINE_VIEW_2.D15_DIVISION_CD AS D15_DIVISION_CD ,
  INLINE_VIEW_2.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_2.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_2.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_2.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_2.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_2.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_2.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_2.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_2.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_2.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_2.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_2.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_2.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_2.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_2.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_2.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW_2.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_2.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_2.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW_2.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_2.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_2.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_2.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_2.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_2.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW_2.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW_2.COL AS COL ,
  INLINE_VIEW_2.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_2.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_2.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_2.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_2.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_2.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_2.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_2.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW_2.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_2.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_2.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_2.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_2.REASON_CD AS REASON_CD ,
  INLINE_VIEW_2.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_2.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_2.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_2.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_2.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_2.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_2.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_2.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_2.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_2.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_2.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_2.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_2.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_2.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_2.VAT_RT AS VAT_RT ,
  INLINE_VIEW_2.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_2.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_2.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_2.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW_2.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW_2.COL_1 AS COL_1 ,
  INLINE_VIEW_2.COL_2 AS COL_2 ,
  INLINE_VIEW_2.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_2.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_2.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_2.STATUS_TO_DT AS STATUS_TO_DT ,
  DM_PRODUCT_HST_1.X_AUD_FROM_TS AS X_AUD_FROM_TS_1 ,
  DM_PRODUCT_HST_1.X_AUD_TO_TS AS X_AUD_TO_TS_1 ,
  DM_PRODUCT_HST_1.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  DM_PRODUCT_HST_1.PRODUCT_HK AS PRODUCT_HK ,
  ROW_NUMBER() 
OVER 
(PARTITION BY
INLINE_VIEW_2.COMPANY_CD_1,
INLINE_VIEW_2.DIVISION_CD_1,
INLINE_VIEW_2.ORDER_DATE_DT,
INLINE_VIEW_2.ORDER_NUMBER_ID,
INLINE_VIEW_2.ORDER_TYPE_CODE_CD,
INLINE_VIEW_2.ORDER_LINE_NUMBER_ID
ORDER BY INLINE_VIEW_2.X_AUD_FROM_TS, DM_PRODUCT_HST_1.X_AUD_FROM_TS) AS COL_3 ,
  CASE
  WHEN INLINE_VIEW_2.SHOP_CD_1 IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_2.COMPANY_CD_1|| INLINE_VIEW_2.DIVISION_CD_1|| INLINE_VIEW_2.SHOP_CD_1)
  ELSE STANDARD_HASH ('-1')
END AS COL_4 ,
  CASE 
  WHEN INLINE_VIEW_2.STATUS_ID = 6 
    THEN TRUNC(INLINE_VIEW_2.CREATION_DATE_DT) - 1
    ELSE TRUNC(INLINE_VIEW_2.CREATION_DATE_DT) - #BDFL_AMP.V_TRIAL_LESS_DAYS
END AS COL_5   
FROM 
  (
SELECT 
  DM_PRODUCT_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_PRODUCT_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_PRODUCT_HST.PRODUCT_HST_SK AS PRODUCT_HST_SK ,
  DM_PRODUCT_HST.PRODUCT_HK AS PRODUCT_HK   
FROM 
  <?= odiRef.getObjectName("L", "DM_PRODUCT_HST", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> DM_PRODUCT_HST  
  ) DM_PRODUCT_HST_1  RIGHT OUTER JOIN  (
SELECT 
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.D15_COMPANY_CD AS D15_COMPANY_CD ,
  DM_CUSTOMER_HST.D15_DIVISION_CD AS D15_DIVISION_CD ,
  DM_CUSTOMER_HST.D15_CUSTOMER_CD AS D15_CUSTOMER_CD ,
  INLINE_VIEW_1.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW_1.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW_1.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW_1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW_1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW_1.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW_1.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW_1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW_1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW_1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW_1.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_1.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_1.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_1.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_1.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_1.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_1.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_1.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_1.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_1.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW_1.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW_1.COL AS COL ,
  INLINE_VIEW_1.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_1.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_1.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW_1.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW_1.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW_1.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW_1.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_1.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW_1.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW_1.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_1.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW_1.REASON_CD AS REASON_CD ,
  INLINE_VIEW_1.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW_1.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW_1.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW_1.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW_1.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW_1.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW_1.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW_1.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW_1.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW_1.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW_1.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW_1.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW_1.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW_1.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW_1.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW_1.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW_1.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW_1.VAT_RT AS VAT_RT ,
  INLINE_VIEW_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_1.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW_1.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW_1.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW_1.COL_1 AS COL_1 ,
  INLINE_VIEW_1.COL_2 AS COL_2 ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  <?= odiRef.getObjectName("L", "DM_CUSTOMER_HST", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> DM_CUSTOMER_HST  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.SHOP_CODE AS SHOP_CODE ,
  INLINE_VIEW.LAPTOP_CODE AS LAPTOP_CODE ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE AS ACTIVITY_DATE ,
  INLINE_VIEW.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  INLINE_VIEW.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  INLINE_VIEW.DT_INSERT AS DT_INSERT ,
  INLINE_VIEW.IS_TEST_FL AS IS_TEST_FL ,
  INLINE_VIEW.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  INLINE_VIEW.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  INLINE_VIEW.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW.ACTIVITY_ID_1 AS ACTIVITY_ID_1 ,
  INLINE_VIEW.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  INLINE_VIEW.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW.REFERENCE_ID AS REFERENCE_ID ,
  INLINE_VIEW.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW.ORDER_DATE_DT AS ORDER_DATE_DT ,
  INLINE_VIEW.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  INLINE_VIEW.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  INLINE_VIEW.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  INLINE_VIEW.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW.SHOP_CD_1 AS SHOP_CD_1 ,
  INLINE_VIEW.PRODUCT_CD AS PRODUCT_CD ,
  INLINE_VIEW.STATUS_CD AS STATUS_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  INLINE_VIEW.REASON_CD AS REASON_CD ,
  INLINE_VIEW.SIDE_CD AS SIDE_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  INLINE_VIEW.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  INLINE_VIEW.CREATION_DATE_DT AS CREATION_DATE_DT ,
  INLINE_VIEW.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  INLINE_VIEW.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  INLINE_VIEW.RETURN_DATE_DT AS RETURN_DATE_DT ,
  INLINE_VIEW.HOLD_DATE_DT AS HOLD_DATE_DT ,
  INLINE_VIEW.SALE_DATE_DT AS SALE_DATE_DT ,
  INLINE_VIEW.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  INLINE_VIEW.QUANTITY_QT AS QUANTITY_QT ,
  INLINE_VIEW.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  INLINE_VIEW.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  INLINE_VIEW.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  INLINE_VIEW.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  INLINE_VIEW.VAT_RT AS VAT_RT ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  INLINE_VIEW.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  INLINE_VIEW.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  INLINE_VIEW.COL_1 AS COL_1 ,
  INLINE_VIEW.COL_2 AS COL_2   
FROM 
  (
SELECT 
  ALL_ACTIVITY_ES_TT1_1.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT1_1.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT1_1.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT1_1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  ALL_ACTIVITY_ES_TT1_1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  ALL_ACTIVITY_ES_TT1_1.DT_INSERT AS DT_INSERT ,
  ALL_ACTIVITY_ES_TT1_1.IS_TEST_FL AS IS_TEST_FL ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE ,
  FTB_ACTIVITY_BASE_2.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE_2.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE_2.SHOP_CD AS SHOP_CD ,
  FTB_ACTIVITY_BASE_2.LAPTOP_CD AS LAPTOP_CD ,
  FTB_ACTIVITY_BASE_2.ACTIVITY_ID AS ACTIVITY_ID_1 ,
  FTB_ACTIVITY_BASE_2.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_ACTIVITY_BASE_2.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ACTIVITY_BASE_2.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE_2.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_ACTIVITY_BASE_2.PROMOTER_CD AS PROMOTER_CD ,
  FTB_ACTIVITY_BASE_2.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_ACTIVITY_BASE_2.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_ACTIVITY_BASE_2.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_ACTIVITY_BASE_2.REFERENCE_ID AS REFERENCE_ID ,
  FTB_ACTIVITY_BASE_2.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  FTB_ACTIVITY_BASE_2.COL AS COL ,
  FT_TRIAL_ES_TT.COMPANY_CD AS COMPANY_CD_1 ,
  FT_TRIAL_ES_TT.DIVISION_CD AS DIVISION_CD_1 ,
  FT_TRIAL_ES_TT.ORDER_DATE_DT AS ORDER_DATE_DT ,
  FT_TRIAL_ES_TT.ORDER_NUMBER_ID AS ORDER_NUMBER_ID ,
  FT_TRIAL_ES_TT.ORDER_TYPE_CODE_CD AS ORDER_TYPE_CODE_CD ,
  FT_TRIAL_ES_TT.ORDER_LINE_NUMBER_ID AS ORDER_LINE_NUMBER_ID ,
  FT_TRIAL_ES_TT.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  FT_TRIAL_ES_TT.SHOP_CD AS SHOP_CD_1 ,
  FT_TRIAL_ES_TT.PRODUCT_CD AS PRODUCT_CD ,
  FT_TRIAL_ES_TT.STATUS_CD AS STATUS_CD ,
  FT_TRIAL_ES_TT.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FT_TRIAL_ES_TT.MARKET_TYPE_CD AS MARKET_TYPE_CD ,
  FT_TRIAL_ES_TT.REASON_CD AS REASON_CD ,
  FT_TRIAL_ES_TT.SIDE_CD AS SIDE_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_TYPE_CD AS PREVIOUS_DOCUMENT_TYPE_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_DT AS PREVIOUS_DOCUMENT_DT ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_NUMBER_ID AS PREVIOUS_DOCUMENT_NUMBER_ID ,
  FT_TRIAL_ES_TT.DOCUMENT_NUMBER_REF_ID AS DOCUMENT_NUMBER_REF_ID ,
  FT_TRIAL_ES_TT.CREATION_DATE_DT AS CREATION_DATE_DT ,
  FT_TRIAL_ES_TT.CANCELLATION_DATE_DT AS CANCELLATION_DATE_DT ,
  FT_TRIAL_ES_TT.DELIVERY_DATE_DT AS DELIVERY_DATE_DT ,
  FT_TRIAL_ES_TT.RETURN_DATE_DT AS RETURN_DATE_DT ,
  FT_TRIAL_ES_TT.HOLD_DATE_DT AS HOLD_DATE_DT ,
  FT_TRIAL_ES_TT.SALE_DATE_DT AS SALE_DATE_DT ,
  FT_TRIAL_ES_TT.UPDATE_STATUS_DT AS UPDATE_STATUS_DT ,
  FT_TRIAL_ES_TT.QUANTITY_QT AS QUANTITY_QT ,
  FT_TRIAL_ES_TT.NET_AMOUNT_CALCULATED_AM AS NET_AMOUNT_CALCULATED_AM ,
  FT_TRIAL_ES_TT.NET_AMOUNT_AM AS NET_AMOUNT_AM ,
  FT_TRIAL_ES_TT.GROSS_AMOUNT_AM AS GROSS_AMOUNT_AM ,
  FT_TRIAL_ES_TT.LIST_PRICE_AMOUNT_AM AS LIST_PRICE_AMOUNT_AM ,
  FT_TRIAL_ES_TT.VAT_RT AS VAT_RT ,
  FT_TRIAL_ES_TT.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FT_TRIAL_ES_TT.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FT_TRIAL_ES_TT.PREVIOUS_DOCUMENT_CLOSING_DT AS PREVIOUS_DOCUMENT_CLOSING_DT ,
  FT_TRIAL_ES_TT.ITR_CANDIDATE_FL AS ITR_CANDIDATE_FL ,
  FT_TRIAL_ES_TT.ITR_DOCUMENT_FL AS ITR_DOCUMENT_FL ,
  ROW_NUMBER() over(partition by 
                  FT_TRIAL_ES_TT.MASTER_COMPANY_CD
                 ,FT_TRIAL_ES_TT.MASTER_DIVISION_CD
                 ,FT_TRIAL_ES_TT.ORDER_DATE_DT
                 ,FT_TRIAL_ES_TT.ORDER_NUMBER_ID
                 ,FT_TRIAL_ES_TT.ORDER_TYPE_CODE_CD
                 ,FT_TRIAL_ES_TT.ORDER_LINE_NUMBER_ID 
                 order by 
                  ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE  desc
                 ,ALL_ACTIVITY_ES_TT1_1.DT_INSERT DESC
                 ,ALL_ACTIVITY_ES_TT1_1.SHOP_CODE
                 ,ALL_ACTIVITY_ES_TT1_1.LAPTOP_CODE
                 ,ALL_ACTIVITY_ES_TT1_1.ACTIVITY_ID
                 ) AS COL_1 ,
  STANDARD_HASH ( FT_TRIAL_ES_TT.MASTER_COMPANY_CD || FT_TRIAL_ES_TT.MASTER_DIVISION_CD || FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD ) AS COL_2   
FROM 
  (<?= odiRef.getObjectName("L", "FTB_TRIAL_BASE", "LOG_BDFL", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FT_TRIAL_ES_TT  LEFT OUTER JOIN  (
SELECT 
  FTB_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE_1.SHOP_CD AS SHOP_CD ,
  FTB_ACTIVITY_BASE_1.LAPTOP_CD AS LAPTOP_CD ,
  FTB_ACTIVITY_BASE_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_ACTIVITY_BASE_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ACTIVITY_BASE_1.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_ACTIVITY_BASE_1.PROMOTER_CD AS PROMOTER_CD ,
  FTB_ACTIVITY_BASE_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_ACTIVITY_BASE_1.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_ACTIVITY_BASE_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_ACTIVITY_BASE_1.REFERENCE_ID AS REFERENCE_ID ,
  FTB_ACTIVITY_BASE_1.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  FTB_ACTIVITY_BASE_1.COL AS COL   
FROM 
  (
SELECT 
  FTB_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE.SHOP_CD AS SHOP_CD ,
  FTB_ACTIVITY_BASE.LAPTOP_CD AS LAPTOP_CD ,
  FTB_ACTIVITY_BASE.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_ACTIVITY_BASE.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_ACTIVITY_BASE.PROMOTER_CD AS PROMOTER_CD ,
  FTB_ACTIVITY_BASE.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_ACTIVITY_BASE.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_ACTIVITY_BASE.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_ACTIVITY_BASE.REFERENCE_ID AS REFERENCE_ID ,
  FTB_ACTIVITY_BASE.REFERENCE_DATE_DT AS REFERENCE_DATE_DT ,
  rank() over(partition by FTB_ACTIVITY_BASE.REFERENCE_DATE_DT 
                       , FTB_ACTIVITY_BASE.REFERENCE_ID   
order by FTB_ACTIVITY_BASE.ACTIVITY_DATE_DT  desc
       , FTB_ACTIVITY_BASE.ACTIVITY_ID       desc
       , FTB_ACTIVITY_BASE.LAPTOP_CD
       , FTB_ACTIVITY_BASE.SHOP_CD
       , FTB_ACTIVITY_BASE.CUSTOMER_CD ) AS COL   
FROM 
  <?= odiRef.getObjectName("L", "FTB_ACTIVITY_BASE", "LOG_BDFL", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FTB_ACTIVITY_BASE  
WHERE
  (FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD IN ('RH','TR')
) 
  ) FTB_ACTIVITY_BASE_1  
WHERE
  (FTB_ACTIVITY_BASE_1.COL = 1
) 
  ) FTB_ACTIVITY_BASE_2  
    ON  FTB_ACTIVITY_BASE_2.COMPANY_CD        = FT_TRIAL_ES_TT.COMPANY_CD 
and FTB_ACTIVITY_BASE_2.DIVISION_CD       = FT_TRIAL_ES_TT.DIVISION_CD 
and FTB_ACTIVITY_BASE_2.REFERENCE_DATE_DT = FT_TRIAL_ES_TT.ORDER_DATE_DT 
and FTB_ACTIVITY_BASE_2.REFERENCE_ID      = FT_TRIAL_ES_TT.ORDER_NUMBER_ID
     )  LEFT OUTER JOIN  (
SELECT 
  ALL_ACTIVITY_ES_TT1.SHOP_CODE AS SHOP_CODE ,
  ALL_ACTIVITY_ES_TT1.LAPTOP_CODE AS LAPTOP_CODE ,
  ALL_ACTIVITY_ES_TT1.ACTIVITY_ID AS ACTIVITY_ID ,
  ALL_ACTIVITY_ES_TT1.ACTIVITY_DATE AS ACTIVITY_DATE ,
  ALL_ACTIVITY_ES_TT1.TESTRESULT_LEFT AS TESTRESULT_LEFT ,
  ALL_ACTIVITY_ES_TT1.TESTRESULT_RIGHT AS TESTRESULT_RIGHT ,
  ALL_ACTIVITY_ES_TT1.DT_INSERT AS DT_INSERT ,
  ALL_ACTIVITY_ES_TT1.IS_TEST_FL AS IS_TEST_FL ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_DIVISION_CODE AS MASTER_CUSTOMER_DIVISION_CODE ,
  ALL_ACTIVITY_ES_TT1.MASTER_CUSTOMER_COMPANY_CODE AS MASTER_CUSTOMER_COMPANY_CODE   
FROM 
  <?= odiRef.getObjectName("L", "ALL_ACTIVITY_ES_TT", "LOG_STG_BDFL", "D") ?> ALL_ACTIVITY_ES_TT1  
WHERE
  (ALL_ACTIVITY_ES_TT1.IS_TEST_FL=1
) 
  ) ALL_ACTIVITY_ES_TT1_1  
    ON  ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_COMPANY_CODE = FT_TRIAL_ES_TT.MASTER_COMPANY_CD AND
ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_DIVISION_CODE = FT_TRIAL_ES_TT.MASTER_DIVISION_CD AND
ALL_ACTIVITY_ES_TT1_1.MASTER_CUSTOMER_CODE = FT_TRIAL_ES_TT.MASTER_CUSTOMER_CD AND
ALL_ACTIVITY_ES_TT1_1.ACTIVITY_DATE <= FT_TRIAL_ES_TT.CREATION_DATE_DT
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_1=1
) 
  ) INLINE_VIEW_1  LEFT OUTER JOIN  (
SELECT 
  DISTINCT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD)) AS CUSTOMER_CD ,
  STANDARD_HASH((COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD))) AS CUSTOMER_HK ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_TO_DT AS STATUS_TO_DT ,
  CASE WHEN CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID = 6 
     THEN COALESCE(CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_HEADER_DT, CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_ITEM_H_DT)
     ELSE NULL
END AS D_CLC_LAST_SALE_HOT_COLD_DT   
FROM 
  (
SELECT 
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD AS COMPANY_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD AS DIVISION_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_HEADER_DT AS LAST_HA_HEADER_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_ITEM_H_DT AS LAST_HA_ITEM_H_DT   
FROM 
  <?= odiRef.getObjectName("L", "CL_LIGHT_CUSTOMER_STATUS", "LOG_EDW", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> CL_LIGHT_CUSTOMER_STATUS_RMAP_  
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) 
  ) CL_LIGHT_CUSTOMER_STATUS_RMA_1  LEFT OUTER JOIN  (
SELECT 
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL AS X_AUD_CURRENT_FL ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE AS COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE AS MASTER_COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AS MASTER_DIVISION_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE   
FROM 
  <?= odiRef.getObjectName("L", "UM_CU_S_CUSTOMER_MAPPING", "LOG_EDW", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE") ?> UM_CU_S_CUSTOMER_MAPPING_RMAP_  
WHERE
  (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) UM_CU_S_CUSTOMER_MAPPING_RMA_1  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE
  ) DISTINCT__RMAP_ES_CUSTOMER_STA  
    ON  INLINE_VIEW_1.COL_2               = DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AND
INLINE_VIEW_1.CREATION_DATE_DT - 1 >= DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AND
INLINE_VIEW_1.CREATION_DATE_DT - 1 < NVL(DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT, TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  
    ON  INLINE_VIEW_1.MASTER_COMPANY_CD = DM_CUSTOMER_HST.D15_COMPANY_CD
AND
INLINE_VIEW_1.MASTER_DIVISION_CD = DM_CUSTOMER_HST.D15_DIVISION_CD
AND
INLINE_VIEW_1.MASTER_CUSTOMER_CD = DM_CUSTOMER_HST.D15_CUSTOMER_CD
AND
TRUNC(
COALESCE(
INLINE_VIEW_1.SALE_DATE_DT,INLINE_VIEW_1.HOLD_DATE_DT,INLINE_VIEW_1.RETURN_DATE_DT,INLINE_VIEW_1.DELIVERY_DATE_DT,INLINE_VIEW_1.CANCELLATION_DATE_DT,INLINE_VIEW_1.CREATION_DATE_DT)) 
>= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) 
AND
TRUNC(
COALESCE(
INLINE_VIEW_1.SALE_DATE_DT,INLINE_VIEW_1.HOLD_DATE_DT,INLINE_VIEW_1.RETURN_DATE_DT,INLINE_VIEW_1.DELIVERY_DATE_DT,INLINE_VIEW_1.CANCELLATION_DATE_DT,INLINE_VIEW_1.CREATION_DATE_DT))
<=  TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW_2  
    ON  STANDARD_HASH(INLINE_VIEW_2.COMPANY_CD_1||INLINE_VIEW_2.DIVISION_CD_1||INLINE_VIEW_2.SHOP_CD_1)=DM_PRODUCT_HST_1.PRODUCT_HK
AND
TRUNC(
COALESCE(
INLINE_VIEW_2.SALE_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.RETURN_DATE_DT,INLINE_VIEW_2.DELIVERY_DATE_DT,INLINE_VIEW_2.CANCELLATION_DATE_DT,INLINE_VIEW_2.CREATION_DATE_DT)) 
>= TRUNC(DM_PRODUCT_HST_1.X_AUD_FROM_TS) 
AND
TRUNC(
COALESCE(
INLINE_VIEW_2.SALE_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.HOLD_DATE_DT,INLINE_VIEW_2.DELIVERY_DATE_DT,INLINE_VIEW_2.CANCELLATION_DATE_DT,INLINE_VIEW_2.CREATION_DATE_DT))
<=  TRUNC(DM_PRODUCT_HST_1.X_AUD_TO_TS)
  ) INLINE_VIEW_3  
WHERE
  (INLINE_VIEW_3.COL_3 = 1
) 
  ) INLINE_VIEW_4  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DM_SHOP", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> DM_SHOP  
    ON  INLINE_VIEW_4.COL_4 = DM_SHOP.SHOP_HK
     )  
    ON  INLINE_VIEW_4.COMPANY_CD_1=FT_CUSTOMER_BASE.COMPANY_CD
AND
INLINE_VIEW_4.DIVISION_CD_1=FT_CUSTOMER_BASE.DIVISION_CD
AND
INLINE_VIEW_4.CUSTOMER_CD_1=FT_CUSTOMER_BASE.CUSTOMER_CD
AND
TRUNC(INLINE_VIEW_4.COL_5) >= FT_CUSTOMER_BASE.VALID_FROM_DT
AND
TRUNC(INLINE_VIEW_4.COL_5) < FT_CUSTOMER_BASE.VALID_TO_DT
  ) INLINE_VIEW_5  LEFT OUTER JOIN  (
SELECT 
  FTB_ALL_APPOINTMENTS_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_ALL_APPOINTMENTS_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_ALL_APPOINTMENTS_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ALL_APPOINTMENTS_BASE.APPOINTMENT_ID AS APPOINTMENT_ID ,
  FTB_ALL_APPOINTMENTS_BASE.APPOINTMENT_BOOKING_DT AS APPOINTMENT_BOOKING_DT ,
  FTB_ALL_APPOINTMENTS_BASE.APPOINTMENT_SCHEDULING_DT AS APPOINTMENT_SCHEDULING_DT ,
  FTB_ALL_APPOINTMENTS_BASE.APPOINTMENT_STATUS_CD AS APPOINTMENT_STATUS_CD ,
  FTB_ALL_APPOINTMENTS_BASE.REASON_CLOSING_CD AS REASON_CLOSING_CD ,
  FTB_ALL_APPOINTMENTS_BASE.INVOICING_APP_FL AS INVOICING_APP_FL   
FROM 
  <?= odiRef.getObjectName("L", "FTB_ALL_APPOINTMENTS_BASE", "LOG_BDFL", "D") ?> FTB_ALL_APPOINTMENTS_BASE  
WHERE
  (FTB_ALL_APPOINTMENTS_BASE.INVOICING_APP_FL = 1
AND (
FTB_ALL_APPOINTMENTS_BASE.APPOINTMENT_STATUS_CD NOT IN ('X', 'R', 'E', 'N')
OR
(FTB_ALL_APPOINTMENTS_BASE.APPOINTMENT_STATUS_CD = 'N' AND FTB_ALL_APPOINTMENTS_BASE.REASON_CLOSING_CD NOT IN ('04', '08')))
) 
  ) FTB_ALL_APPOINTMENTS_BASE_1  
    ON  INLINE_VIEW_5.COMPANY_CD_2 || INLINE_VIEW_5.DIVISION_CD_2 || INLINE_VIEW_5.CUSTOMER_CD_2 = FTB_ALL_APPOINTMENTS_BASE_1.COMPANY_CD || FTB_ALL_APPOINTMENTS_BASE_1.DIVISION_CD || FTB_ALL_APPOINTMENTS_BASE_1.CUSTOMER_CD 
AND FTB_ALL_APPOINTMENTS_BASE_1.APPOINTMENT_SCHEDULING_DT >= TRUNC(SYSDATE)
  ) INLINE_VIEW_6  
WHERE
  (INLINE_VIEW_6.COL_6 = '1'
) 
  ) INLINE_VIEW_7  LEFT OUTER JOIN  (
SELECT 
  FTB_ACTIVITY_BASE1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE1.CUSTOMER_CD AS CUSTOMER_CD   
FROM 
  <?= odiRef.getObjectName("L", "FTB_ACTIVITY_BASE", "LOG_BDFL", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FTB_ACTIVITY_BASE1  
WHERE
  ((FTB_ACTIVITY_BASE1.DIVISION_CD in ('001', '003') AND FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD = 'VM') 
OR (FTB_ACTIVITY_BASE1.DIVISION_CD = '002' AND FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD = 'VM' AND  TRUNC(FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT) >= to_date('2019-01-01','yyyy-mm-dd'))
) 
GROUP BY
  FTB_ACTIVITY_BASE1.COMPANY_CD,FTB_ACTIVITY_BASE1.DIVISION_CD,FTB_ACTIVITY_BASE1.CUSTOMER_CD 
  ) FTB_ACTIVITY_BASE1_1  
    ON  FTB_ACTIVITY_BASE1_1.COMPANY_CD =  INLINE_VIEW_7.COMPANY_CD_3  
AND FTB_ACTIVITY_BASE1_1.DIVISION_CD = INLINE_VIEW_7.DIVISION_CD_3 
AND FTB_ACTIVITY_BASE1_1.CUSTOMER_CD = INLINE_VIEW_7.CUSTOMER_CD_3
where		(1=1)	
)  ODI_GET_FROM
   ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1bc4a4fe-ddee-426b-8d65-75bc8d94d64d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[240]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Insert new rows]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2a0cc5c1-4537-4b67-903a-71359bc20ae0]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[230]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Disable indexes]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2c252da7-f1d3-405f-9ae7-c6c130e1c6d6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[250]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Enable indexes]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[/*commit*/ ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5d1175f1-9447-4f95-be02-2ab50d98ac21]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[270]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Commit transaction]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[create table <?= odiRef.getObjectName("L", "FT_TRIAL", "LOG_BDFL_DMM", "D") ?>
(
	X_AUD_DATASOURCE_ID	NUMBER NULL,
	X_AUD_SESSION_ID	NUMBER NULL,
	X_AUD_FROM_TS	TIMESTAMP(6) NULL,
	X_AUD_TO_TS	TIMESTAMP(6) NULL,
	X_AUD_CURRENT_FL	NUMBER NULL,
	X_AUD_AGENT_CD	VARCHAR2(100 CHAR) NULL,
	X_AUD_INSERT_TS	TIMESTAMP(6) NULL,
	X_AUD_UPDATE_TS	TIMESTAMP(6) NULL,
	X_AUD_COMPANY_CD	VARCHAR2(3 CHAR) NULL,
	COMPANY_CD	VARCHAR2(63 CHAR) NULL,
	DIVISION_CD	VARCHAR2(63 CHAR) NULL,
	ORDER_DATE_DT	DATE NULL,
	ORDER_NUMBER_ID	VARCHAR2(63 CHAR) NULL,
	ORDER_TYPE_CODE_CD	VARCHAR2(63 CHAR) NULL,
	ORDER_LINE_NUMBER_ID	VARCHAR2(63 CHAR) NULL,
	COMPANY_HK	VARCHAR2(63 CHAR) NULL,
	CUSTOMER_HK	VARCHAR2(63 CHAR) NULL,
	CLC_STATUS_HK	VARCHAR2(63 CHAR) NULL,
	CUSTOMER_HST_SK	NUMBER NULL,
	SHOP_HK	VARCHAR2(63 CHAR) NULL,
	DAYCENTER_HK	VARCHAR2(63 CHAR) NULL,
	LOCATION_TYPE_HK	VARCHAR2(63 CHAR) NULL,
	EMPLOYEE_HK	VARCHAR2(63 CHAR) NULL,
	EMP_PROMOTER_HK	VARCHAR2(63 CHAR) NULL,
	CAMPAIGN_HK	VARCHAR2(63 CHAR) NULL,
	MEDIATYPE_HK	VARCHAR2(63 CHAR) NULL,
	TEST_RESULT_HK	VARCHAR2(63 CHAR) NULL,
	MARKET_TYPE_HK	VARCHAR2(63 CHAR) NULL,
	PRODUCT_HK	VARCHAR2(63 CHAR) NULL,
	DOCUMENT_HK	VARCHAR2(63 CHAR) NULL,
	PRODUCT_HST_SK	NUMBER NULL,
	CREATION_DATE_SK	NUMBER NULL,
	DELIVERY_DATE_SK	NUMBER NULL,
	CANCELLATION_DATE_SK	NUMBER NULL,
	RETURN_DATE_SK	NUMBER NULL,
	HOLD_DATE_SK	NUMBER NULL,
	SALE_DATE_SK	NUMBER NULL,
	D51_CREATION_DATE_DT	TIMESTAMP(6) NULL,
	D130_DELIVERY_DATE_DT	TIMESTAMP(6) NULL,
	D131_CANCELLATION_DATE_DT	TIMESTAMP(6) NULL,
	D132_RETURN_DATE_DT	TIMESTAMP(6) NULL,
	D133_HOLD_DATE_DT	TIMESTAMP(6) NULL,
	D133_SALE_DATE_DT	TIMESTAMP(6) NULL,
	D134_REASON_CODE_CD	VARCHAR2(63 CHAR) NULL,
	D41_DOCUMENT_STATUS_CD	VARCHAR2(63 CHAR) NULL,
	D40_UPDATE_STATUS_DATE_DT	DATE NULL,
	D_LAST_SALE_HOT_COLD_DT	DATE NULL,
	D_CLC_REFERENCE_DATE_DT	DATE NULL,
	D_SIDE_CODE_CD	VARCHAR2(63 CHAR) NULL,
	M8_CLIENT_ID	VARCHAR2(63 CHAR) NULL,
	M7_DOCUMENT_ID	VARCHAR2(63 CHAR) NULL,
	M_CLIENT_SHOP_MONTH_ID	VARCHAR2(63 CHAR) NULL,
	M6_TRIAL_QT	NUMBER NULL,
	M_VAT_AM	NUMBER NULL,
	M9_UNIT_LISTPRICE_NET_AM	NUMBER NULL,
	M326_UNIT_PROP_PRICE_NET_AM	NUMBER NULL,
	M326_UNIT_PROP_PRICE_GROSS_AM	NUMBER NULL,
	M326_UNIT_CALC_PRICE_NET_AM	NUMBER NULL,
	M_SAME_STORE_GROWTH_PY_FL	NUMBER NULL,
	M_SAME_STORE_GROWTH_CY_FL	NUMBER NULL,
	ITR_CANDIDATE_FL	NUMBER NULL,
	ITR_DOCUMENT_FL	NUMBER NULL,
	CRM_LAST_MARKETING_LIST_HK	VARCHAR2(63 CHAR) NULL,
	CRM_LAST_RESULT_HK	VARCHAR2(63 CHAR) NULL,
	CRM_LAST_TM_MARKETING_LIST_HK	VARCHAR2(63 CHAR) NULL,
	CRM_LAST_TM_RESULT_HK	VARCHAR2(63 CHAR) NULL,
	ENR_LAST_NBA_HK	VARCHAR2(63 CHAR) NULL,
	CTB_CONTACTABILITY_HK	VARCHAR2(63 CHAR) NULL,
	INT_LAST_INTERACTION_HK	VARCHAR2(63 CHAR) NULL,
	TST_LAST_TEST_HK	VARCHAR2(63 CHAR) NULL,
	TRI_LAST_TRIAL_HK	VARCHAR2(63 CHAR) NULL,
	COM_LAST_SALE_HK	VARCHAR2(63 CHAR) NULL,
	TEST_AGEING_SK	NUMBER NULL,
	INTERACTION_AGEING_SK	NUMBER NULL,
	PREVIOUS_DOCUMENT_DT	DATE NULL,
	PREVIOUS_DOCUMENT_NUMBER_ID	VARCHAR2(63 CHAR) NULL,
	PREVIOUS_DOCUMENT_TYPE_CD	VARCHAR2(63 CHAR) NULL,
	PREVIOUS_DOCUMENT_CLOSING_DT	DATE NULL,
	TRIAL_WITH_UP_FL	NUMBER NULL,
	NEXT_INV_APP_FL	NUMBER NULL,
	NEXT_INV_APP_BOOKING_DT	DATE NULL,
	NEXT_INV_APP_SCHEDULING_DT	DATE NULL,
	ITR_SK	CHAR(2) NULL,
	MEDICAL_MEDIATYPE_HK	VARCHAR2(63 CHAR) NULL,
	TRIAL_AGEING_SK	NUMBER NULL
)  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[43dbf239-e9a9-45b1-884e-54d2bdc9507d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[80]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Create target table ]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[alter table <?= odiRef.getObjectName("L", "FT_TRIAL", "LOG_BDFL_DMM", "D") ?> truncate partition (#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET)  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[29de4e9c-26e3-497e-ae2f-85b9ca5d8137]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Truncate target table partition]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1bed6a58-25e4-4871-ad5e-0d9ef616b9fd]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[260]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Enable constraints]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[566429f1-3a8b-4ce8-8773-db62c3cc62dc]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[220]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[100]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Disable constraints]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ea0e96eb-2804-477f-8f9a-da04aad4f669]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_CLEANUP]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[22b7cdbe-1471-4fcf-97e2-b6fc5b44b8b5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_EDW_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[2]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[GENERIC_SQL]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
<?
String dblinkToSrc = "";
if ("".equals(dblinkToSrc)) {
  dblinkToSrc = odiRef.getInfo("SRC_LSCHEMA_NAME");
}
if ("TRUE".equals("TRUE")) {
  dblinkToSrc += "%UNIQUE_SESSION_TAG";
}
dblinkToSrc = dblinkToSrc.replaceAll(" ","");
dblinkToSrc = dblinkToSrc.replaceAll("-","");
dblinkToSrc = odiRef.getFormattedName(dblinkToSrc);
?>
drop database link <?=dblinkToSrc ?>
       ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[06a56c95-42fb-4a78-a288-9e3e3a8767f3]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14812]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Drop database link to source]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[LKM Oracle to Oracle Pull (DB Link)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PACKAGE.9241]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[477a262e-fac8-4da1-a093-63bf78388d89]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[BDFL_AMP.DMM_BDL_ES.PKG_BDL_ES_2_FT_TRIAL]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER.SNP_PACKAGE]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[8.10.21]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCEN.14812]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[87e91f33-bacd-421c-b684-04b519a919bd]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[BDFL_AMP.DMM_BDL_ES.PKG_BDL_ES_2_FT_TRIAL.PKG_BDL_ES_2_FT_TRIAL Version 001]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER.SNP_PACKAGE.SNP_SCEN]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[8.10.21.33]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_EXPTXTHEADER.65207]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0d5b7aef-f194-41e1-b9bd-ad720b45b413]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14812.0]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0f924a65-1252-4e58-acf4-9f1cbe5bfd17]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14812.1]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[fa100a36-4290-4248-993b-564e3d586bfd]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14812.2]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a40696c9-3591-4e7b-aaef-2757a52587ce]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14812.3]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5f41c65f-4881-4755-9c8e-ea589b570b7e]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14812.4]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6ae4cfe9-56fe-4d8b-acdc-6fae13eaa99e]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpImportRep">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b0077bd8-1c01-492b-8c65-75d562351aca]]></Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepShortId" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="RepTimestamp" type="java.lang.String"><![CDATA[1510079777723]]></Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[76]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.09]]></Field>
</Object>
</SunopsisExport>
