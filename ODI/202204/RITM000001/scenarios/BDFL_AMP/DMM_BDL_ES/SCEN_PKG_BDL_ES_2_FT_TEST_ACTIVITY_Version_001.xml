<?xml version="1.0" encoding="ISO-8859-1"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.09" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="GDHTAJQKpBdIOGlSjqVJI4p77VbIEcoDjP991dV7VFk=" keyVect="bEux8TITxbGhO9GYlJS20Q==" exportKeySalt="e832520a-f947-4f86-8fe6-d89e4799f29d" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpScen">
		<Field name="CecSessBehavior" type="java.lang.String">null</Field>
	<Field name="CecSessPollIntv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-06-06 20:16:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[TST_MPEROTA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[21c978c2-5e38-45fe-9f20-de81c038fbee]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndPromptParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
	<Field name="IsMaterialized" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IDeploySpec" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IMapping" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IPackage" type="com.sunopsis.sql.DbInt"><![CDATA[9251]]></Field>
	<Field name="IPop" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScenFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtScen" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-06-06 20:16:30.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[TST_MPEROTA]]></Field>
	<Field name="MaxCecSess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="RestartType" type="java.lang.String">null</Field>
	<Field name="ScenName" type="java.lang.String"><![CDATA[PKG_BDL_ES_2_FT_TEST_ACTIVITY]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenSnapshotNo" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="ScenVersion" type="java.lang.String"><![CDATA[001]]></Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[402428ed-b617-4a18-aff8-5fda48bd9840]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[7012681]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[7012681]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[460060]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-06-01 19:37:22.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1091]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-06-01 19:55:33.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String"><![CDATA[ODI-1217: Session PKG_BDL_ES_2_FT_TEST_ACTIVITY (449672) fails with return code ODI-1298.
ODI-1226: Step MAP_ES_FT_TEST_ACTIVITY fails after 1 attempt(s).
ODI-1240: Flow MAP_ES_FT_TEST_ACTIVITY fails while performing a Truncate target table partition-IKM Oracle Control Append for BDFL (multi-partition)- operation. This flow loads target table FT_TEST_ACTIVITY.
ODI-1298: Serial task "SERIAL-MAP_MAIN- (40)" failed because child task "SERIAL-EU-LOG_BDFL_DMM (70)" is in error.
ODI-1298: Serial task "SERIAL-EU-LOG_BDFL_DMM (70)" failed because child task "Truncate target table partition-IKM Oracle Control Append for BDFL (multi-partition)- (90)" is in error.
ODI-1228: Task Truncate target table partition-IKM Oracle Control Append for BDFL (multi-partition)- fails on the target connection PHY_BDFL_DMM_ES.
Caused By: java.sql.SQLException: ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:510)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:462)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1105)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:551)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:269)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:656)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:230)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:42)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:929)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1280)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1921)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1876)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:304)
	at oracle.odi.runtime.agent.execution.sql.SQLCommand.execute(SQLCommand.java:208)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:142)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:28)
	at oracle.odi.runtime.agent.execution.TaskExecutionHandler.handleTask(TaskExecutionHandler.java:52)
	at oracle.odi.runtime.agent.execution.SessionTask.processTask(SessionTask.java:216)
	at oracle.odi.runtime.agent.execution.SessionTask.doExecuteTask(SessionTask.java:128)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.execute(AbstractSessionTask.java:886)
	at oracle.odi.runtime.agent.execution.SessionExecutor$SerialTrain.runTasks(SessionExecutor.java:2225)
	at oracle.odi.runtime.agent.execution.SessionExecutor.executeSession(SessionExecutor.java:610)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:718)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:611)
	at oracle.odi.core.persistence.dwgobject.DwgObjectTemplate.execute(DwgObjectTemplate.java:203)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor.doProcessStartAgentTask(TaskExecutorAgentRequestProcessor.java:800)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor.access$2700(StartScenRequestProcessor.java:85)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor$StartScenTask.doExecute(StartScenRequestProcessor.java:917)
	at oracle.odi.runtime.agent.processor.task.AgentTask.execute(AgentTask.java:180)
	at oracle.odi.runtime.agent.support.DefaultAgentTaskExecutor$2.run(DefaultAgentTaskExecutor.java:108)
	at java.lang.Thread.run(Thread.java:748)
Caused by: Error : 54, Position : 24, Sql = alter table DMM_BDL_ANL.FT_TEST_ACTIVITY truncate partition (P_ES)  , OriginalSql = alter table DMM_BDL_ANL.FT_TEST_ACTIVITY truncate partition (P_ES)  , Error Msg = ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:514)
	... 30 more
]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[05cfeff0-d42f-488c-ba6b-5ea8fc07cf3c]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[449672]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-04-03 11:03:20.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[0]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-04-03 11:03:20.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[ODI-1298]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[E]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c36d74bf-90f2-4957-90bb-54970fa5cf8c]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6954351]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6954351]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[458328]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-25 11:38:13.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1586]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-25 12:04:39.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[262f770d-ded9-4de1-bf0e-1efa2c63280b]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233454]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 13:04:19.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1170]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 13:23:49.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[aac82adb-7e2e-476e-bd0a-e9cc5500bab0]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233482]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 15:06:48.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1849]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 15:37:37.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[75792e3a-47dc-475c-9108-7139cd6c6d00]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[235681]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-13 11:25:34.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1069]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-13 11:43:23.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d46682cb-7935-46b3-92d5-a15453e66d22]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[235925]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-13 22:18:46.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[992]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-13 22:35:18.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String"><![CDATA[ODI-1256: Session PKG_BDL_ES_2_FT_TEST_ACTIVITY (449687) stopped (Normal) by user TST_JHOXHA.
ODI-1263: Step MAP_ES_FT_TEST_ACTIVITY stopped (Normal) by user TST_JHOXHA.
ODI-1240: Flow MAP_ES_FT_TEST_ACTIVITY fails while performing a Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- operation. This flow loads target table FT_TEST_ACTIVITY.
ODI-1259: Session Task SERIAL-MAP_MAIN- stopped (Normal) by user TST_JHOXHA.
ODI-1298: Serial task "SERIAL-MAP_MAIN- (40)" failed because child task "SERIAL-EU-LOG_BDFL_DMM (70)" is in error.
ODI-1259: Session Task SERIAL-EU-LOG_BDFL_DMM stopped (Normal) by user TST_JHOXHA.
ODI-1298: Serial task "SERIAL-EU-LOG_BDFL_DMM (70)" failed because child task "Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- (120)" is in error.
ODI-1259: Session Task Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- stopped (Normal) by user TST_JHOXHA.
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.getStopTaskAgentException(AbstractSessionTask.java:1193)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.postProcess(AbstractSessionTask.java:1234)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.execute(AbstractSessionTask.java:913)
	at oracle.odi.runtime.agent.execution.SessionExecutor$SerialTrain.runTasks(SessionExecutor.java:2224)
	at oracle.odi.runtime.agent.execution.SessionExecutor.executeSession(SessionExecutor.java:610)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:718)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:611)
	at oracle.odi.core.persistence.dwgobject.DwgObjectTemplate.execute(DwgObjectTemplate.java:203)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor.doProcessStartAgentTask(TaskExecutorAgentRequestProcessor.java:800)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor.access$2700(StartScenRequestProcessor.java:85)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor$StartScenTask.doExecute(StartScenRequestProcessor.java:917)
	at oracle.odi.runtime.agent.processor.task.AgentTask.execute(AgentTask.java:180)
	at oracle.odi.runtime.agent.support.DefaultAgentTaskExecutor$2.run(DefaultAgentTaskExecutor.java:108)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at oracle.odi.runtime.agent.execution.job.OdiJob.call(OdiJob.java:73)
	at oracle.odi.runtime.agent.execution.job.OdiJob.call(OdiJob.java:73)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2cbfe65d-72d8-4a86-a934-e4afa3d4adca]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[449687]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-04-04 10:09:38.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[896]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-04-04 10:24:34.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[ODI-1298]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[E]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4d13333f-cc9d-4af0-a073-1cfd10098588]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[243847]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-10-04 11:22:44.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[600]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-10-04 11:32:44.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5c730d3e-f84e-455c-ba52-ba386098ea68]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[234597]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-07 10:27:23.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1375]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-07 10:50:18.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[69a3bbc8-4853-47e4-bbe3-b4bdeca278de]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[443456]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-02-25 14:37:13.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[992]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-02-25 14:53:45.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cbe524a6-1f13-4038-8d5d-148a82b79d55]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233546]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 20:15:03.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1238]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 20:35:41.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[add51ad9-40fd-4658-94de-f6f8afe9e3f8]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233136]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-06-29 17:00:40.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[904]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-06-29 17:15:44.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[991672a1-7e6c-4b60-9c30-0978d92e8445]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233413]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 08:27:46.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1164]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 08:47:10.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[22b02c97-fc29-48f7-8486-cfa56d898dfb]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[233417]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-01 09:50:10.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[952]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-01 10:06:02.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2f8ec0c6-fb6b-47af-956d-39fe842cfbfd]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[235980]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-07-14 08:37:24.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[980]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-07-14 08:53:44.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[502b9550-1f75-4eec-934f-eb2393ee88b3]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6665385]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[243753]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2021-10-01 19:13:05.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[586]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2021-10-01 19:22:51.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String"><![CDATA[ODI-1217: Session PKG_BDL_ES_2_FT_TEST_ACTIVITY (446866) fails with return code ODI-1298.
ODI-1226: Step MAP_ES_FT_TEST_ACTIVITY fails after 1 attempt(s).
ODI-1240: Flow MAP_ES_FT_TEST_ACTIVITY fails while performing a Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- operation. This flow loads target table FT_TEST_ACTIVITY.
ODI-1298: Serial task "SERIAL-MAP_MAIN- (40)" failed because child task "SERIAL-EU-LOG_BDFL_DMM (70)" is in error.
ODI-1298: Serial task "SERIAL-EU-LOG_BDFL_DMM (70)" failed because child task "Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- (120)" is in error.
ODI-1228: Task Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- fails on the target connection PHY_BDFL_DMM_ES.
Caused By: java.sql.SQLSyntaxErrorException: ORA-00904: "FTB_TEST_ACTIVITY_BASE"."CAMPO_LIBRE_FL": invalid identifier

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:510)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:462)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1105)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:551)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:269)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:656)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:230)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:42)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:929)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1280)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1921)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1876)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:304)
	at oracle.odi.runtime.agent.execution.sql.SQLCommand.execute(SQLCommand.java:208)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:142)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:28)
	at oracle.odi.runtime.agent.execution.TaskExecutionHandler.handleTask(TaskExecutionHandler.java:52)
	at oracle.odi.runtime.agent.execution.SessionTask.processTask(SessionTask.java:217)
	at oracle.odi.runtime.agent.execution.SessionTask.doExecuteTask(SessionTask.java:129)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.execute(AbstractSessionTask.java:886)
	at oracle.odi.runtime.agent.execution.SessionExecutor$SerialTrain.runTasks(SessionExecutor.java:2224)
	at oracle.odi.runtime.agent.execution.SessionExecutor.executeSession(SessionExecutor.java:610)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:718)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:611)
	at oracle.odi.core.persistence.dwgobject.DwgObjectTemplate.execute(DwgObjectTemplate.java:203)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor.doProcessStartAgentTask(TaskExecutorAgentRequestProcessor.java:800)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor.access$2700(StartScenRequestProcessor.java:85)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor$StartScenTask.doExecute(StartScenRequestProcessor.java:917)
	at oracle.odi.runtime.agent.processor.task.AgentTask.execute(AgentTask.java:180)
	at oracle.odi.runtime.agent.support.DefaultAgentTaskExecutor$2.run(DefaultAgentTaskExecutor.java:108)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at oracle.odi.runtime.agent.execution.job.OdiJob.call(OdiJob.java:73)
	at oracle.odi.runtime.agent.execution.job.OdiJob.call(OdiJob.java:73)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: Error : 904, Position : 13645, Sql = 
insert /*+ APPEND */ into	DMM_BDL_ANL.FT_TEST_ACTIVITY
 PARTITION(P_ES)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	VIA_AEREA_FL,
	VIA_OSEA_FL,
	CAMPO_LIBRE_FL,
	TEST_TYPE_SK,
	TEST_TYPE_DS 
) 
select /*+  */
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	VIA_AEREA_FL,
	VIA_OSEA_FL,
	CAMPO_LIBRE_FL,
	TEST_TYPE_SK,
	TEST_TYPE_DS   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	439283 X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'MAP_ES_FT_TEST_ACTIVITY' || ' (' || 'CTX_ES' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_1.COMPANY_CD X_AUD_COMPANY_CD,
	INLINE_VIEW_1.COMPANY_CD COMPANY_CD,
	INLINE_VIEW_1.DIVISION_CD DIVISION_CD,
	INLINE_VIEW_1.SHOP_CD SHOP_CD,
	INLINE_VIEW_1.LAPTOP_CD LAPTOP_CD,
	INLINE_VIEW_1.ACTIVITY_ID ACTIVITY_ID,
	INLINE_VIEW_1.ACTIVITY_DATE_DT ACTIVITY_DATE_DT,
	INLINE_VIEW_1.CUSTOMER_CD CUSTOMER_CD,
	STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD ) COMPANY_HK,
	INLINE_VIEW_1.COL CUSTOMER_HK,
	CAST(STANDARD_HASH(NVL(INLINE_VIEW_1.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) ) CLC_STATUS_HK,
	INLINE_VIEW_1.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_1.COL_1 SHOP_HK,
	CASE WHEN INLINE_VIEW_1.DAYCENTER_CD IS NOT NULL
     THEN STANDARD_HASH ( INLINE_VIEW_1.COMPANY_CD   || INLINE_VIEW_1.DIVISION_CD ||
                          INLINE_VIEW_1.DAYCENTER_CD || INLINE_VIEW_1.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_1.LOCATION_TYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD || INLINE_VIEW_1.LOCATION_TYPE_CD )
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_1.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD  || INLINE_VIEW_1.DIVISION_CD ||
                      INLINE_VIEW_1.EMPLOYEE_CD || INLINE_VIEW_1.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_1.PROMOTER_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD  || INLINE_VIEW_1.DIVISION_CD || 
                      INLINE_VIEW_1.PROMOTER_CD || INLINE_VIEW_1.SHOP_CD )
  ELSE STANDARD_HASH('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_1.CAMPAIGN_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD || INLINE_VIEW_1.CAMPAIGN_CD )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_1.MEDIATYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD || INLINE_VIEW_1.MEDIATYPE_CD )
  ELSE STANDARD_HASH('-1')
END MEDIA_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD  || '@' ||
               INLINE_VIEW_1.DIVISION_CD || '@' ||
               COALESCE( INLINE_VIEW_1.TEST_RESULT_LEFT_CD,  '-1') || '@' ||
               COALESCE( INLINE_VIEW_1.TEST_RESULT_RIGHT_CD, '-1') ) TEST_RESULT_HK,
	TO_NUMBER(TO_CHAR(INLINE_VIEW_1.ACTIVITY_DATE_DT, 'YYYYMMDD')) ACTIVITY_TEST_DATE_SK,
	INLINE_VIEW_1.ACTIVITY_DATE_DT D_ACTIVITY_TEST_DATE_DT,
	FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 D_CLC_REFERENCE_DATE_DT,
	CASE WHEN INLINE_VIEW_1.TEST_RESULT_RIGHT_CD IS NOT NULL 
       OR INLINE_VIEW_1.TEST_RESULT_LEFT_CD  IS NOT NULL
     THEN 1
     ELSE 0
END M1_VALID_TEST_QT,
	INLINE_VIEW_1.MASTER_COMPANY_CD || INLINE_VIEW_1.MASTER_DIVISION_CD ||
INLINE_VIEW_1.MASTER_CUSTOMER_CD M_CLIENT_ID,
	INLINE_VIEW_1.MASTER_COMPANY_CD  ||
INLINE_VIEW_1.MASTER_DIVISION_CD ||
INLINE_VIEW_1.SHOP_CD            ||
INLINE_VIEW_1.MASTER_CUSTOMER_CD ||
TO_CHAR(INLINE_VIEW_1.ACTIVITY_DATE_DT, 'YYYYMM') M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_1.HEARING_LOSS_FL M_HEARING_LOSS_FL,
	CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD='A'
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= DM_SHOP.D_START_DATE_DT 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, -12)
     THEN 1
     WHEN DM_SHOP.D_SHOP_ORIGIN_CD='N' 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, - 12)
     THEN 1 
     ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD = 'A' 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= DM_SHOP.D_END_DATE_DT 
     THEN 1
     WHEN DM_SHOP.D_SHOP_ORIGIN_CD = 'N' 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 24) 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= DM_SHOP.D_END_DATE_DT 
     THEN 1 
     ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_CY_FL,
	FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	FT_CUSTOMER_BASE.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	FT_CUSTOMER_BASE.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	FT_CUSTOMER_BASE.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT)
     ELSE 3651
END TEST_AGEING_SK,
	CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1   - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1   - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1   - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT)
     ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_1.VIA_AEREA_FL VIA_AEREA_FL,
	INLINE_VIEW_1.VIA_OSEA_FL VIA_OSEA_FL,
	INLINE_VIEW_1.CAMPO_LIBRE_FL CAMPO_LIBRE_FL,
	INLINE_VIEW_1.TEST_TYPE_SK TEST_TYPE_SK,
	INLINE_VIEW_1.TEST_TYPE_DS TEST_TYPE_DS 
from	DMM_BDL_ANL.FT_CUSTOMER_BASE PARTITION(P_ES) FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.VIA_OSEA_FL AS VIA_OSEA_FL ,
  INLINE_VIEW.VIA_AEREA_FL AS VIA_AEREA_FL ,
  INLINE_VIEW.CAMPO_LIBRE_FL AS CAMPO_LIBRE_FL ,
  INLINE_VIEW.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW.TEST_TYPE_DS AS TEST_TYPE_DS ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COL_1 AS COL_1 ,
  INLINE_VIEW.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW.COL_2 AS COL_2   
FROM 
  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT AS STATUS_TO_DT ,
  FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.VIA_OSEA_FL AS VIA_OSEA_FL ,
  FTB_TEST_ACTIVITY_BASE_1.VIA_AEREA_FL AS VIA_AEREA_FL ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPO_LIBRE_FL AS CAMPO_LIBRE_FL ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_DS AS TEST_TYPE_DS ,
  FTB_TEST_ACTIVITY_BASE_1.COL AS COL ,
  FTB_TEST_ACTIVITY_BASE_1.COL_1 AS COL_1 ,
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.CUSTOMER_HK AS CUSTOMER_HK_1 ,
  ROW_NUMBER() OVER 
(PARTITION BY FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD,  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD
            , FTB_TEST_ACTIVITY_BASE_1.SHOP_CD,     FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD
            , FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID, FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT
            , FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD
     ORDER BY DM_CUSTOMER_HST.X_AUD_FROM_TS ) AS COL_2   
FROM 
  ((
SELECT 
  FTB_TEST_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.VIA_OSEA_FL AS VIA_OSEA_FL ,
  FTB_TEST_ACTIVITY_BASE.VIA_AEREA_FL AS VIA_AEREA_FL ,
  FTB_TEST_ACTIVITY_BASE.CAMPO_LIBRE_FL AS CAMPO_LIBRE_FL ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_DS AS TEST_TYPE_DS ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD IS NOT NULL 
     THEN CASE WHEN FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD is null 
               THEN STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.COMPANY_CD        || FTB_TEST_ACTIVITY_BASE.DIVISION_CD        || FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD        )
               ELSE STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD )
          END
     ELSE STANDARD_HASH ('-1') 
END AS COL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.SHOP_CD IS NOT NULL
     THEN STANDARD_HASH ( FTB_TEST_ACTIVITY_BASE.COMPANY_CD || FTB_TEST_ACTIVITY_BASE.DIVISION_CD || FTB_TEST_ACTIVITY_BASE.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END AS COL_1   
FROM 
  BDFL.FTB_TEST_ACTIVITY_BASE PARTITION(P_ES) FTB_TEST_ACTIVITY_BASE  
  ) FTB_TEST_ACTIVITY_BASE_1  LEFT OUTER JOIN  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  (
SELECT 
  DISTINCT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD)) AS CUSTOMER_CD ,
  STANDARD_HASH((COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD))) AS CUSTOMER_HK ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_TO_DT AS STATUS_TO_DT ,
  CASE WHEN CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID = 6 
     THEN COALESCE(CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_HEADER_DT, CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_ITEM_H_DT)
     ELSE NULL
END AS D_CLC_LAST_SALE_HOT_COLD_DT   
FROM 
  (
SELECT 
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD AS COMPANY_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD AS DIVISION_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_HEADER_DT AS LAST_HA_HEADER_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_ITEM_H_DT AS LAST_HA_ITEM_H_DT   
FROM 
  EDW.CL_LIGHT_CUSTOMER_STATUS PARTITION(P_ES) CL_LIGHT_CUSTOMER_STATUS_RMAP_  
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) 
  ) CL_LIGHT_CUSTOMER_STATUS_RMA_1  LEFT OUTER JOIN  (
SELECT 
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL AS X_AUD_CURRENT_FL ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE AS COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE AS MASTER_COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AS MASTER_DIVISION_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE   
FROM 
  EDW.UM_CU_S_CUSTOMER_MAPPING PARTITION(P_ES_PT) UM_CU_S_CUSTOMER_MAPPING_RMAP_  
WHERE
  (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) UM_CU_S_CUSTOMER_MAPPING_RMA_1  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE
  ) DISTINCT__RMAP_ES_CUSTOMER_STA  
  ) DISTINCT__RMAP_ES_CUSTOMER_S_1  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL = DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1 >= DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1  < NVL(TRUNC(DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT), TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  LEFT OUTER JOIN  DMM_BDL_ANL.DM_CUSTOMER_HST PARTITION(P_ES) DM_CUSTOMER_HST  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL                               = DM_CUSTOMER_HST.CUSTOMER_HK          AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) >= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) AND 
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) <= TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_2=1
) 
  ) INLINE_VIEW_1  LEFT OUTER JOIN  DMM_BDL_ANL.DM_SHOP PARTITION(P_ES) DM_SHOP  
    ON  DM_SHOP.SHOP_HK = INLINE_VIEW_1.COL_1
     )  
    ON  INLINE_VIEW_1.COMPANY_CD  = FT_CUSTOMER_BASE.COMPANY_CD   and
INLINE_VIEW_1.DIVISION_CD = FT_CUSTOMER_BASE.DIVISION_CD  and 
INLINE_VIEW_1.CUSTOMER_CD = FT_CUSTOMER_BASE.CUSTOMER_CD  AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1 >= FT_CUSTOMER_BASE.VALID_FROM_DT AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1  < FT_CUSTOMER_BASE.VALID_TO_DT
where		(1=1)	
)  ODI_GET_FROM
   , OriginalSql =  
insert /*+ APPEND */ into	DMM_BDL_ANL.FT_TEST_ACTIVITY
 PARTITION(P_ES)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	VIA_AEREA_FL,
	VIA_OSEA_FL,
	CAMPO_LIBRE_FL,
	TEST_TYPE_SK,
	TEST_TYPE_DS 
) 
select /*+  */
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	VIA_AEREA_FL,
	VIA_OSEA_FL,
	CAMPO_LIBRE_FL,
	TEST_TYPE_SK,
	TEST_TYPE_DS   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	439283 X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'MAP_ES_FT_TEST_ACTIVITY' || ' (' || 'CTX_ES' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_1.COMPANY_CD X_AUD_COMPANY_CD,
	INLINE_VIEW_1.COMPANY_CD COMPANY_CD,
	INLINE_VIEW_1.DIVISION_CD DIVISION_CD,
	INLINE_VIEW_1.SHOP_CD SHOP_CD,
	INLINE_VIEW_1.LAPTOP_CD LAPTOP_CD,
	INLINE_VIEW_1.ACTIVITY_ID ACTIVITY_ID,
	INLINE_VIEW_1.ACTIVITY_DATE_DT ACTIVITY_DATE_DT,
	INLINE_VIEW_1.CUSTOMER_CD CUSTOMER_CD,
	STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD ) COMPANY_HK,
	INLINE_VIEW_1.COL CUSTOMER_HK,
	CAST(STANDARD_HASH(NVL(INLINE_VIEW_1.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) ) CLC_STATUS_HK,
	INLINE_VIEW_1.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_1.COL_1 SHOP_HK,
	CASE WHEN INLINE_VIEW_1.DAYCENTER_CD IS NOT NULL
     THEN STANDARD_HASH ( INLINE_VIEW_1.COMPANY_CD   || INLINE_VIEW_1.DIVISION_CD ||
                          INLINE_VIEW_1.DAYCENTER_CD || INLINE_VIEW_1.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_1.LOCATION_TYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD || INLINE_VIEW_1.LOCATION_TYPE_CD )
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_1.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD  || INLINE_VIEW_1.DIVISION_CD ||
                      INLINE_VIEW_1.EMPLOYEE_CD || INLINE_VIEW_1.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_1.PROMOTER_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD  || INLINE_VIEW_1.DIVISION_CD || 
                      INLINE_VIEW_1.PROMOTER_CD || INLINE_VIEW_1.SHOP_CD )
  ELSE STANDARD_HASH('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_1.CAMPAIGN_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD || INLINE_VIEW_1.CAMPAIGN_CD )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_1.MEDIATYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD || INLINE_VIEW_1.DIVISION_CD || INLINE_VIEW_1.MEDIATYPE_CD )
  ELSE STANDARD_HASH('-1')
END MEDIA_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_1.COMPANY_CD  || '@' ||
               INLINE_VIEW_1.DIVISION_CD || '@' ||
               COALESCE( INLINE_VIEW_1.TEST_RESULT_LEFT_CD,  '-1') || '@' ||
               COALESCE( INLINE_VIEW_1.TEST_RESULT_RIGHT_CD, '-1') ) TEST_RESULT_HK,
	TO_NUMBER(TO_CHAR(INLINE_VIEW_1.ACTIVITY_DATE_DT, 'YYYYMMDD')) ACTIVITY_TEST_DATE_SK,
	INLINE_VIEW_1.ACTIVITY_DATE_DT D_ACTIVITY_TEST_DATE_DT,
	FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 D_CLC_REFERENCE_DATE_DT,
	CASE WHEN INLINE_VIEW_1.TEST_RESULT_RIGHT_CD IS NOT NULL 
       OR INLINE_VIEW_1.TEST_RESULT_LEFT_CD  IS NOT NULL
     THEN 1
     ELSE 0
END M1_VALID_TEST_QT,
	INLINE_VIEW_1.MASTER_COMPANY_CD || INLINE_VIEW_1.MASTER_DIVISION_CD ||
INLINE_VIEW_1.MASTER_CUSTOMER_CD M_CLIENT_ID,
	INLINE_VIEW_1.MASTER_COMPANY_CD  ||
INLINE_VIEW_1.MASTER_DIVISION_CD ||
INLINE_VIEW_1.SHOP_CD            ||
INLINE_VIEW_1.MASTER_CUSTOMER_CD ||
TO_CHAR(INLINE_VIEW_1.ACTIVITY_DATE_DT, 'YYYYMM') M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_1.HEARING_LOSS_FL M_HEARING_LOSS_FL,
	CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD='A'
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= DM_SHOP.D_START_DATE_DT 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, -12)
     THEN 1
     WHEN DM_SHOP.D_SHOP_ORIGIN_CD='N' 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= ADD_MONTHS(DM_SHOP.D_END_DATE_DT, - 12)
     THEN 1 
     ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD = 'A' 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= DM_SHOP.D_END_DATE_DT 
     THEN 1
     WHEN DM_SHOP.D_SHOP_ORIGIN_CD = 'N' 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT >= ADD_MONTHS(DM_SHOP.D_START_DATE_DT, 24) 
      AND INLINE_VIEW_1.ACTIVITY_DATE_DT <= DM_SHOP.D_END_DATE_DT 
     THEN 1 
     ELSE CASE WHEN DM_SHOP.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_CY_FL,
	FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	FT_CUSTOMER_BASE.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	FT_CUSTOMER_BASE.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	FT_CUSTOMER_BASE.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - TRUNC(FT_CUSTOMER_BASE.TST_LAST_TEST_DT)
     ELSE 3651
END TEST_AGEING_SK,
	CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1   - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1   - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1   - TRUNC(FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT)
     ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_1.VIA_AEREA_FL VIA_AEREA_FL,
	INLINE_VIEW_1.VIA_OSEA_FL VIA_OSEA_FL,
	INLINE_VIEW_1.CAMPO_LIBRE_FL CAMPO_LIBRE_FL,
	INLINE_VIEW_1.TEST_TYPE_SK TEST_TYPE_SK,
	INLINE_VIEW_1.TEST_TYPE_DS TEST_TYPE_DS 
from	DMM_BDL_ANL.FT_CUSTOMER_BASE PARTITION(P_ES) FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.VIA_OSEA_FL AS VIA_OSEA_FL ,
  INLINE_VIEW.VIA_AEREA_FL AS VIA_AEREA_FL ,
  INLINE_VIEW.CAMPO_LIBRE_FL AS CAMPO_LIBRE_FL ,
  INLINE_VIEW.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW.TEST_TYPE_DS AS TEST_TYPE_DS ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COL_1 AS COL_1 ,
  INLINE_VIEW.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW.COL_2 AS COL_2   
FROM 
  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT AS STATUS_TO_DT ,
  FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.VIA_OSEA_FL AS VIA_OSEA_FL ,
  FTB_TEST_ACTIVITY_BASE_1.VIA_AEREA_FL AS VIA_AEREA_FL ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPO_LIBRE_FL AS CAMPO_LIBRE_FL ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_DS AS TEST_TYPE_DS ,
  FTB_TEST_ACTIVITY_BASE_1.COL AS COL ,
  FTB_TEST_ACTIVITY_BASE_1.COL_1 AS COL_1 ,
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.CUSTOMER_HK AS CUSTOMER_HK_1 ,
  ROW_NUMBER() OVER 
(PARTITION BY FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD,  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD
            , FTB_TEST_ACTIVITY_BASE_1.SHOP_CD,     FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD
            , FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID, FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT
            , FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD
     ORDER BY DM_CUSTOMER_HST.X_AUD_FROM_TS ) AS COL_2   
FROM 
  ((
SELECT 
  FTB_TEST_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.VIA_OSEA_FL AS VIA_OSEA_FL ,
  FTB_TEST_ACTIVITY_BASE.VIA_AEREA_FL AS VIA_AEREA_FL ,
  FTB_TEST_ACTIVITY_BASE.CAMPO_LIBRE_FL AS CAMPO_LIBRE_FL ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_DS AS TEST_TYPE_DS ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD IS NOT NULL 
     THEN CASE WHEN FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD is null 
               THEN STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.COMPANY_CD        || FTB_TEST_ACTIVITY_BASE.DIVISION_CD        || FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD        )
               ELSE STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD )
          END
     ELSE STANDARD_HASH ('-1') 
END AS COL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.SHOP_CD IS NOT NULL
     THEN STANDARD_HASH ( FTB_TEST_ACTIVITY_BASE.COMPANY_CD || FTB_TEST_ACTIVITY_BASE.DIVISION_CD || FTB_TEST_ACTIVITY_BASE.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END AS COL_1   
FROM 
  BDFL.FTB_TEST_ACTIVITY_BASE PARTITION(P_ES) FTB_TEST_ACTIVITY_BASE  
  ) FTB_TEST_ACTIVITY_BASE_1  LEFT OUTER JOIN  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  (
SELECT 
  DISTINCT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD)) AS CUSTOMER_CD ,
  STANDARD_HASH((COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD))) AS CUSTOMER_HK ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_TO_DT AS STATUS_TO_DT ,
  CASE WHEN CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID = 6 
     THEN COALESCE(CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_HEADER_DT, CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_ITEM_H_DT)
     ELSE NULL
END AS D_CLC_LAST_SALE_HOT_COLD_DT   
FROM 
  (
SELECT 
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD AS COMPANY_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD AS DIVISION_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_HEADER_DT AS LAST_HA_HEADER_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_ITEM_H_DT AS LAST_HA_ITEM_H_DT   
FROM 
  EDW.CL_LIGHT_CUSTOMER_STATUS PARTITION(P_ES) CL_LIGHT_CUSTOMER_STATUS_RMAP_  
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) 
  ) CL_LIGHT_CUSTOMER_STATUS_RMA_1  LEFT OUTER JOIN  (
SELECT 
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL AS X_AUD_CURRENT_FL ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE AS COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE AS MASTER_COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AS MASTER_DIVISION_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE   
FROM 
  EDW.UM_CU_S_CUSTOMER_MAPPING PARTITION(P_ES_PT) UM_CU_S_CUSTOMER_MAPPING_RMAP_  
WHERE
  (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) UM_CU_S_CUSTOMER_MAPPING_RMA_1  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE
  ) DISTINCT__RMAP_ES_CUSTOMER_STA  
  ) DISTINCT__RMAP_ES_CUSTOMER_S_1  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL = DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1 >= DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1  < NVL(TRUNC(DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT), TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  LEFT OUTER JOIN  DMM_BDL_ANL.DM_CUSTOMER_HST PARTITION(P_ES) DM_CUSTOMER_HST  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL                               = DM_CUSTOMER_HST.CUSTOMER_HK          AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) >= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) AND 
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) <= TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_2=1
) 
  ) INLINE_VIEW_1  LEFT OUTER JOIN  DMM_BDL_ANL.DM_SHOP PARTITION(P_ES) DM_SHOP  
    ON  DM_SHOP.SHOP_HK = INLINE_VIEW_1.COL_1
     )  
    ON  INLINE_VIEW_1.COMPANY_CD  = FT_CUSTOMER_BASE.COMPANY_CD   and
INLINE_VIEW_1.DIVISION_CD = FT_CUSTOMER_BASE.DIVISION_CD  and 
INLINE_VIEW_1.CUSTOMER_CD = FT_CUSTOMER_BASE.CUSTOMER_CD  AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1 >= FT_CUSTOMER_BASE.VALID_FROM_DT AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1  < FT_CUSTOMER_BASE.VALID_TO_DT
where		(1=1)	
)  ODI_GET_FROM
   , Error Msg = ORA-00904: "FTB_TEST_ACTIVITY_BASE"."CAMPO_LIBRE_FL": invalid identifier

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:514)
	... 36 more
]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6758595a-0653-4e1f-881b-ca0eef20cacc]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[446866]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-03-16 07:32:32.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-03-16 07:32:33.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[ODI-1298]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[E]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6418975d-0942-4ff9-9511-f1fbaa5929e7]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[7031384]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[7031384]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[445899]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-03-11 12:53:41.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[964]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-03-11 13:09:45.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b7f145f7-38ec-4d11-9767-41c0fefaf9a3]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[7121359]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[7121359]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[452268]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-04-21 16:22:17.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[687]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-04-21 16:33:44.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[adce529c-80b9-433d-983e-873170bc553b]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[7117480]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[7117480]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[449881]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-04-04 15:49:16.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[759]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-04-04 16:01:55.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String"><![CDATA[ODI-1217: Session PKG_BDL_ES_2_FT_TEST_ACTIVITY (457883) fails with return code ODI-1298.
ODI-1226: Step Copy of TEMP\_STEP3_20220516_MAP_ES_FT_TEST_ACTIVITY fails after 1 attempt(s).
ODI-1240: Flow Copy of TEMP\_STEP3_20220516_MAP_ES_FT_TEST_ACTIVITY fails while performing a Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- operation. This flow loads target table FT_TEST_ACTIVITY.
ODI-1298: Serial task "SERIAL-MAP_MAIN- (40)" failed because child task "SERIAL-EU-LOG_BDFL_DMM (70)" is in error.
ODI-1298: Serial task "SERIAL-EU-LOG_BDFL_DMM (70)" failed because child task "Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- (120)" is in error.
ODI-1228: Task Insert new rows-IKM Oracle Control Append for BDFL (multi-partition)- fails on the target connection PHY_BDFL_DMM_ES.
Caused By: java.sql.SQLException: ORA-14501: object is not partitioned

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:510)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:462)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1105)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:551)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:269)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:656)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:230)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:42)
	at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:929)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1280)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1921)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1876)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:304)
	at oracle.odi.runtime.agent.execution.sql.SQLCommand.execute(SQLCommand.java:208)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:142)
	at oracle.odi.runtime.agent.execution.sql.SQLExecutor.execute(SQLExecutor.java:28)
	at oracle.odi.runtime.agent.execution.TaskExecutionHandler.handleTask(TaskExecutionHandler.java:52)
	at oracle.odi.runtime.agent.execution.SessionTask.processTask(SessionTask.java:216)
	at oracle.odi.runtime.agent.execution.SessionTask.doExecuteTask(SessionTask.java:128)
	at oracle.odi.runtime.agent.execution.AbstractSessionTask.execute(AbstractSessionTask.java:886)
	at oracle.odi.runtime.agent.execution.SessionExecutor$SerialTrain.runTasks(SessionExecutor.java:2225)
	at oracle.odi.runtime.agent.execution.SessionExecutor.executeSession(SessionExecutor.java:610)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:718)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor$1.doAction(TaskExecutorAgentRequestProcessor.java:611)
	at oracle.odi.core.persistence.dwgobject.DwgObjectTemplate.execute(DwgObjectTemplate.java:203)
	at oracle.odi.runtime.agent.processor.TaskExecutorAgentRequestProcessor.doProcessStartAgentTask(TaskExecutorAgentRequestProcessor.java:800)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor.access$2700(StartScenRequestProcessor.java:85)
	at oracle.odi.runtime.agent.processor.impl.StartScenRequestProcessor$StartScenTask.doExecute(StartScenRequestProcessor.java:917)
	at oracle.odi.runtime.agent.processor.task.AgentTask.execute(AgentTask.java:180)
	at oracle.odi.runtime.agent.support.DefaultAgentTaskExecutor$2.run(DefaultAgentTaskExecutor.java:108)
	at java.lang.Thread.run(Thread.java:748)
Caused by: Error : 14501, Position : 0, Sql = 
insert /*+ APPEND ENABLE_PARALLEL_DML PARALLEL(4) */ into	DMM_BDL_ANL.FT_TEST_ACTIVITY
 PARTITION(P_ES)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	TEST_TYPE_SK,
	MEDICAL_MEDIATYPE_HK,
	OPPTY_TEST_FLAG,
	TONAL_FL,
	FIRST_TEST_OF_THE_MONTH_FL 
) 
select /*+  */
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	TEST_TYPE_SK,
	MEDICAL_MEDIATYPE_HK,
	OPPTY_TEST_FLAG,
	TONAL_FL,
	FIRST_TEST_OF_THE_MONTH_FL   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	457341 X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'Copy of TEMP\_STEP3_20220516_MAP_ES_FT_TEST_ACTIVITY' || ' (' || 'CTX_ES' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_4.COMPANY_CD_3 X_AUD_COMPANY_CD,
	INLINE_VIEW_4.COMPANY_CD_3 COMPANY_CD,
	INLINE_VIEW_4.DIVISION_CD_3 DIVISION_CD,
	INLINE_VIEW_4.SHOP_CD SHOP_CD,
	INLINE_VIEW_4.LAPTOP_CD LAPTOP_CD,
	INLINE_VIEW_4.ACTIVITY_ID ACTIVITY_ID,
	INLINE_VIEW_4.ACTIVITY_DATE_DT ACTIVITY_DATE_DT,
	INLINE_VIEW_4.CUSTOMER_CD_2 CUSTOMER_CD,
	STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 ) COMPANY_HK,
	INLINE_VIEW_4.COL CUSTOMER_HK,
	CAST(STANDARD_HASH(NVL(INLINE_VIEW_4.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) ) CLC_STATUS_HK,
	INLINE_VIEW_4.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_4.COL_1 SHOP_HK,
	CASE WHEN INLINE_VIEW_4.DAYCENTER_CD IS NOT NULL
     THEN STANDARD_HASH ( INLINE_VIEW_4.COMPANY_CD_3   || INLINE_VIEW_4.DIVISION_CD_3 ||
                          INLINE_VIEW_4.DAYCENTER_CD || INLINE_VIEW_4.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_4.LOCATION_TYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || INLINE_VIEW_4.LOCATION_TYPE_CD )
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_4.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3  || INLINE_VIEW_4.DIVISION_CD_3 ||
                      INLINE_VIEW_4.EMPLOYEE_CD || INLINE_VIEW_4.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_4.PROMOTER_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3  || INLINE_VIEW_4.DIVISION_CD_3 || 
                      INLINE_VIEW_4.PROMOTER_CD || INLINE_VIEW_4.SHOP_CD )
  ELSE STANDARD_HASH('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_4.CAMPAIGN_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || INLINE_VIEW_4.CAMPAIGN_CD )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_4.MEDIATYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || INLINE_VIEW_4.MEDIATYPE_CD )
  ELSE STANDARD_HASH('-1')
END MEDIA_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3  || '@' ||
               INLINE_VIEW_4.DIVISION_CD_3 || '@' ||
               COALESCE( INLINE_VIEW_4.TEST_RESULT_LEFT_CD,  '-1') || '@' ||
               COALESCE( INLINE_VIEW_4.TEST_RESULT_RIGHT_CD, '-1') ) TEST_RESULT_HK,
	TO_NUMBER(TO_CHAR(INLINE_VIEW_4.ACTIVITY_DATE_DT, 'YYYYMMDD')) ACTIVITY_TEST_DATE_SK,
	INLINE_VIEW_4.ACTIVITY_DATE_DT D_ACTIVITY_TEST_DATE_DT,
	INLINE_VIEW_4.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 D_CLC_REFERENCE_DATE_DT,
	CASE WHEN INLINE_VIEW_4.TEST_RESULT_RIGHT_CD IS NOT NULL 
       OR INLINE_VIEW_4.TEST_RESULT_LEFT_CD  IS NOT NULL
     THEN 1
     ELSE 0
END M1_VALID_TEST_QT,
	INLINE_VIEW_4.MASTER_COMPANY_CD || INLINE_VIEW_4.MASTER_DIVISION_CD ||
INLINE_VIEW_4.MASTER_CUSTOMER_CD M_CLIENT_ID,
	INLINE_VIEW_4.MASTER_COMPANY_CD  ||
INLINE_VIEW_4.MASTER_DIVISION_CD ||
INLINE_VIEW_4.SHOP_CD            ||
INLINE_VIEW_4.MASTER_CUSTOMER_CD ||
TO_CHAR(INLINE_VIEW_4.ACTIVITY_DATE_DT, 'YYYYMM') M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_4.HEARING_LOSS_FL M_HEARING_LOSS_FL,
	CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD='A'
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= INLINE_VIEW_4.D_START_DATE_DT 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= ADD_MONTHS(INLINE_VIEW_4.D_END_DATE_DT, -12)
     THEN 1
     WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD='N' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= ADD_MONTHS(INLINE_VIEW_4.D_END_DATE_DT, - 12)
     THEN 1 
     ELSE CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD = 'A' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= INLINE_VIEW_4.D_END_DATE_DT 
     THEN 1
     WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD = 'N' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 24) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= INLINE_VIEW_4.D_END_DATE_DT 
     THEN 1 
     ELSE CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_CY_FL,
	INLINE_VIEW_4.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	INLINE_VIEW_4.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	INLINE_VIEW_4.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	INLINE_VIEW_4.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	INLINE_VIEW_4.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	INLINE_VIEW_4.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	INLINE_VIEW_4.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	INLINE_VIEW_4.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	INLINE_VIEW_4.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	INLINE_VIEW_4.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT)
     ELSE 3651
END TEST_AGEING_SK,
	CASE WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT)
     ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_4.TEST_TYPE_SK TEST_TYPE_SK,
	CASE
  WHEN (coalesce(INLINE_VIEW_4.COL_4,INLINE_VIEW_4.MEDIATYPE_CD_1,'03')) IS NOT NULL
  THEN STANDARD_HASH(INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || (coalesce(INLINE_VIEW_4.COL_4,INLINE_VIEW_4.MEDIATYPE_CD_1,'03'))  )
  ELSE STANDARD_HASH ('-1')
END MEDICAL_MEDIATYPE_HK,
	CASE WHEN (INLINE_VIEW_4.AGING_CLUSTER_CD = 2 AND INLINE_VIEW_4.D202_CUSTOMER_TYPE_GROUP_DS = 'CUSTOMER')
       OR (INLINE_VIEW_4.HEARING_LOSS_FL = 1 AND INLINE_VIEW_4.D202_CUSTOMER_TYPE_GROUP_DS IN ('LEAD', 'PROSPECT'))
THEN 1
ELSE 0
END OPPTY_TEST_FLAG,
	INLINE_VIEW_4.TONAL_FL TONAL_FL,
	CASE WHEN INLINE_VIEW_4.COL_6 = 1 THEN 1
      else  0 end FIRST_TEST_OF_THE_MONTH_FL 
from	(
SELECT 
  INLINE_VIEW_3.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_3.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_3.AGE_CD AS AGE_CD ,
  INLINE_VIEW_3.AGING_CLUSTER_CD AS AGING_CLUSTER_CD ,
  INLINE_VIEW_3.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_3.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_3.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_3.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_3.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_3.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_3.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_3.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_3.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_3.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_3.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_3.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_3.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_3.COMPANY_CD_2 AS COMPANY_CD_2 ,
  INLINE_VIEW_3.DIVISION_CD_2 AS DIVISION_CD_2 ,
  INLINE_VIEW_3.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_3.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_3.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_3.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_3.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_3.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_3.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_3.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_3.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_3.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_3.COMPANY_CD_3 AS COMPANY_CD_3 ,
  INLINE_VIEW_3.DIVISION_CD_3 AS DIVISION_CD_3 ,
  INLINE_VIEW_3.CUSTOMER_CD_2 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_3.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_3.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_3.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_3.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_3.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_3.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_3.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_3.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_3.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_3.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_3.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_3.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_3.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_3.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_3.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_3.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_3.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_3.COL AS COL ,
  INLINE_VIEW_3.COL_1 AS COL_1 ,
  INLINE_VIEW_3.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_3.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_3.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_3.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_3.COL_2 AS COL_2 ,
  INLINE_VIEW_3.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_3.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_3.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_3.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_3.COL_3 AS COL_3 ,
  INLINE_VIEW_3.COL_4 AS COL_4 ,
  INLINE_VIEW_3.COL_5 AS COL_5 ,
  INLINE_VIEW_3.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_3.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS ,
  INLINE_VIEW_3.COL_6 AS COL_6 ,
  FTB_ACTIVITY_BASE1.COMPANY_CD AS COMPANY_CD_4 ,
  FTB_ACTIVITY_BASE1.DIVISION_CD AS DIVISION_CD_4 ,
  FTB_ACTIVITY_BASE1.ACTIVITY_ID AS ACTIVITY_ID_1 ,
  FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT_1 ,
  FTB_ACTIVITY_BASE1.CUSTOMER_CD AS CUSTOMER_CD_3 ,
  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE1.MEDIATYPE_CD AS MEDIATYPE_CD_1 ,
  CASE WHEN  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD = 'SA' AND FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT = INLINE_VIEW_3.ACTIVITY_DATE_DT
      THEN 1 ELSE 0 END AS COL_7 ,
  ROW_NUMBER() OVER 
(PARTITION BY 
            INLINE_VIEW_3.COMPANY_CD_3,  INLINE_VIEW_3.DIVISION_CD_3
            , INLINE_VIEW_3.SHOP_CD,     INLINE_VIEW_3.LAPTOP_CD
            , INLINE_VIEW_3.ACTIVITY_ID, INLINE_VIEW_3.ACTIVITY_DATE_DT
            , INLINE_VIEW_3.CUSTOMER_CD_2
             ORDER BY (CASE WHEN  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD = 'SA' AND FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT = INLINE_VIEW_3.ACTIVITY_DATE_DT
      THEN 1 ELSE 0 END) DESC ,ABS(INLINE_VIEW_3.ACTIVITY_DATE_DT - FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT) ASC, FTB_ACTIVITY_BASE1.ACTIVITY_ID ASC ) AS COL_8   
FROM 
  (
SELECT 
  CF_LAST_SALE_AGING_RANGE_1.COMPANY_CD AS COMPANY_CD ,
  CF_LAST_SALE_AGING_RANGE_1.DIVISION_CD AS DIVISION_CD ,
  CF_LAST_SALE_AGING_RANGE_1.AGE_CD AS AGE_CD ,
  CF_LAST_SALE_AGING_RANGE_1.AGING_CLUSTER_CD AS AGING_CLUSTER_CD ,
  INLINE_VIEW_2.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_2.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_2.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_2.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_2.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_2.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_2.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_2.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_2.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_2.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_2.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_2.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_2.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_2.COMPANY_CD_1 AS COMPANY_CD_2 ,
  INLINE_VIEW_2.DIVISION_CD_1 AS DIVISION_CD_2 ,
  INLINE_VIEW_2.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_2.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_2.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_2.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_2.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_2.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_2.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_2.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_2.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_2.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_2.COMPANY_CD_2 AS COMPANY_CD_3 ,
  INLINE_VIEW_2.DIVISION_CD_2 AS DIVISION_CD_3 ,
  INLINE_VIEW_2.CUSTOMER_CD_2 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_2.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_2.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_2.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_2.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_2.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_2.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_2.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_2.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_2.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_2.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_2.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_2.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_2.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_2.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_2.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_2.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_2.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_2.COL AS COL ,
  INLINE_VIEW_2.COL_1 AS COL_1 ,
  INLINE_VIEW_2.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_2.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_2.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_2.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_2.COL_2 AS COL_2 ,
  INLINE_VIEW_2.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_2.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_2.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_2.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_2.COL_3 AS COL_3 ,
  INLINE_VIEW_2.COL_4 AS COL_4 ,
  INLINE_VIEW_2.COL_5 AS COL_5 ,
  INLINE_VIEW_2.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_2.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS ,
  ROW_NUMBER() OVER 
(PARTITION BY INLINE_VIEW_2.COMPANY_CD_2
              , INLINE_VIEW_2.DIVISION_CD_2
              , INLINE_VIEW_2.CUSTOMER_CD_2
              , EXTRACT( YEAR FROM INLINE_VIEW_2.ACTIVITY_DATE_DT) 
              , EXTRACT( MONTH FROM INLINE_VIEW_2.ACTIVITY_DATE_DT)
     ORDER BY INLINE_VIEW_2.ACTIVITY_DATE_DT ASC ) AS COL_6   
FROM 
  (
SELECT 
  FTB_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  FT_CUSTOMER_BASE.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  FT_CUSTOMER_BASE.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  FT_CUSTOMER_BASE.COMPANY_CD AS COMPANY_CD_1 ,
  FT_CUSTOMER_BASE.DIVISION_CD AS DIVISION_CD_1 ,
  FT_CUSTOMER_BASE.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  FT_CUSTOMER_BASE.VALID_FROM_DT AS VALID_FROM_DT ,
  FT_CUSTOMER_BASE.VALID_TO_DT AS VALID_TO_DT ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_1.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_1.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_1.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_1.COMPANY_CD AS COMPANY_CD_2 ,
  INLINE_VIEW_1.DIVISION_CD AS DIVISION_CD_2 ,
  INLINE_VIEW_1.CUSTOMER_CD AS CUSTOMER_CD_2 ,
  INLINE_VIEW_1.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_1.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_1.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_1.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_1.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_1.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_1.COL AS COL ,
  INLINE_VIEW_1.COL_1 AS COL_1 ,
  INLINE_VIEW_1.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_1.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_1.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_1.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_1.COL_2 AS COL_2 ,
  DM_SHOP.SHOP_HK AS SHOP_HK ,
  DM_SHOP.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  DM_SHOP.D_START_DATE_DT AS D_START_DATE_DT ,
  DM_SHOP.D_END_DATE_DT AS D_END_DATE_DT ,
  CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END AS COL_3 ,
  CASE WHEN  (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_1.MEDIATYPE_CD NOT IN  ('05', '06') THEN 'F_VM'
  WHEN (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_1.MEDIATYPE_CD  IN  ('05', '06') THEN INLINE_VIEW_1.MEDIATYPE_CD
  WHEN (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'O' AND INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN INLINE_VIEW_1.MEDIATYPE_CD
  ELSE INLINE_VIEW_1.MEDIATYPE_CD END AS COL_4 ,
  CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT > 3650
      THEN INLINE_VIEW_1.COMPANY_CD || '@' || '3651'
      ELSE INLINE_VIEW_1.COMPANY_CD || '@' || TO_CHAR(TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT)
END AS COL_5 ,
  DM_CLC_STATUS.CLC_STATUS_HK AS CLC_STATUS_HK ,
  DM_CLC_STATUS.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS   
FROM 
  ((
SELECT 
  FTB_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD   
FROM 
  BDFL.FTB_ACTIVITY_BASE PARTITION(P_ES) FTB_ACTIVITY_BASE  
WHERE
  ((FTB_ACTIVITY_BASE.DIVISION_CD = '001' AND FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD = 'VM') 
OR (FTB_ACTIVITY_BASE.DIVISION_CD = '002' AND FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD = 'VM' AND  TRUNC(FTB_ACTIVITY_BASE.ACTIVITY_DATE_DT) >= to_date('2019-01-01','yyyy-mm-dd'))
) 
GROUP BY
  FTB_ACTIVITY_BASE.COMPANY_CD,FTB_ACTIVITY_BASE.DIVISION_CD,FTB_ACTIVITY_BASE.CUSTOMER_CD 
  ) FTB_ACTIVITY_BASE_1  RIGHT OUTER JOIN  (DMM_BDL_ANL.FT_CUSTOMER_BASE PARTITION(P_ES) FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COL_1 AS COL_1 ,
  INLINE_VIEW.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW.COL_2 AS COL_2   
FROM 
  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT AS STATUS_TO_DT ,
  FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE_1.TONAL_FL AS TONAL_FL ,
  FTB_TEST_ACTIVITY_BASE_1.COL AS COL ,
  FTB_TEST_ACTIVITY_BASE_1.COL_1 AS COL_1 ,
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.CUSTOMER_HK AS CUSTOMER_HK_1 ,
  ROW_NUMBER() OVER 
(PARTITION BY FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD,  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD
            , FTB_TEST_ACTIVITY_BASE_1.SHOP_CD,     FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD
            , FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID, FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT
            , FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD
     ORDER BY DM_CUSTOMER_HST.X_AUD_FROM_TS ) AS COL_2   
FROM 
  ((
SELECT 
  FTB_TEST_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE.TONAL_FL AS TONAL_FL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD IS NOT NULL 
     THEN CASE WHEN FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD is null 
               THEN STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.COMPANY_CD        || FTB_TEST_ACTIVITY_BASE.DIVISION_CD        || FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD        )
               ELSE STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD )
          END
     ELSE STANDARD_HASH ('-1') 
END AS COL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.SHOP_CD IS NOT NULL
     THEN STANDARD_HASH ( FTB_TEST_ACTIVITY_BASE.COMPANY_CD || FTB_TEST_ACTIVITY_BASE.DIVISION_CD || FTB_TEST_ACTIVITY_BASE.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END AS COL_1   
FROM 
  BDFL.FTB_TEST_ACTIVITY_BASE PARTITION(P_ES) FTB_TEST_ACTIVITY_BASE  
  ) FTB_TEST_ACTIVITY_BASE_1  LEFT OUTER JOIN  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  (
SELECT 
  DISTINCT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD)) AS CUSTOMER_CD ,
  STANDARD_HASH((COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD))) AS CUSTOMER_HK ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_TO_DT AS STATUS_TO_DT ,
  CASE WHEN CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID = 6 
     THEN COALESCE(CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_HEADER_DT, CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_ITEM_H_DT)
     ELSE NULL
END AS D_CLC_LAST_SALE_HOT_COLD_DT   
FROM 
  (
SELECT 
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD AS COMPANY_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD AS DIVISION_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_HEADER_DT AS LAST_HA_HEADER_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_ITEM_H_DT AS LAST_HA_ITEM_H_DT   
FROM 
  EDW.CL_LIGHT_CUSTOMER_STATUS PARTITION(P_ES) CL_LIGHT_CUSTOMER_STATUS_RMAP_  
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) 
  ) CL_LIGHT_CUSTOMER_STATUS_RMA_1  LEFT OUTER JOIN  (
SELECT 
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL AS X_AUD_CURRENT_FL ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE AS COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE AS MASTER_COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AS MASTER_DIVISION_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE   
FROM 
  EDW.UM_CU_S_CUSTOMER_MAPPING PARTITION(P_ES_PT) UM_CU_S_CUSTOMER_MAPPING_RMAP_  
WHERE
  (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) UM_CU_S_CUSTOMER_MAPPING_RMA_1  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE
  ) DISTINCT__RMAP_ES_CUSTOMER_STA  
  ) DISTINCT__RMAP_ES_CUSTOMER_S_1  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL = DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1 >= DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1  < NVL(TRUNC(DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT), TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  LEFT OUTER JOIN  DMM_BDL_ANL.DM_CUSTOMER_HST PARTITION(P_ES) DM_CUSTOMER_HST  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL                               = DM_CUSTOMER_HST.CUSTOMER_HK          AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) >= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) AND 
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) <= TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_2=1
) 
  ) INLINE_VIEW_1  LEFT OUTER JOIN  DMM_BDL_ANL.DM_SHOP PARTITION(P_ES) DM_SHOP  
    ON  DM_SHOP.SHOP_HK = INLINE_VIEW_1.COL_1
     )  
    ON  INLINE_VIEW_1.COMPANY_CD  = FT_CUSTOMER_BASE.COMPANY_CD   and
INLINE_VIEW_1.DIVISION_CD = FT_CUSTOMER_BASE.DIVISION_CD  and 
INLINE_VIEW_1.CUSTOMER_CD = FT_CUSTOMER_BASE.CUSTOMER_CD  AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1 >= FT_CUSTOMER_BASE.VALID_FROM_DT AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1  < FT_CUSTOMER_BASE.VALID_TO_DT
     )  
    ON  FTB_ACTIVITY_BASE_1.COMPANY_CD =  INLINE_VIEW_1.COMPANY_CD  
AND FTB_ACTIVITY_BASE_1.DIVISION_CD = INLINE_VIEW_1.DIVISION_CD 
AND FTB_ACTIVITY_BASE_1.CUSTOMER_CD = INLINE_VIEW_1.CUSTOMER_CD
     )  LEFT OUTER JOIN  DMM_BDL_ANL.DM_CLC_STATUS DM_CLC_STATUS  
    ON  DM_CLC_STATUS.CLC_STATUS_HK = CAST(STANDARD_HASH(NVL(INLINE_VIEW_1.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) )
  ) INLINE_VIEW_2  LEFT OUTER JOIN  (
SELECT 
  CF_LAST_SALE_AGING_RANGE.COMPANY_CD AS COMPANY_CD ,
  CF_LAST_SALE_AGING_RANGE.DIVISION_CD AS DIVISION_CD ,
  CF_LAST_SALE_AGING_RANGE.AGE_CD AS AGE_CD ,
  CF_LAST_SALE_AGING_RANGE.AGING_CLUSTER_CD AS AGING_CLUSTER_CD   
FROM 
  DMM_BDL_ANL.CF_LAST_SALE_AGING_RANGE PARTITION(P_ES_PT) CF_LAST_SALE_AGING_RANGE  
WHERE
  (CF_LAST_SALE_AGING_RANGE.COMPANY_CD = '002'
) 
  ) CF_LAST_SALE_AGING_RANGE_1  
    ON  CF_LAST_SALE_AGING_RANGE_1.COMPANY_CD || '@' || CF_LAST_SALE_AGING_RANGE_1.AGE_CD = INLINE_VIEW_2.COL_5
AND INLINE_VIEW_2.DIVISION_CD_2 = CF_LAST_SALE_AGING_RANGE_1.DIVISION_CD
  ) INLINE_VIEW_3  INNER JOIN  BDFL.FTB_ACTIVITY_BASE FTB_ACTIVITY_BASE1  
    ON  FTB_ACTIVITY_BASE1.COMPANY_CD =  INLINE_VIEW_3.COMPANY_CD_3  
AND FTB_ACTIVITY_BASE1.DIVISION_CD = INLINE_VIEW_3.DIVISION_CD_3 
AND FTB_ACTIVITY_BASE1.CUSTOMER_CD = INLINE_VIEW_3.CUSTOMER_CD_2
  ) INLINE_VIEW_4
where		(1=1)	
 and (INLINE_VIEW_4.COL_8 = 1)
)  ODI_GET_FROM
   , OriginalSql =  
insert /*+ APPEND ENABLE_PARALLEL_DML PARALLEL(4) */ into	DMM_BDL_ANL.FT_TEST_ACTIVITY
 PARTITION(P_ES)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	TEST_TYPE_SK,
	MEDICAL_MEDIATYPE_HK,
	OPPTY_TEST_FLAG,
	TONAL_FL,
	FIRST_TEST_OF_THE_MONTH_FL 
) 
select /*+  */
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	TEST_TYPE_SK,
	MEDICAL_MEDIATYPE_HK,
	OPPTY_TEST_FLAG,
	TONAL_FL,
	FIRST_TEST_OF_THE_MONTH_FL   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	457341 X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'Copy of TEMP\_STEP3_20220516_MAP_ES_FT_TEST_ACTIVITY' || ' (' || 'CTX_ES' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_4.COMPANY_CD_3 X_AUD_COMPANY_CD,
	INLINE_VIEW_4.COMPANY_CD_3 COMPANY_CD,
	INLINE_VIEW_4.DIVISION_CD_3 DIVISION_CD,
	INLINE_VIEW_4.SHOP_CD SHOP_CD,
	INLINE_VIEW_4.LAPTOP_CD LAPTOP_CD,
	INLINE_VIEW_4.ACTIVITY_ID ACTIVITY_ID,
	INLINE_VIEW_4.ACTIVITY_DATE_DT ACTIVITY_DATE_DT,
	INLINE_VIEW_4.CUSTOMER_CD_2 CUSTOMER_CD,
	STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 ) COMPANY_HK,
	INLINE_VIEW_4.COL CUSTOMER_HK,
	CAST(STANDARD_HASH(NVL(INLINE_VIEW_4.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) ) CLC_STATUS_HK,
	INLINE_VIEW_4.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_4.COL_1 SHOP_HK,
	CASE WHEN INLINE_VIEW_4.DAYCENTER_CD IS NOT NULL
     THEN STANDARD_HASH ( INLINE_VIEW_4.COMPANY_CD_3   || INLINE_VIEW_4.DIVISION_CD_3 ||
                          INLINE_VIEW_4.DAYCENTER_CD || INLINE_VIEW_4.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_4.LOCATION_TYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || INLINE_VIEW_4.LOCATION_TYPE_CD )
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_4.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3  || INLINE_VIEW_4.DIVISION_CD_3 ||
                      INLINE_VIEW_4.EMPLOYEE_CD || INLINE_VIEW_4.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_4.PROMOTER_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3  || INLINE_VIEW_4.DIVISION_CD_3 || 
                      INLINE_VIEW_4.PROMOTER_CD || INLINE_VIEW_4.SHOP_CD )
  ELSE STANDARD_HASH('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_4.CAMPAIGN_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || INLINE_VIEW_4.CAMPAIGN_CD )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_4.MEDIATYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || INLINE_VIEW_4.MEDIATYPE_CD )
  ELSE STANDARD_HASH('-1')
END MEDIA_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_3  || '@' ||
               INLINE_VIEW_4.DIVISION_CD_3 || '@' ||
               COALESCE( INLINE_VIEW_4.TEST_RESULT_LEFT_CD,  '-1') || '@' ||
               COALESCE( INLINE_VIEW_4.TEST_RESULT_RIGHT_CD, '-1') ) TEST_RESULT_HK,
	TO_NUMBER(TO_CHAR(INLINE_VIEW_4.ACTIVITY_DATE_DT, 'YYYYMMDD')) ACTIVITY_TEST_DATE_SK,
	INLINE_VIEW_4.ACTIVITY_DATE_DT D_ACTIVITY_TEST_DATE_DT,
	INLINE_VIEW_4.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 D_CLC_REFERENCE_DATE_DT,
	CASE WHEN INLINE_VIEW_4.TEST_RESULT_RIGHT_CD IS NOT NULL 
       OR INLINE_VIEW_4.TEST_RESULT_LEFT_CD  IS NOT NULL
     THEN 1
     ELSE 0
END M1_VALID_TEST_QT,
	INLINE_VIEW_4.MASTER_COMPANY_CD || INLINE_VIEW_4.MASTER_DIVISION_CD ||
INLINE_VIEW_4.MASTER_CUSTOMER_CD M_CLIENT_ID,
	INLINE_VIEW_4.MASTER_COMPANY_CD  ||
INLINE_VIEW_4.MASTER_DIVISION_CD ||
INLINE_VIEW_4.SHOP_CD            ||
INLINE_VIEW_4.MASTER_CUSTOMER_CD ||
TO_CHAR(INLINE_VIEW_4.ACTIVITY_DATE_DT, 'YYYYMM') M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_4.HEARING_LOSS_FL M_HEARING_LOSS_FL,
	CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD='A'
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= INLINE_VIEW_4.D_START_DATE_DT 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= ADD_MONTHS(INLINE_VIEW_4.D_END_DATE_DT, -12)
     THEN 1
     WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD='N' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= ADD_MONTHS(INLINE_VIEW_4.D_END_DATE_DT, - 12)
     THEN 1 
     ELSE CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD = 'A' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= INLINE_VIEW_4.D_END_DATE_DT 
     THEN 1
     WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD = 'N' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 24) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT <= INLINE_VIEW_4.D_END_DATE_DT 
     THEN 1 
     ELSE CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_CY_FL,
	INLINE_VIEW_4.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	INLINE_VIEW_4.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	INLINE_VIEW_4.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	INLINE_VIEW_4.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	INLINE_VIEW_4.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	INLINE_VIEW_4.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	INLINE_VIEW_4.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	INLINE_VIEW_4.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	INLINE_VIEW_4.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	INLINE_VIEW_4.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1 - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT)
     ELSE 3651
END TEST_AGEING_SK,
	CASE WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT) - 1   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT)
     ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_4.TEST_TYPE_SK TEST_TYPE_SK,
	CASE
  WHEN (coalesce(INLINE_VIEW_4.COL_4,INLINE_VIEW_4.MEDIATYPE_CD_1,'03')) IS NOT NULL
  THEN STANDARD_HASH(INLINE_VIEW_4.COMPANY_CD_3 || INLINE_VIEW_4.DIVISION_CD_3 || (coalesce(INLINE_VIEW_4.COL_4,INLINE_VIEW_4.MEDIATYPE_CD_1,'03'))  )
  ELSE STANDARD_HASH ('-1')
END MEDICAL_MEDIATYPE_HK,
	CASE WHEN (INLINE_VIEW_4.AGING_CLUSTER_CD = 2 AND INLINE_VIEW_4.D202_CUSTOMER_TYPE_GROUP_DS = 'CUSTOMER')
       OR (INLINE_VIEW_4.HEARING_LOSS_FL = 1 AND INLINE_VIEW_4.D202_CUSTOMER_TYPE_GROUP_DS IN ('LEAD', 'PROSPECT'))
THEN 1
ELSE 0
END OPPTY_TEST_FLAG,
	INLINE_VIEW_4.TONAL_FL TONAL_FL,
	CASE WHEN INLINE_VIEW_4.COL_6 = 1 THEN 1
      else  0 end FIRST_TEST_OF_THE_MONTH_FL 
from	(
SELECT 
  INLINE_VIEW_3.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW_3.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW_3.AGE_CD AS AGE_CD ,
  INLINE_VIEW_3.AGING_CLUSTER_CD AS AGING_CLUSTER_CD ,
  INLINE_VIEW_3.COMPANY_CD_1 AS COMPANY_CD_1 ,
  INLINE_VIEW_3.DIVISION_CD_1 AS DIVISION_CD_1 ,
  INLINE_VIEW_3.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_3.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_3.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_3.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_3.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_3.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_3.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_3.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_3.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_3.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_3.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_3.COMPANY_CD_2 AS COMPANY_CD_2 ,
  INLINE_VIEW_3.DIVISION_CD_2 AS DIVISION_CD_2 ,
  INLINE_VIEW_3.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_3.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_3.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_3.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_3.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_3.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_3.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_3.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_3.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_3.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_3.COMPANY_CD_3 AS COMPANY_CD_3 ,
  INLINE_VIEW_3.DIVISION_CD_3 AS DIVISION_CD_3 ,
  INLINE_VIEW_3.CUSTOMER_CD_2 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_3.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_3.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_3.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_3.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_3.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_3.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_3.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_3.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_3.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_3.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_3.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_3.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_3.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_3.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_3.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_3.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_3.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_3.COL AS COL ,
  INLINE_VIEW_3.COL_1 AS COL_1 ,
  INLINE_VIEW_3.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_3.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_3.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_3.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_3.COL_2 AS COL_2 ,
  INLINE_VIEW_3.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_3.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_3.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_3.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_3.COL_3 AS COL_3 ,
  INLINE_VIEW_3.COL_4 AS COL_4 ,
  INLINE_VIEW_3.COL_5 AS COL_5 ,
  INLINE_VIEW_3.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_3.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS ,
  INLINE_VIEW_3.COL_6 AS COL_6 ,
  FTB_ACTIVITY_BASE1.COMPANY_CD AS COMPANY_CD_4 ,
  FTB_ACTIVITY_BASE1.DIVISION_CD AS DIVISION_CD_4 ,
  FTB_ACTIVITY_BASE1.ACTIVITY_ID AS ACTIVITY_ID_1 ,
  FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT_1 ,
  FTB_ACTIVITY_BASE1.CUSTOMER_CD AS CUSTOMER_CD_3 ,
  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE1.MEDIATYPE_CD AS MEDIATYPE_CD_1 ,
  CASE WHEN  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD = 'SA' AND FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT = INLINE_VIEW_3.ACTIVITY_DATE_DT
      THEN 1 ELSE 0 END AS COL_7 ,
  ROW_NUMBER() OVER 
(PARTITION BY 
            INLINE_VIEW_3.COMPANY_CD_3,  INLINE_VIEW_3.DIVISION_CD_3
            , INLINE_VIEW_3.SHOP_CD,     INLINE_VIEW_3.LAPTOP_CD
            , INLINE_VIEW_3.ACTIVITY_ID, INLINE_VIEW_3.ACTIVITY_DATE_DT
            , INLINE_VIEW_3.CUSTOMER_CD_2
             ORDER BY (CASE WHEN  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD = 'SA' AND FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT = INLINE_VIEW_3.ACTIVITY_DATE_DT
      THEN 1 ELSE 0 END) DESC ,ABS(INLINE_VIEW_3.ACTIVITY_DATE_DT - FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT) ASC, FTB_ACTIVITY_BASE1.ACTIVITY_ID ASC ) AS COL_8   
FROM 
  (
SELECT 
  CF_LAST_SALE_AGING_RANGE_1.COMPANY_CD AS COMPANY_CD ,
  CF_LAST_SALE_AGING_RANGE_1.DIVISION_CD AS DIVISION_CD ,
  CF_LAST_SALE_AGING_RANGE_1.AGE_CD AS AGE_CD ,
  CF_LAST_SALE_AGING_RANGE_1.AGING_CLUSTER_CD AS AGING_CLUSTER_CD ,
  INLINE_VIEW_2.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_2.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_2.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_2.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_2.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_2.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_2.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_2.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_2.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_2.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_2.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_2.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_2.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_2.COMPANY_CD_1 AS COMPANY_CD_2 ,
  INLINE_VIEW_2.DIVISION_CD_1 AS DIVISION_CD_2 ,
  INLINE_VIEW_2.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_2.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_2.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_2.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_2.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_2.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_2.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_2.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_2.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_2.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_2.COMPANY_CD_2 AS COMPANY_CD_3 ,
  INLINE_VIEW_2.DIVISION_CD_2 AS DIVISION_CD_3 ,
  INLINE_VIEW_2.CUSTOMER_CD_2 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_2.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_2.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_2.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_2.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_2.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_2.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_2.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_2.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_2.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_2.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_2.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_2.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_2.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_2.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_2.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_2.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_2.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_2.COL AS COL ,
  INLINE_VIEW_2.COL_1 AS COL_1 ,
  INLINE_VIEW_2.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_2.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_2.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_2.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_2.COL_2 AS COL_2 ,
  INLINE_VIEW_2.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_2.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_2.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_2.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_2.COL_3 AS COL_3 ,
  INLINE_VIEW_2.COL_4 AS COL_4 ,
  INLINE_VIEW_2.COL_5 AS COL_5 ,
  INLINE_VIEW_2.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_2.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS ,
  ROW_NUMBER() OVER 
(PARTITION BY INLINE_VIEW_2.COMPANY_CD_2
              , INLINE_VIEW_2.DIVISION_CD_2
              , INLINE_VIEW_2.CUSTOMER_CD_2
              , EXTRACT( YEAR FROM INLINE_VIEW_2.ACTIVITY_DATE_DT) 
              , EXTRACT( MONTH FROM INLINE_VIEW_2.ACTIVITY_DATE_DT)
     ORDER BY INLINE_VIEW_2.ACTIVITY_DATE_DT ASC ) AS COL_6   
FROM 
  (
SELECT 
  FTB_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  FT_CUSTOMER_BASE.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  FT_CUSTOMER_BASE.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  FT_CUSTOMER_BASE.COMPANY_CD AS COMPANY_CD_1 ,
  FT_CUSTOMER_BASE.DIVISION_CD AS DIVISION_CD_1 ,
  FT_CUSTOMER_BASE.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  FT_CUSTOMER_BASE.VALID_FROM_DT AS VALID_FROM_DT ,
  FT_CUSTOMER_BASE.VALID_TO_DT AS VALID_TO_DT ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_1.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_1.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_1.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_1.COMPANY_CD AS COMPANY_CD_2 ,
  INLINE_VIEW_1.DIVISION_CD AS DIVISION_CD_2 ,
  INLINE_VIEW_1.CUSTOMER_CD AS CUSTOMER_CD_2 ,
  INLINE_VIEW_1.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_1.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_1.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_1.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_1.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_1.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_1.COL AS COL ,
  INLINE_VIEW_1.COL_1 AS COL_1 ,
  INLINE_VIEW_1.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_1.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_1.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_1.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_1.COL_2 AS COL_2 ,
  DM_SHOP.SHOP_HK AS SHOP_HK ,
  DM_SHOP.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  DM_SHOP.D_START_DATE_DT AS D_START_DATE_DT ,
  DM_SHOP.D_END_DATE_DT AS D_END_DATE_DT ,
  CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END AS COL_3 ,
  CASE WHEN  (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_1.MEDIATYPE_CD NOT IN  ('05', '06') THEN 'F_VM'
  WHEN (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_1.MEDIATYPE_CD  IN  ('05', '06') THEN INLINE_VIEW_1.MEDIATYPE_CD
  WHEN (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'O' AND INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN INLINE_VIEW_1.MEDIATYPE_CD
  ELSE INLINE_VIEW_1.MEDIATYPE_CD END AS COL_4 ,
  CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT > 3650
      THEN INLINE_VIEW_1.COMPANY_CD || '@' || '3651'
      ELSE INLINE_VIEW_1.COMPANY_CD || '@' || TO_CHAR(TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - 1 - FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT)
END AS COL_5 ,
  DM_CLC_STATUS.CLC_STATUS_HK AS CLC_STATUS_HK ,
  DM_CLC_STATUS.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS   
FROM 
  ((
SELECT 
  FTB_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD   
FROM 
  BDFL.FTB_ACTIVITY_BASE PARTITION(P_ES) FTB_ACTIVITY_BASE  
WHERE
  ((FTB_ACTIVITY_BASE.DIVISION_CD = '001' AND FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD = 'VM') 
OR (FTB_ACTIVITY_BASE.DIVISION_CD = '002' AND FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD = 'VM' AND  TRUNC(FTB_ACTIVITY_BASE.ACTIVITY_DATE_DT) >= to_date('2019-01-01','yyyy-mm-dd'))
) 
GROUP BY
  FTB_ACTIVITY_BASE.COMPANY_CD,FTB_ACTIVITY_BASE.DIVISION_CD,FTB_ACTIVITY_BASE.CUSTOMER_CD 
  ) FTB_ACTIVITY_BASE_1  RIGHT OUTER JOIN  (DMM_BDL_ANL.FT_CUSTOMER_BASE PARTITION(P_ES) FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COL_1 AS COL_1 ,
  INLINE_VIEW.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW.COL_2 AS COL_2   
FROM 
  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT AS STATUS_TO_DT ,
  FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE_1.TONAL_FL AS TONAL_FL ,
  FTB_TEST_ACTIVITY_BASE_1.COL AS COL ,
  FTB_TEST_ACTIVITY_BASE_1.COL_1 AS COL_1 ,
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.CUSTOMER_HK AS CUSTOMER_HK_1 ,
  ROW_NUMBER() OVER 
(PARTITION BY FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD,  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD
            , FTB_TEST_ACTIVITY_BASE_1.SHOP_CD,     FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD
            , FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID, FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT
            , FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD
     ORDER BY DM_CUSTOMER_HST.X_AUD_FROM_TS ) AS COL_2   
FROM 
  ((
SELECT 
  FTB_TEST_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE.TONAL_FL AS TONAL_FL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD IS NOT NULL 
     THEN CASE WHEN FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD is null 
               THEN STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.COMPANY_CD        || FTB_TEST_ACTIVITY_BASE.DIVISION_CD        || FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD        )
               ELSE STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD )
          END
     ELSE STANDARD_HASH ('-1') 
END AS COL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.SHOP_CD IS NOT NULL
     THEN STANDARD_HASH ( FTB_TEST_ACTIVITY_BASE.COMPANY_CD || FTB_TEST_ACTIVITY_BASE.DIVISION_CD || FTB_TEST_ACTIVITY_BASE.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END AS COL_1   
FROM 
  BDFL.FTB_TEST_ACTIVITY_BASE PARTITION(P_ES) FTB_TEST_ACTIVITY_BASE  
  ) FTB_TEST_ACTIVITY_BASE_1  LEFT OUTER JOIN  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  (
SELECT 
  DISTINCT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD)) AS CUSTOMER_CD ,
  STANDARD_HASH((COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD))) AS CUSTOMER_HK ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_TO_DT AS STATUS_TO_DT ,
  CASE WHEN CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID = 6 
     THEN COALESCE(CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_HEADER_DT, CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_ITEM_H_DT)
     ELSE NULL
END AS D_CLC_LAST_SALE_HOT_COLD_DT   
FROM 
  (
SELECT 
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD AS COMPANY_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD AS DIVISION_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_HEADER_DT AS LAST_HA_HEADER_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_ITEM_H_DT AS LAST_HA_ITEM_H_DT   
FROM 
  EDW.CL_LIGHT_CUSTOMER_STATUS PARTITION(P_ES) CL_LIGHT_CUSTOMER_STATUS_RMAP_  
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) 
  ) CL_LIGHT_CUSTOMER_STATUS_RMA_1  LEFT OUTER JOIN  (
SELECT 
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL AS X_AUD_CURRENT_FL ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE AS COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE AS MASTER_COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AS MASTER_DIVISION_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE   
FROM 
  EDW.UM_CU_S_CUSTOMER_MAPPING PARTITION(P_ES_PT) UM_CU_S_CUSTOMER_MAPPING_RMAP_  
WHERE
  (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) UM_CU_S_CUSTOMER_MAPPING_RMA_1  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE
  ) DISTINCT__RMAP_ES_CUSTOMER_STA  
  ) DISTINCT__RMAP_ES_CUSTOMER_S_1  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL = DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1 >= DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - 1  < NVL(TRUNC(DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT), TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  LEFT OUTER JOIN  DMM_BDL_ANL.DM_CUSTOMER_HST PARTITION(P_ES) DM_CUSTOMER_HST  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL                               = DM_CUSTOMER_HST.CUSTOMER_HK          AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) >= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) AND 
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) <= TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_2=1
) 
  ) INLINE_VIEW_1  LEFT OUTER JOIN  DMM_BDL_ANL.DM_SHOP PARTITION(P_ES) DM_SHOP  
    ON  DM_SHOP.SHOP_HK = INLINE_VIEW_1.COL_1
     )  
    ON  INLINE_VIEW_1.COMPANY_CD  = FT_CUSTOMER_BASE.COMPANY_CD   and
INLINE_VIEW_1.DIVISION_CD = FT_CUSTOMER_BASE.DIVISION_CD  and 
INLINE_VIEW_1.CUSTOMER_CD = FT_CUSTOMER_BASE.CUSTOMER_CD  AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1 >= FT_CUSTOMER_BASE.VALID_FROM_DT AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - 1  < FT_CUSTOMER_BASE.VALID_TO_DT
     )  
    ON  FTB_ACTIVITY_BASE_1.COMPANY_CD =  INLINE_VIEW_1.COMPANY_CD  
AND FTB_ACTIVITY_BASE_1.DIVISION_CD = INLINE_VIEW_1.DIVISION_CD 
AND FTB_ACTIVITY_BASE_1.CUSTOMER_CD = INLINE_VIEW_1.CUSTOMER_CD
     )  LEFT OUTER JOIN  DMM_BDL_ANL.DM_CLC_STATUS DM_CLC_STATUS  
    ON  DM_CLC_STATUS.CLC_STATUS_HK = CAST(STANDARD_HASH(NVL(INLINE_VIEW_1.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) )
  ) INLINE_VIEW_2  LEFT OUTER JOIN  (
SELECT 
  CF_LAST_SALE_AGING_RANGE.COMPANY_CD AS COMPANY_CD ,
  CF_LAST_SALE_AGING_RANGE.DIVISION_CD AS DIVISION_CD ,
  CF_LAST_SALE_AGING_RANGE.AGE_CD AS AGE_CD ,
  CF_LAST_SALE_AGING_RANGE.AGING_CLUSTER_CD AS AGING_CLUSTER_CD   
FROM 
  DMM_BDL_ANL.CF_LAST_SALE_AGING_RANGE PARTITION(P_ES_PT) CF_LAST_SALE_AGING_RANGE  
WHERE
  (CF_LAST_SALE_AGING_RANGE.COMPANY_CD = '002'
) 
  ) CF_LAST_SALE_AGING_RANGE_1  
    ON  CF_LAST_SALE_AGING_RANGE_1.COMPANY_CD || '@' || CF_LAST_SALE_AGING_RANGE_1.AGE_CD = INLINE_VIEW_2.COL_5
AND INLINE_VIEW_2.DIVISION_CD_2 = CF_LAST_SALE_AGING_RANGE_1.DIVISION_CD
  ) INLINE_VIEW_3  INNER JOIN  BDFL.FTB_ACTIVITY_BASE FTB_ACTIVITY_BASE1  
    ON  FTB_ACTIVITY_BASE1.COMPANY_CD =  INLINE_VIEW_3.COMPANY_CD_3  
AND FTB_ACTIVITY_BASE1.DIVISION_CD = INLINE_VIEW_3.DIVISION_CD_3 
AND FTB_ACTIVITY_BASE1.CUSTOMER_CD = INLINE_VIEW_3.CUSTOMER_CD_2
  ) INLINE_VIEW_4
where		(1=1)	
 and (INLINE_VIEW_4.COL_8 = 1)
)  ODI_GET_FROM
   , Error Msg = ORA-14501: object is not partitioned

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:514)
	... 30 more
]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[63059609-a6dc-4dc2-9321-6761c164b25c]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[457883]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-23 19:21:02.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[6]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-23 19:21:08.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[ODI-1298]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[E]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a585f188-f8ab-4263-b680-01a310876147]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6954325]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6954325]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[457545]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-22 22:27:26.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[4016]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-22 23:34:22.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[Internal]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b507035c-f971-47a5-8a9c-28f0905298c0]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6954161]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6954161]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[457055]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-18 18:03:20.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1212]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-18 18:23:32.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[67f9986f-5064-419c-b822-e7a78a998f80]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[6954456]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[6954456]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[459017]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-05-27 14:29:33.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1005]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-05-27 14:46:18.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenReport">
		<Field name="AgentName" type="java.lang.String"><![CDATA[OracleDIAgent_Tst_01]]></Field>
	<Field name="ContextCode" type="java.lang.String"><![CDATA[CTX_ES]]></Field>
	<Field name="ErrorMessage" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[15aaa49b-7b32-4708-b713-3077d1bc88a0]]></Field>
	<Field name="ITxtSessMess" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbDel" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbErr" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="NbIns" type="com.sunopsis.sql.DbInt"><![CDATA[7012701]]></Field>
	<Field name="NbMrg" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="NbRow" type="com.sunopsis.sql.DbInt"><![CDATA[7012701]]></Field>
	<Field name="NbUpd" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenRunNo" type="com.sunopsis.sql.DbInt"><![CDATA[460270]]></Field>
	<Field name="SessBeg" type="java.sql.Timestamp"><![CDATA[2022-06-06 15:46:09.0]]></Field>
	<Field name="SessDur" type="com.sunopsis.sql.DbFloat"><![CDATA[1248]]></Field>
	<Field name="SessEnd" type="java.sql.Timestamp"><![CDATA[2022-06-06 16:06:57.0]]></Field>
	<Field name="SessRc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="SessStatus" type="java.lang.String"><![CDATA[D]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[af0d50c9-4f6f-44ee-b191-495e4a151929]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MAX_TS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ff815fe3-3960-4677-8dac-58e52a973bd6]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MIN_TS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b2dbd697-c5d0-41b8-bb07-1a16537accc4]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_NO]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String"><![CDATA[01/01/1900 00:00:00]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[edc0e91a-c86d-41df-b768-13fffd9cd31d]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[65166]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_TS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpExpTxtHeader">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4e248013-deaa-4bb3-9d12-95cee5482adb]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[65166]]></Field>
	<Field name="Txt" type="java.lang.String"><![CDATA[Timestamp of the start of an ODI session
Set to '01/01/1900 00:00:00' for the initial data load]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[251c6178-b0cf-4fb4-9329-e418f078aed8]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f95488d5-b21f-40d7-8e88-84af3eb7fd56]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_CONTEXT_PARTITION_CODE]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpVarScen">
		<Field name="DefDate" type="java.sql.Timestamp">null</Field>
	<Field name="DefN" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefV" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[55fbd629-e76e-4b1c-b278-40a081b83778]]></Field>
	<Field name="IndStore" type="java.lang.String"><![CDATA[L]]></Field>
	<Field name="ITxtDefT" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtVar" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="VarDatatype" type="java.lang.String"><![CDATA[N]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_TEST_LESS_DAYS]]></Field>
	<Field name="VarParam" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="VarParamOrder" type="com.sunopsis.sql.DbInt"><![CDATA[7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[20bef831-9433-466f-97a3-1c27272d7956]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_NO]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_NO]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5d7bd8a2-fd11-4339-b489-8a1b20de61e3]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_NO]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7961ebf4-7b65-4481-b7cf-b71d3a0452dc]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_TS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_TS]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[14faf0cc-1221-4afe-a217-229262964922]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_TS]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9de6153a-19ed-42ef-926b-e559eebc94c4]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_MIN_TS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MIN_TS]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[599a8172-db95-4f87-99b1-2533cc8ac4b5]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_MIN_TS]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1ab5e2dc-fcc6-40ae-b7d8-de7612d597e0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String">null</Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="ResName" type="java.lang.String">null</Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[V_SESSION_MAX_TS]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[VD]]></Field>
	<Field name="TableName" type="java.lang.String">null</Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String"><![CDATA[BDFL_AMP.V_SESSION_MAX_TS]]></Field>
	<Field name="VarOp" type="java.lang.String"><![CDATA[=]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e0d26644-a0a2-4e66-bfd8-737e4b36b55f]]></Field>
	<Field name="IndErr" type="java.lang.String">null</Field>
	<Field name="IndLogFinalCmd" type="java.lang.String">null</Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Variable]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[V_SESSION_MAX_TS]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenStep">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="ContextCode" type="java.lang.String">null</Field>
	<Field name="FContextCode" type="java.lang.String">null</Field>
	<Field name="GenInfo" type="java.lang.String"><![CDATA[<map-generation-info>
   <node name="JOIN2_1" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN1_1" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="DM_CLC_STATUS" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FILTER" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="CF_LAST_SALE_AGING_RANGE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="MEDTYPE_MED" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="FILTER1_1" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="MEDTYPE_OTHERS" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="MEDTYPE_SALES" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN3_1" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="RN_OLD_TST_MNTH" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="FILTER2" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="FTB_ACTIVITY_BASE1" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="MED_01" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN_1" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="AGGREGATE" type="XKM" km="XKM SQL Aggregate.GLOBAL"/>
   <node name="VM" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="FTB_ACTIVITY_BASE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="MED_02" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="DISTINCT__RMAP_ES_CUSTOMER_STA" type="XKM" km="XKM SQL Distinct.GLOBAL"/>
   <node name="OUT_RMAP_ES_CUSTOMER_STATUS" type="XKM" km="XKM Oracle Output Signature.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
   </node>
   <node name="RMAP_ES_CUSTOMER_STATUS_AP_RMA" type="LKM" km="LKM Oracle to Oracle Pull (DB Link).GLOBAL">
      <option name="SELECT_FROM_SOURCE_VIEW" value="false" default="true"/>
      <option name="USE_STAGE_TABLE" value="false" default="true"/>
      <option name="ADD_DRIVING_SITE_HINT" value="false" default="true"/>
      <option name="CREATE_DB_LINK" value="true" default="true"/>
      <option name="SOURCE_ACCESS_DB_LINK" value="" default="true"/>
   </node>
   <node name="EXP_RMAP_ES_CUSTOMER_STATUS" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN_RMAP_ES_CUSTOMER_STATUS" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILT_CL_RMAP_ES_CUSTOMER_STATU" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="CL_LIGHT_CUSTOMER_STATUS_RMAP_" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FILT_UM_RMAP_ES_CUSTOMER_STATU" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="UM_CU_S_CUSTOMER_MAPPING_RMAP_" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="EXP_1" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="FT_TEST_ACTIVITY" type="IKM" km="IKM Oracle Control Append for BDFL (multi-partition).BDFL_AMP">
      <option name="INSERT" value="true" default="true"/>
      <option name="COMMIT" value="true" default="true"/>
      <option name="SYNC_JRN_DELETE" value="true" default="true"/>
      <option name="FLOW_CONTROL" value="false" default="false"/>
      <option name="RECYCLE_ERRORS" value="false" default="true"/>
      <option name="STATIC_CONTROL" value="false" default="true"/>
      <option name="TRUNCATE" value="true" default="true"/>
      <option name="DELETE_ALL" value="false" default="true"/>
      <option name="CREATE_TARG_TABLE" value="false" default="false"/>
      <option name="DELETE_TEMPORARY_OBJECTS" value="false" default="false"/>
      <option name="FLOW_TABLE_OPTIONS" value="NOLOGGING" default="true"/>
      <option name="CREATE_FLOW_INDEX" value="true" default="true"/>
      <option name="COMPATIBLE" value="9" default="true"/>
      <option name="VALIDATE" value="false" default="true"/>
      <option name="ANALYZE_TARGET" value="false" default="true"/>
      <option name="HINT_SELECT" value="parallel(4) dynamic_sampling(1)" default="false"/>
      <option name="HINT_INSERT_FLOW" value="APPEND ENABLE_PARALLEL_DML PARALLEL(4) " default="false"/>
      <option name="HINT_INSERT_TARGET" value="APPEND ENABLE_PARALLEL_DML PARALLEL(4)" default="false"/>
      <option name="CONSTRAINTS" value="None" default="true"/>
      <option name="INDEXES" value="None" default="true"/>
      <option name="FILTER_PARTITION" value="true" default="true"/>
      <option name="HINT_SELECT_TARGET" value="" default="true"/>
   </node>
   <node name="FT_TEST_ACTIVITY" type="CKM" km="CKM Oracle for Amplifon.BDFL_AMP">
      <option name="DROP_ERROR_TABLE" value="true" default="true"/>
      <option name="DROP_CHECK_TABLE" value="false" default="true"/>
      <option name="CREATE_ERROR_INDEX" value="true" default="true"/>
      <option name="CREATE_FLOW_INDEX" value="true" default="true"/>
      <option name="COMPATIBLE" value="9" default="true"/>
      <option name="VALIDATE" value="false" default="true"/>
      <option name="ENABLE_EDITION_SUPPORT" value="false" default="true"/>
      <option name="UPGRADE_ERROR_TABLE" value="false" default="true"/>
      <option name="FILTER_CURRENT_FL" value="true" default="true"/>
      <option name="ENABLE_DATA_QUALITY" value="true" default="true"/>
   </node>
   <node name="JOIN3" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN2" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="FILTER1" type="XKM" km="XKM SQL Filter.GLOBAL"/>
   <node name="EXPRESSION" type="XKM" km="XKM SQL Expression.GLOBAL"/>
   <node name="JOIN" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="JOIN1" type="XKM" km="XKM SQL Join.GLOBAL"/>
   <node name="DM_SHOP" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="DM_CUSTOMER_HST" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FT_CUSTOMER_BASE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <node name="FTB_TEST_ACTIVITY_BASE" type="XKM" km="XKM Oracle Extract.GLOBAL">
      <option name="CUSTOM_TEMPLATE" value=" " default="true"/>
      <option name="SELECT_HINT" value=" " default="true"/>
   </node>
   <target name="FT_TEST_ACTIVITY" resource="FT_TEST_ACTIVITY" model="DMM_BDL" logicalSchema="LOG_BDFL_DMM" forcedContext=""/>
</map-generation-info>]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[dc3ff38e-5129-4386-93dc-2d46c591583c]]></Field>
	<Field name="IndLogMethod" type="java.lang.String"><![CDATA[Y]]></Field>
	<Field name="ITxtVarValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="JagentLschemaName" type="java.lang.String">null</Field>
	<Field name="KoExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KoExitCode" type="java.lang.String">null</Field>
	<Field name="KoNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetry" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="KoRetryInterv" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="MaxErr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="MaxErrPrct" type="java.lang.String">null</Field>
	<Field name="ModCode" type="java.lang.String"><![CDATA[DMM_BDL]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OkExit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="OkExitCode" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="OkNextStep" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ResName" type="java.lang.String"><![CDATA[FT_TEST_ACTIVITY]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="StepName" type="java.lang.String"><![CDATA[MAP_ES_FT_TEST_ACTIVITY]]></Field>
	<Field name="StepType" type="java.lang.String"><![CDATA[M]]></Field>
	<Field name="TableName" type="java.lang.String"><![CDATA[FT_TEST_ACTIVITY]]></Field>
	<Field name="VarIncr" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VarLongValue" type="java.lang.String">null</Field>
	<Field name="VarName" type="java.lang.String">null</Field>
	<Field name="VarOp" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c7619bd6-a7db-4fa9-a864-d03e354535f9]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_BEGIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3f39d27d-93c9-4e5d-9b39-1c232e2713a1]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_EDW_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[2]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[GENERIC_SQL]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
<?
String dblinkToSrc = "";
if ("".equals(dblinkToSrc)) {
  dblinkToSrc = odiRef.getInfo("SRC_LSCHEMA_NAME");
}
if ("TRUE".equals("TRUE")) {
  dblinkToSrc += "%UNIQUE_SESSION_TAG";
}
dblinkToSrc = dblinkToSrc.replaceAll(" ","");
dblinkToSrc = dblinkToSrc.replaceAll("-","");
dblinkToSrc = odiRef.getFormattedName(dblinkToSrc);
?>
drop database link <?=dblinkToSrc ?>
       ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[782c67ea-a8ec-4658-a20d-fe633501bc23]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Prepare: drop database link to source]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[LKM Oracle to Oracle Pull (DB Link)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[779ae947-1ca6-4b1c-ace4-d52ec5e76cef]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_MAIN]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ea7690f7-f014-4c95-9f8b-393576612894]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e21c22dc-e5c7-4ea7-a3fd-97bc498b299f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[250]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Enable indexes]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[/*commit*/ ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2d7f3f1b-7bf6-4c63-a0f7-1272819a3ef4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[270]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Commit transaction]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c26cba9f-cdec-4235-afb6-9cb62546c840]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[220]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[100]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Disable constraints]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b95b9b1d-ca55-45a1-a290-bf78da5d1614]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[260]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Enable constraints]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e1797e24-af1e-4f77-a498-5ade426b3f5c]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[230]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Disable indexes]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[create table <?= odiRef.getObjectName("L", "FT_TEST_ACTIVITY", "LOG_BDFL_DMM", "D") ?>
(
	X_AUD_DATASOURCE_ID	NUMBER NULL,
	X_AUD_SESSION_ID	NUMBER NULL,
	X_AUD_FROM_TS	TIMESTAMP(6) NULL,
	X_AUD_TO_TS	TIMESTAMP(6) NULL,
	X_AUD_CURRENT_FL	NUMBER NULL,
	X_AUD_AGENT_CD	VARCHAR2(100 CHAR) NULL,
	X_AUD_INSERT_TS	TIMESTAMP(6) NULL,
	X_AUD_UPDATE_TS	TIMESTAMP(6) NULL,
	X_AUD_COMPANY_CD	VARCHAR2(3 CHAR) NULL,
	COMPANY_CD	VARCHAR2(63 CHAR) NULL,
	DIVISION_CD	VARCHAR2(63 CHAR) NULL,
	SHOP_CD	VARCHAR2(63 CHAR) NULL,
	LAPTOP_CD	VARCHAR2(63 CHAR) NULL,
	ACTIVITY_ID	VARCHAR2(63 CHAR) NULL,
	ACTIVITY_DATE_DT	DATE NULL,
	CUSTOMER_CD	VARCHAR2(63 CHAR) NULL,
	COMPANY_HK	VARCHAR2(63 CHAR) NULL,
	CUSTOMER_HK	VARCHAR2(63 CHAR) NULL,
	CLC_STATUS_HK	VARCHAR2(63 CHAR) NULL,
	CUSTOMER_HST_SK	NUMBER NULL,
	SHOP_HK	VARCHAR2(63 CHAR) NULL,
	DAYCENTER_HK	VARCHAR2(63 CHAR) NULL,
	LOCATION_TYPE_HK	VARCHAR2(63 CHAR) NULL,
	EMPLOYEE_HK	VARCHAR2(63 CHAR) NULL,
	EMP_PROMOTER_HK	VARCHAR2(63 CHAR) NULL,
	CAMPAIGN_HK	VARCHAR2(63 CHAR) NULL,
	MEDIA_TYPE_HK	VARCHAR2(63 CHAR) NULL,
	TEST_RESULT_HK	VARCHAR2(63 CHAR) NULL,
	ACTIVITY_TEST_DATE_SK	NUMBER NULL,
	D_ACTIVITY_TEST_DATE_DT	DATE NULL,
	D_LAST_SALE_HOT_COLD_DT	DATE NULL,
	D_CLC_REFERENCE_DATE_DT	DATE NULL,
	M1_VALID_TEST_QT	NUMBER NULL,
	M_CLIENT_ID	VARCHAR2(63 CHAR) NULL,
	M_CLIENT_SHOP_MONTH_ID	VARCHAR2(63 CHAR) NULL,
	M_HEARING_LOSS_FL	NUMBER NULL,
	M_SAME_STORE_GROWTH_PY_FL	NUMBER NULL,
	M_SAME_STORE_GROWTH_CY_FL	NUMBER NULL,
	CRM_LAST_MARKETING_LIST_HK	VARCHAR2(63 CHAR) NULL,
	CRM_LAST_RESULT_HK	VARCHAR2(63 CHAR) NULL,
	CRM_LAST_TM_MARKETING_LIST_HK	VARCHAR2(63 CHAR) NULL,
	CRM_LAST_TM_RESULT_HK	VARCHAR2(63 CHAR) NULL,
	ENR_LAST_NBA_HK	VARCHAR2(63 CHAR) NULL,
	CTB_CONTACTABILITY_HK	VARCHAR2(63 CHAR) NULL,
	INT_LAST_INTERACTION_HK	VARCHAR2(63 CHAR) NULL,
	TST_LAST_TEST_HK	VARCHAR2(63 CHAR) NULL,
	TRI_LAST_TRIAL_HK	VARCHAR2(63 CHAR) NULL,
	COM_LAST_SALE_HK	VARCHAR2(63 CHAR) NULL,
	TEST_AGEING_SK	NUMBER NULL,
	INTERACTION_AGEING_SK	NUMBER NULL,
	TEST_TYPE_SK	NUMBER(1,0) NULL,
	MEDICAL_MEDIATYPE_HK	VARCHAR2(63 CHAR) NULL,
	OPPTY_TEST_FLAG	NUMBER NULL,
	TONAL_FL	NUMBER NULL,
	FIRST_TEST_OF_THE_MONTH_FL	NUMBER NULL
)  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fe925606-840d-416b-beaf-7cad59858d74]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[80]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Create target table ]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[ 
insert /*+ APPEND ENABLE_PARALLEL_DML PARALLEL(4) */ into	<?= odiRef.getObjectName("L", "FT_TEST_ACTIVITY", "LOG_BDFL_DMM", "D") ?>
 PARTITION(#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET)
( 
	X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	TEST_TYPE_SK,
	MEDICAL_MEDIATYPE_HK,
	OPPTY_TEST_FLAG,
	TONAL_FL,
	FIRST_TEST_OF_THE_MONTH_FL 
) 
select /*+  */
    X_AUD_DATASOURCE_ID,
	X_AUD_SESSION_ID,
	X_AUD_FROM_TS,
	X_AUD_TO_TS,
	X_AUD_CURRENT_FL,
	X_AUD_AGENT_CD,
	X_AUD_INSERT_TS,
	X_AUD_UPDATE_TS,
	X_AUD_COMPANY_CD,
	COMPANY_CD,
	DIVISION_CD,
	SHOP_CD,
	LAPTOP_CD,
	ACTIVITY_ID,
	ACTIVITY_DATE_DT,
	CUSTOMER_CD,
	COMPANY_HK,
	CUSTOMER_HK,
	CLC_STATUS_HK,
	CUSTOMER_HST_SK,
	SHOP_HK,
	DAYCENTER_HK,
	LOCATION_TYPE_HK,
	EMPLOYEE_HK,
	EMP_PROMOTER_HK,
	CAMPAIGN_HK,
	MEDIA_TYPE_HK,
	TEST_RESULT_HK,
	ACTIVITY_TEST_DATE_SK,
	D_ACTIVITY_TEST_DATE_DT,
	D_LAST_SALE_HOT_COLD_DT,
	D_CLC_REFERENCE_DATE_DT,
	M1_VALID_TEST_QT,
	M_CLIENT_ID,
	M_CLIENT_SHOP_MONTH_ID,
	M_HEARING_LOSS_FL,
	M_SAME_STORE_GROWTH_PY_FL,
	M_SAME_STORE_GROWTH_CY_FL,
	CRM_LAST_MARKETING_LIST_HK,
	CRM_LAST_RESULT_HK,
	CRM_LAST_TM_MARKETING_LIST_HK,
	CRM_LAST_TM_RESULT_HK,
	ENR_LAST_NBA_HK,
	CTB_CONTACTABILITY_HK,
	INT_LAST_INTERACTION_HK,
	TST_LAST_TEST_HK,
	TRI_LAST_TRIAL_HK,
	COM_LAST_SALE_HK,
	TEST_AGEING_SK,
	INTERACTION_AGEING_SK,
	TEST_TYPE_SK,
	MEDICAL_MEDIATYPE_HK,
	OPPTY_TEST_FLAG,
	TONAL_FL,
	FIRST_TEST_OF_THE_MONTH_FL   
FROM (	
select 	
	4 X_AUD_DATASOURCE_ID,
	#BDFL_AMP.V_SESSION_NO X_AUD_SESSION_ID,
	TO_TIMESTAMP('01/01/1900','DD/MM/YYYY HH24:MI:SS') X_AUD_FROM_TS,
	TO_TIMESTAMP('31/12/9999','DD/MM/YYYY HH24:MI:SS') X_AUD_TO_TS,
	1 X_AUD_CURRENT_FL,
	'MAP_ES_FT_TEST_ACTIVITY' || ' (' || '<?=odiRef.getContext("CTX_CODE") ?>' || ')' X_AUD_AGENT_CD,
	SYSTIMESTAMP X_AUD_INSERT_TS,
	SYSTIMESTAMP X_AUD_UPDATE_TS,
	INLINE_VIEW_4.COMPANY_CD_4 X_AUD_COMPANY_CD,
	INLINE_VIEW_4.COMPANY_CD_4 COMPANY_CD,
	INLINE_VIEW_4.DIVISION_CD_4 DIVISION_CD,
	INLINE_VIEW_4.SHOP_CD SHOP_CD,
	INLINE_VIEW_4.LAPTOP_CD LAPTOP_CD,
	INLINE_VIEW_4.ACTIVITY_ID_1 ACTIVITY_ID,
	INLINE_VIEW_4.ACTIVITY_DATE_DT_1 ACTIVITY_DATE_DT,
	INLINE_VIEW_4.CUSTOMER_CD_3 CUSTOMER_CD,
	STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_4 || INLINE_VIEW_4.DIVISION_CD_4 ) COMPANY_HK,
	INLINE_VIEW_4.COL CUSTOMER_HK,
	CAST(STANDARD_HASH(NVL(INLINE_VIEW_4.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) ) CLC_STATUS_HK,
	INLINE_VIEW_4.CUSTOMER_HST_SK CUSTOMER_HST_SK,
	INLINE_VIEW_4.COL_1 SHOP_HK,
	CASE WHEN INLINE_VIEW_4.DAYCENTER_CD IS NOT NULL
     THEN STANDARD_HASH ( INLINE_VIEW_4.COMPANY_CD_4   || INLINE_VIEW_4.DIVISION_CD_4 ||
                          INLINE_VIEW_4.DAYCENTER_CD || INLINE_VIEW_4.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END DAYCENTER_HK,
	CASE
  WHEN INLINE_VIEW_4.LOCATION_TYPE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_4 || INLINE_VIEW_4.DIVISION_CD_4 || INLINE_VIEW_4.LOCATION_TYPE_CD )
  ELSE STANDARD_HASH ('-1')
END LOCATION_TYPE_HK,
	CASE
  WHEN INLINE_VIEW_4.EMPLOYEE_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_4  || INLINE_VIEW_4.DIVISION_CD_4 ||
                      INLINE_VIEW_4.EMPLOYEE_CD || INLINE_VIEW_4.SHOP_CD )
  ELSE STANDARD_HASH ('-1')
END EMPLOYEE_HK,
	CASE
  WHEN INLINE_VIEW_4.PROMOTER_CD IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_4  || INLINE_VIEW_4.DIVISION_CD_4 || 
                      INLINE_VIEW_4.PROMOTER_CD || INLINE_VIEW_4.SHOP_CD )
  ELSE STANDARD_HASH('-1')
END EMP_PROMOTER_HK,
	CASE
  WHEN INLINE_VIEW_4.CAMPAIGN_CD IS NOT NULL
  THEN STANDARD_HASH ( INLINE_VIEW_4.COMPANY_CD_4 || INLINE_VIEW_4.DIVISION_CD_4 || INLINE_VIEW_4.CAMPAIGN_CD )
  ELSE STANDARD_HASH ('-1')
END CAMPAIGN_HK,
	CASE
  WHEN INLINE_VIEW_4.MEDIATYPE_CD_1 IS NOT NULL
  THEN STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_4 || INLINE_VIEW_4.DIVISION_CD_4 || INLINE_VIEW_4.MEDIATYPE_CD_1 )
  ELSE STANDARD_HASH('-1')
END MEDIA_TYPE_HK,
	STANDARD_HASH( INLINE_VIEW_4.COMPANY_CD_4  || '@' ||
               INLINE_VIEW_4.DIVISION_CD_4 || '@' ||
               COALESCE( INLINE_VIEW_4.TEST_RESULT_LEFT_CD,  '-1') || '@' ||
               COALESCE( INLINE_VIEW_4.TEST_RESULT_RIGHT_CD, '-1') ) TEST_RESULT_HK,
	TO_NUMBER(TO_CHAR(INLINE_VIEW_4.ACTIVITY_DATE_DT_1, 'YYYYMMDD')) ACTIVITY_TEST_DATE_SK,
	INLINE_VIEW_4.ACTIVITY_DATE_DT_1 D_ACTIVITY_TEST_DATE_DT,
	INLINE_VIEW_4.COM_LAST_HA_SALE_DT D_LAST_SALE_HOT_COLD_DT,
	TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS D_CLC_REFERENCE_DATE_DT,
	CASE WHEN INLINE_VIEW_4.TEST_RESULT_RIGHT_CD IS NOT NULL 
       OR INLINE_VIEW_4.TEST_RESULT_LEFT_CD  IS NOT NULL
     THEN 1
     ELSE 0
END M1_VALID_TEST_QT,
	INLINE_VIEW_4.MASTER_COMPANY_CD || INLINE_VIEW_4.MASTER_DIVISION_CD ||
INLINE_VIEW_4.MASTER_CUSTOMER_CD M_CLIENT_ID,
	INLINE_VIEW_4.MASTER_COMPANY_CD  ||
INLINE_VIEW_4.MASTER_DIVISION_CD ||
INLINE_VIEW_4.SHOP_CD            ||
INLINE_VIEW_4.MASTER_CUSTOMER_CD ||
TO_CHAR(INLINE_VIEW_4.ACTIVITY_DATE_DT_1, 'YYYYMM') M_CLIENT_SHOP_MONTH_ID,
	INLINE_VIEW_4.HEARING_LOSS_FL M_HEARING_LOSS_FL,
	CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD='A'
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 >= INLINE_VIEW_4.D_START_DATE_DT 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 <= ADD_MONTHS(INLINE_VIEW_4.D_END_DATE_DT, -12)
     THEN 1
     WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD='N' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 <= ADD_MONTHS(INLINE_VIEW_4.D_END_DATE_DT, - 12)
     THEN 1 
     ELSE CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_PY_FL,
	CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD = 'A' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 12) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 <= INLINE_VIEW_4.D_END_DATE_DT 
     THEN 1
     WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD = 'N' 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 >= ADD_MONTHS(INLINE_VIEW_4.D_START_DATE_DT, 24) 
      AND INLINE_VIEW_4.ACTIVITY_DATE_DT_1 <= INLINE_VIEW_4.D_END_DATE_DT 
     THEN 1 
     ELSE CASE WHEN INLINE_VIEW_4.D_SHOP_ORIGIN_CD IS NOT NULL 
               THEN 0
               ELSE NULL 
          END
END M_SAME_STORE_GROWTH_CY_FL,
	INLINE_VIEW_4.CRM_LAST_MARKETING_LIST_HK CRM_LAST_MARKETING_LIST_HK,
	INLINE_VIEW_4.CRM_LAST_RESULT_HK CRM_LAST_RESULT_HK,
	INLINE_VIEW_4.CRM_LAST_TM_MARKETING_LIST_HK CRM_LAST_TM_MARKETING_LIST_HK,
	INLINE_VIEW_4.CRM_LAST_TM_RESULT_HK CRM_LAST_TM_RESULT_HK,
	INLINE_VIEW_4.ENR_LAST_NBA_HK ENR_LAST_NBA_HK,
	INLINE_VIEW_4.CTB_CONTACTABILITY_HK CTB_CONTACTABILITY_HK,
	INLINE_VIEW_4.INT_LAST_INTERACTION_HK INT_LAST_INTERACTION_HK,
	INLINE_VIEW_4.TST_LAST_TEST_HK TST_LAST_TEST_HK,
	INLINE_VIEW_4.TRI_LAST_TRIAL_HK TRI_LAST_TRIAL_HK,
	INLINE_VIEW_4.COM_LAST_SALE_HK COM_LAST_SALE_HK,
	CASE WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS - TRUNC(INLINE_VIEW_4.TST_LAST_TEST_DT)
     ELSE 3651
END TEST_AGEING_SK,
	CASE WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT) IS NULL 
     THEN NULL
     WHEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT) < 3651 
     THEN TRUNC(INLINE_VIEW_4.ACTIVITY_DATE_DT_1) - #BDFL_AMP.V_TEST_LESS_DAYS   - TRUNC(INLINE_VIEW_4.INT_LAST_INTERACTION_DT)
     ELSE 3651
END INTERACTION_AGEING_SK,
	INLINE_VIEW_4.TEST_TYPE_SK TEST_TYPE_SK,
	CASE
  WHEN (coalesce(INLINE_VIEW_4.COL_4,INLINE_VIEW_4.MEDIATYPE_CD,'03')) IS NOT NULL
  THEN STANDARD_HASH(INLINE_VIEW_4.COMPANY_CD_4 || INLINE_VIEW_4.DIVISION_CD_4 || (coalesce(INLINE_VIEW_4.COL_4,INLINE_VIEW_4.MEDIATYPE_CD,'03'))  )
  ELSE STANDARD_HASH ('-1')
END MEDICAL_MEDIATYPE_HK,
	CASE WHEN (INLINE_VIEW_4.AGING_CLUSTER_CD = 2 AND INLINE_VIEW_4.D202_CUSTOMER_TYPE_GROUP_DS = 'CUSTOMER')
       OR (INLINE_VIEW_4.HEARING_LOSS_FL = 1 AND INLINE_VIEW_4.D202_CUSTOMER_TYPE_GROUP_DS IN ('LEAD', 'PROSPECT'))
THEN 1
ELSE 0
END OPPTY_TEST_FLAG,
	INLINE_VIEW_4.TONAL_FL TONAL_FL,
	CASE WHEN INLINE_VIEW_4.COL_6 = 1 THEN 1
      else  0 end FIRST_TEST_OF_THE_MONTH_FL 
from	(
SELECT 
  FTB_ACTIVITY_BASE1_1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE1_1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE1_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_ACTIVITY_BASE1_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_ACTIVITY_BASE1_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ACTIVITY_BASE1_1.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE1_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_3.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_3.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_3.AGE_CD AS AGE_CD ,
  INLINE_VIEW_3.AGING_CLUSTER_CD AS AGING_CLUSTER_CD ,
  INLINE_VIEW_3.COMPANY_CD_1 AS COMPANY_CD_2 ,
  INLINE_VIEW_3.DIVISION_CD_1 AS DIVISION_CD_2 ,
  INLINE_VIEW_3.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  INLINE_VIEW_3.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_3.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_3.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_3.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_3.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_3.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_3.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_3.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_3.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_3.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_3.COMPANY_CD_2 AS COMPANY_CD_3 ,
  INLINE_VIEW_3.DIVISION_CD_2 AS DIVISION_CD_3 ,
  INLINE_VIEW_3.CUSTOMER_CD_1 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_3.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_3.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_3.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_3.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_3.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_3.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_3.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_3.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_3.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_3.COMPANY_CD_3 AS COMPANY_CD_4 ,
  INLINE_VIEW_3.DIVISION_CD_3 AS DIVISION_CD_4 ,
  INLINE_VIEW_3.CUSTOMER_CD_2 AS CUSTOMER_CD_3 ,
  INLINE_VIEW_3.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_3.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_3.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_3.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_3.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_3.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_3.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_3.MEDIATYPE_CD AS MEDIATYPE_CD_1 ,
  INLINE_VIEW_3.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_3.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_3.ACTIVITY_ID AS ACTIVITY_ID_1 ,
  INLINE_VIEW_3.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT_1 ,
  INLINE_VIEW_3.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_3.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_3.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_3.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_3.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_3.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_3.COL AS COL ,
  INLINE_VIEW_3.COL_1 AS COL_1 ,
  INLINE_VIEW_3.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_3.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_3.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_3.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_3.COL_2 AS COL_2 ,
  INLINE_VIEW_3.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_3.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_3.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_3.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_3.COL_3 AS COL_3 ,
  INLINE_VIEW_3.COL_4 AS COL_4 ,
  INLINE_VIEW_3.COL_5 AS COL_5 ,
  INLINE_VIEW_3.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_3.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS ,
  INLINE_VIEW_3.COL_6 AS COL_6 ,
  CASE WHEN  FTB_ACTIVITY_BASE1_1.ACTIVITY_TYPE_CD = 'SA' AND FTB_ACTIVITY_BASE1_1.ACTIVITY_DATE_DT = INLINE_VIEW_3.ACTIVITY_DATE_DT
      THEN 1 ELSE 0 END AS COL_7 ,
  ROW_NUMBER() OVER 
(PARTITION BY 
            INLINE_VIEW_3.COMPANY_CD_3,  INLINE_VIEW_3.DIVISION_CD_3
            , INLINE_VIEW_3.SHOP_CD,     INLINE_VIEW_3.LAPTOP_CD
            , INLINE_VIEW_3.ACTIVITY_ID, INLINE_VIEW_3.ACTIVITY_DATE_DT
            , INLINE_VIEW_3.CUSTOMER_CD_2
             ORDER BY (CASE WHEN  FTB_ACTIVITY_BASE1_1.ACTIVITY_TYPE_CD = 'SA' AND FTB_ACTIVITY_BASE1_1.ACTIVITY_DATE_DT = INLINE_VIEW_3.ACTIVITY_DATE_DT
      THEN 1 ELSE 0 END) DESC ,ABS(INLINE_VIEW_3.ACTIVITY_DATE_DT - FTB_ACTIVITY_BASE1_1.ACTIVITY_DATE_DT) ASC, FTB_ACTIVITY_BASE1_1.ACTIVITY_ID ASC ) AS COL_8   
FROM 
  (
SELECT 
  CF_LAST_SALE_AGING_RANGE_1.COMPANY_CD AS COMPANY_CD ,
  CF_LAST_SALE_AGING_RANGE_1.DIVISION_CD AS DIVISION_CD ,
  CF_LAST_SALE_AGING_RANGE_1.AGE_CD AS AGE_CD ,
  CF_LAST_SALE_AGING_RANGE_1.AGING_CLUSTER_CD AS AGING_CLUSTER_CD ,
  INLINE_VIEW_2.COMPANY_CD AS COMPANY_CD_1 ,
  INLINE_VIEW_2.DIVISION_CD AS DIVISION_CD_1 ,
  INLINE_VIEW_2.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW_2.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  INLINE_VIEW_2.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  INLINE_VIEW_2.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  INLINE_VIEW_2.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  INLINE_VIEW_2.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  INLINE_VIEW_2.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  INLINE_VIEW_2.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  INLINE_VIEW_2.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  INLINE_VIEW_2.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  INLINE_VIEW_2.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  INLINE_VIEW_2.COMPANY_CD_1 AS COMPANY_CD_2 ,
  INLINE_VIEW_2.DIVISION_CD_1 AS DIVISION_CD_2 ,
  INLINE_VIEW_2.CUSTOMER_CD_1 AS CUSTOMER_CD_1 ,
  INLINE_VIEW_2.VALID_FROM_DT AS VALID_FROM_DT ,
  INLINE_VIEW_2.VALID_TO_DT AS VALID_TO_DT ,
  INLINE_VIEW_2.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  INLINE_VIEW_2.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  INLINE_VIEW_2.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_2.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_2.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_2.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_2.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_2.COMPANY_CD_2 AS COMPANY_CD_3 ,
  INLINE_VIEW_2.DIVISION_CD_2 AS DIVISION_CD_3 ,
  INLINE_VIEW_2.CUSTOMER_CD_2 AS CUSTOMER_CD_2 ,
  INLINE_VIEW_2.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_2.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_2.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_2.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_2.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_2.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_2.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_2.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_2.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_2.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_2.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_2.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_2.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_2.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_2.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_2.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_2.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_2.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_2.COL AS COL ,
  INLINE_VIEW_2.COL_1 AS COL_1 ,
  INLINE_VIEW_2.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_2.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_2.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_2.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_2.COL_2 AS COL_2 ,
  INLINE_VIEW_2.SHOP_HK AS SHOP_HK ,
  INLINE_VIEW_2.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  INLINE_VIEW_2.D_START_DATE_DT AS D_START_DATE_DT ,
  INLINE_VIEW_2.D_END_DATE_DT AS D_END_DATE_DT ,
  INLINE_VIEW_2.COL_3 AS COL_3 ,
  INLINE_VIEW_2.COL_4 AS COL_4 ,
  INLINE_VIEW_2.COL_5 AS COL_5 ,
  INLINE_VIEW_2.CLC_STATUS_HK AS CLC_STATUS_HK ,
  INLINE_VIEW_2.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS ,
  ROW_NUMBER() OVER 
(PARTITION BY INLINE_VIEW_2.COMPANY_CD_2
              , INLINE_VIEW_2.DIVISION_CD_2
              , INLINE_VIEW_2.CUSTOMER_CD_2
              , EXTRACT( YEAR FROM INLINE_VIEW_2.ACTIVITY_DATE_DT) 
              , EXTRACT( MONTH FROM INLINE_VIEW_2.ACTIVITY_DATE_DT)
     ORDER BY INLINE_VIEW_2.ACTIVITY_DATE_DT ASC ) AS COL_6   
FROM 
  (
SELECT 
  FTB_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FT_CUSTOMER_BASE.CRM_LAST_MARKETING_LIST_HK AS CRM_LAST_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_RESULT_HK AS CRM_LAST_RESULT_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_MARKETING_LIST_HK AS CRM_LAST_TM_MARKETING_LIST_HK ,
  FT_CUSTOMER_BASE.CRM_LAST_TM_RESULT_HK AS CRM_LAST_TM_RESULT_HK ,
  FT_CUSTOMER_BASE.ENR_LAST_NBA_HK AS ENR_LAST_NBA_HK ,
  FT_CUSTOMER_BASE.CTB_CONTACTABILITY_HK AS CTB_CONTACTABILITY_HK ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_HK AS INT_LAST_INTERACTION_HK ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_HK AS TST_LAST_TEST_HK ,
  FT_CUSTOMER_BASE.TRI_LAST_TRIAL_HK AS TRI_LAST_TRIAL_HK ,
  FT_CUSTOMER_BASE.COM_LAST_SALE_HK AS COM_LAST_SALE_HK ,
  FT_CUSTOMER_BASE.COMPANY_CD AS COMPANY_CD_1 ,
  FT_CUSTOMER_BASE.DIVISION_CD AS DIVISION_CD_1 ,
  FT_CUSTOMER_BASE.CUSTOMER_CD AS CUSTOMER_CD_1 ,
  FT_CUSTOMER_BASE.VALID_FROM_DT AS VALID_FROM_DT ,
  FT_CUSTOMER_BASE.VALID_TO_DT AS VALID_TO_DT ,
  FT_CUSTOMER_BASE.INT_LAST_INTERACTION_DT AS INT_LAST_INTERACTION_DT ,
  FT_CUSTOMER_BASE.TST_LAST_TEST_DT AS TST_LAST_TEST_DT ,
  FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT AS COM_LAST_HA_SALE_DT ,
  INLINE_VIEW_1.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW_1.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW_1.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW_1.COMPANY_CD AS COMPANY_CD_2 ,
  INLINE_VIEW_1.DIVISION_CD AS DIVISION_CD_2 ,
  INLINE_VIEW_1.CUSTOMER_CD AS CUSTOMER_CD_2 ,
  INLINE_VIEW_1.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW_1.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW_1.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW_1.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW_1.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW_1.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW_1.COL AS COL ,
  INLINE_VIEW_1.COL_1 AS COL_1 ,
  INLINE_VIEW_1.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW_1.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW_1.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW_1.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW_1.COL_2 AS COL_2 ,
  DM_SHOP.SHOP_HK AS SHOP_HK ,
  DM_SHOP.D_SHOP_ORIGIN_CD AS D_SHOP_ORIGIN_CD ,
  DM_SHOP.D_START_DATE_DT AS D_START_DATE_DT ,
  DM_SHOP.D_END_DATE_DT AS D_END_DATE_DT ,
  CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END AS COL_3 ,
  CASE WHEN  (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_1.MEDIATYPE_CD NOT IN  ('05', '06') THEN 'F_VM'
  WHEN (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'S' AND   INLINE_VIEW_1.MEDIATYPE_CD  IN  ('05', '06') THEN INLINE_VIEW_1.MEDIATYPE_CD
  WHEN (CASE WHEN INLINE_VIEW_1.MEDIATYPE_CD IN ('05', '06') THEN 'S'
  WHEN FTB_ACTIVITY_BASE_1.COMPANY_CD IS NOT NULL THEN 'S'
  WHEN INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN 'O'
  ELSE 'N' END) = 'O' AND INLINE_VIEW_1.MEDIATYPE_CD = '31' THEN INLINE_VIEW_1.MEDIATYPE_CD
  ELSE INLINE_VIEW_1.MEDIATYPE_CD END AS COL_4 ,
  CASE WHEN TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - #BDFL_AMP.V_TEST_LESS_DAYS - FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT > 3650
      THEN INLINE_VIEW_1.COMPANY_CD || '@' || '3651'
      ELSE INLINE_VIEW_1.COMPANY_CD || '@' || TO_CHAR(TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT) - #BDFL_AMP.V_TEST_LESS_DAYS - FT_CUSTOMER_BASE.COM_LAST_HA_SALE_DT)
END AS COL_5 ,
  DM_CLC_STATUS.CLC_STATUS_HK AS CLC_STATUS_HK ,
  DM_CLC_STATUS.D202_CUSTOMER_TYPE_GROUP_DS AS D202_CUSTOMER_TYPE_GROUP_DS   
FROM 
  ((
SELECT 
  FTB_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD   
FROM 
  <?= odiRef.getObjectName("L", "FTB_ACTIVITY_BASE", "LOG_BDFL", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FTB_ACTIVITY_BASE  
WHERE
  ((FTB_ACTIVITY_BASE.DIVISION_CD in ('001', '003') AND FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD = 'VM') 
OR (FTB_ACTIVITY_BASE.DIVISION_CD = '002' AND FTB_ACTIVITY_BASE.ACTIVITY_TYPE_CD = 'VM' AND  TRUNC(FTB_ACTIVITY_BASE.ACTIVITY_DATE_DT) >= to_date('2019-01-01','yyyy-mm-dd'))
) 
GROUP BY
  FTB_ACTIVITY_BASE.COMPANY_CD,FTB_ACTIVITY_BASE.DIVISION_CD,FTB_ACTIVITY_BASE.CUSTOMER_CD 
  ) FTB_ACTIVITY_BASE_1  RIGHT OUTER JOIN  (<?= odiRef.getObjectName("L", "FT_CUSTOMER_BASE", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FT_CUSTOMER_BASE  RIGHT OUTER JOIN  ((
SELECT 
  INLINE_VIEW.CUSTOMER_HK AS CUSTOMER_HK ,
  INLINE_VIEW.STATUS_ID AS STATUS_ID ,
  INLINE_VIEW.STATUS_FROM_DT AS STATUS_FROM_DT ,
  INLINE_VIEW.STATUS_TO_DT AS STATUS_TO_DT ,
  INLINE_VIEW.COMPANY_CD AS COMPANY_CD ,
  INLINE_VIEW.DIVISION_CD AS DIVISION_CD ,
  INLINE_VIEW.CUSTOMER_CD AS CUSTOMER_CD ,
  INLINE_VIEW.SHOP_CD AS SHOP_CD ,
  INLINE_VIEW.LAPTOP_CD AS LAPTOP_CD ,
  INLINE_VIEW.CAMPAIGN_CD AS CAMPAIGN_CD ,
  INLINE_VIEW.EMPLOYEE_CD AS EMPLOYEE_CD ,
  INLINE_VIEW.PROMOTER_CD AS PROMOTER_CD ,
  INLINE_VIEW.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  INLINE_VIEW.DAYCENTER_CD AS DAYCENTER_CD ,
  INLINE_VIEW.MEDIATYPE_CD AS MEDIATYPE_CD ,
  INLINE_VIEW.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  INLINE_VIEW.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  INLINE_VIEW.ACTIVITY_ID AS ACTIVITY_ID ,
  INLINE_VIEW.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  INLINE_VIEW.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  INLINE_VIEW.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  INLINE_VIEW.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  INLINE_VIEW.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  INLINE_VIEW.TEST_TYPE_SK AS TEST_TYPE_SK ,
  INLINE_VIEW.TONAL_FL AS TONAL_FL ,
  INLINE_VIEW.COL AS COL ,
  INLINE_VIEW.COL_1 AS COL_1 ,
  INLINE_VIEW.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  INLINE_VIEW.X_AUD_TO_TS AS X_AUD_TO_TS ,
  INLINE_VIEW.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  INLINE_VIEW.CUSTOMER_HK_1 AS CUSTOMER_HK_1 ,
  INLINE_VIEW.COL_2 AS COL_2   
FROM 
  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT AS STATUS_TO_DT ,
  FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE_1.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE_1.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE_1.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE_1.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE_1.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE_1.TONAL_FL AS TONAL_FL ,
  FTB_TEST_ACTIVITY_BASE_1.COL AS COL ,
  FTB_TEST_ACTIVITY_BASE_1.COL_1 AS COL_1 ,
  DM_CUSTOMER_HST.X_AUD_FROM_TS AS X_AUD_FROM_TS ,
  DM_CUSTOMER_HST.X_AUD_TO_TS AS X_AUD_TO_TS ,
  DM_CUSTOMER_HST.CUSTOMER_HST_SK AS CUSTOMER_HST_SK ,
  DM_CUSTOMER_HST.CUSTOMER_HK AS CUSTOMER_HK_1 ,
  ROW_NUMBER() OVER 
(PARTITION BY FTB_TEST_ACTIVITY_BASE_1.COMPANY_CD,  FTB_TEST_ACTIVITY_BASE_1.DIVISION_CD
            , FTB_TEST_ACTIVITY_BASE_1.SHOP_CD,     FTB_TEST_ACTIVITY_BASE_1.LAPTOP_CD
            , FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_ID, FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT
            , FTB_TEST_ACTIVITY_BASE_1.CUSTOMER_CD
     ORDER BY DM_CUSTOMER_HST.X_AUD_FROM_TS ) AS COL_2   
FROM 
  ((
SELECT 
  FTB_TEST_ACTIVITY_BASE.COMPANY_CD AS COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.DIVISION_CD AS DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.SHOP_CD AS SHOP_CD ,
  FTB_TEST_ACTIVITY_BASE.LAPTOP_CD AS LAPTOP_CD ,
  FTB_TEST_ACTIVITY_BASE.CAMPAIGN_CD AS CAMPAIGN_CD ,
  FTB_TEST_ACTIVITY_BASE.EMPLOYEE_CD AS EMPLOYEE_CD ,
  FTB_TEST_ACTIVITY_BASE.PROMOTER_CD AS PROMOTER_CD ,
  FTB_TEST_ACTIVITY_BASE.LOCATION_TYPE_CD AS LOCATION_TYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.DAYCENTER_CD AS DAYCENTER_CD ,
  FTB_TEST_ACTIVITY_BASE.MEDIATYPE_CD AS MEDIATYPE_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_LEFT_CD AS TEST_RESULT_LEFT_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_RESULT_RIGHT_CD AS TEST_RESULT_RIGHT_CD ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_TEST_ACTIVITY_BASE.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_TEST_ACTIVITY_BASE.HEARING_LOSS_FL AS HEARING_LOSS_FL ,
  FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD AS MASTER_COMPANY_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD AS MASTER_DIVISION_CD ,
  FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD AS MASTER_CUSTOMER_CD ,
  FTB_TEST_ACTIVITY_BASE.TEST_TYPE_SK AS TEST_TYPE_SK ,
  FTB_TEST_ACTIVITY_BASE.TONAL_FL AS TONAL_FL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD IS NOT NULL 
     THEN CASE WHEN FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD is null 
               THEN STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.COMPANY_CD        || FTB_TEST_ACTIVITY_BASE.DIVISION_CD        || FTB_TEST_ACTIVITY_BASE.CUSTOMER_CD        )
               ELSE STANDARD_HASH (FTB_TEST_ACTIVITY_BASE.MASTER_COMPANY_CD || FTB_TEST_ACTIVITY_BASE.MASTER_DIVISION_CD || FTB_TEST_ACTIVITY_BASE.MASTER_CUSTOMER_CD )
          END
     ELSE STANDARD_HASH ('-1') 
END AS COL ,
  CASE WHEN FTB_TEST_ACTIVITY_BASE.SHOP_CD IS NOT NULL
     THEN STANDARD_HASH ( FTB_TEST_ACTIVITY_BASE.COMPANY_CD || FTB_TEST_ACTIVITY_BASE.DIVISION_CD || FTB_TEST_ACTIVITY_BASE.SHOP_CD )
     ELSE STANDARD_HASH ('-1')
END AS COL_1   
FROM 
  <?= odiRef.getObjectName("L", "FTB_TEST_ACTIVITY_BASE", "LOG_BDFL", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FTB_TEST_ACTIVITY_BASE  
  ) FTB_TEST_ACTIVITY_BASE_1  LEFT OUTER JOIN  (
SELECT 
  DISTINCT__RMAP_ES_CUSTOMER_STA.CUSTOMER_HK AS CUSTOMER_HK ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_ID AS STATUS_ID ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_FROM_DT AS STATUS_FROM_DT ,
  DISTINCT__RMAP_ES_CUSTOMER_STA.STATUS_TO_DT AS STATUS_TO_DT   
FROM 
  (
SELECT 
  DISTINCT 
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) AS COMPANY_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) AS DIVISION_CD ,
  (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD)) AS CUSTOMER_CD ,
  STANDARD_HASH((COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD)) || (COALESCE(UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE,CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD))) AS CUSTOMER_HK ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_TO_DT AS STATUS_TO_DT ,
  CASE WHEN CL_LIGHT_CUSTOMER_STATUS_RMA_1.STATUS_ID = 6 
     THEN COALESCE(CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_HEADER_DT, CL_LIGHT_CUSTOMER_STATUS_RMA_1.LAST_HA_ITEM_H_DT)
     ELSE NULL
END AS D_CLC_LAST_SALE_HOT_COLD_DT   
FROM 
  (
SELECT 
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD AS COMPANY_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.DIVISION_CD AS DIVISION_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.CUSTOMER_CD AS CUSTOMER_CD ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_ID AS STATUS_ID ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_FROM_DT AS STATUS_FROM_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.STATUS_TO_DT AS STATUS_TO_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_HEADER_DT AS LAST_HA_HEADER_DT ,
  CL_LIGHT_CUSTOMER_STATUS_RMAP_.LAST_HA_ITEM_H_DT AS LAST_HA_ITEM_H_DT   
FROM 
  <?= odiRef.getObjectName("L", "CL_LIGHT_CUSTOMER_STATUS", "LOG_EDW", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> CL_LIGHT_CUSTOMER_STATUS_RMAP_  
WHERE
  (CL_LIGHT_CUSTOMER_STATUS_RMAP_.COMPANY_CD='002'
) 
  ) CL_LIGHT_CUSTOMER_STATUS_RMA_1  LEFT OUTER JOIN  (
SELECT 
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL AS X_AUD_CURRENT_FL ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE AS COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_COMPANY_CODE AS MASTER_COMPANY_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_DIVISION_CODE AS MASTER_DIVISION_CODE ,
  UM_CU_S_CUSTOMER_MAPPING_RMAP_.MASTER_CUSTOMER_CODE AS MASTER_CUSTOMER_CODE   
FROM 
  <?= odiRef.getObjectName("L", "UM_CU_S_CUSTOMER_MAPPING", "LOG_EDW", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE") ?> UM_CU_S_CUSTOMER_MAPPING_RMAP_  
WHERE
  (UM_CU_S_CUSTOMER_MAPPING_RMAP_.X_AUD_CURRENT_FL=1 AND 
UM_CU_S_CUSTOMER_MAPPING_RMAP_.COMPANY_CODE='002'
) 
  ) UM_CU_S_CUSTOMER_MAPPING_RMA_1  
    ON  CL_LIGHT_CUSTOMER_STATUS_RMA_1.COMPANY_CD  = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_COMPANY_CODE  AND 
CL_LIGHT_CUSTOMER_STATUS_RMA_1.DIVISION_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_DIVISION_CODE AND
CL_LIGHT_CUSTOMER_STATUS_RMA_1.CUSTOMER_CD = UM_CU_S_CUSTOMER_MAPPING_RMA_1.MASTER_CUSTOMER_CODE
  ) DISTINCT__RMAP_ES_CUSTOMER_STA  
  ) DISTINCT__RMAP_ES_CUSTOMER_S_1  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL = DISTINCT__RMAP_ES_CUSTOMER_S_1.CUSTOMER_HK AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - #BDFL_AMP.V_TEST_LESS_DAYS >= DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_FROM_DT AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) - #BDFL_AMP.V_TEST_LESS_DAYS  < NVL(TRUNC(DISTINCT__RMAP_ES_CUSTOMER_S_1.STATUS_TO_DT), TO_DATE('2099-12-31', 'YYYY-MM-DD'))
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DM_CUSTOMER_HST", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> DM_CUSTOMER_HST  
    ON  FTB_TEST_ACTIVITY_BASE_1.COL                               = DM_CUSTOMER_HST.CUSTOMER_HK          AND
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) >= TRUNC(DM_CUSTOMER_HST.X_AUD_FROM_TS) AND 
TRUNC(FTB_TEST_ACTIVITY_BASE_1.ACTIVITY_DATE_DT) <= TRUNC(DM_CUSTOMER_HST.X_AUD_TO_TS)
  ) INLINE_VIEW  
WHERE
  (INLINE_VIEW.COL_2=1
) 
  ) INLINE_VIEW_1  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DM_SHOP", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> DM_SHOP  
    ON  DM_SHOP.SHOP_HK = INLINE_VIEW_1.COL_1
     )  
    ON  INLINE_VIEW_1.COMPANY_CD  = FT_CUSTOMER_BASE.COMPANY_CD   and
INLINE_VIEW_1.DIVISION_CD = FT_CUSTOMER_BASE.DIVISION_CD  and 
INLINE_VIEW_1.CUSTOMER_CD = FT_CUSTOMER_BASE.CUSTOMER_CD  AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - #BDFL_AMP.V_TEST_LESS_DAYS >= FT_CUSTOMER_BASE.VALID_FROM_DT AND
TRUNC(INLINE_VIEW_1.ACTIVITY_DATE_DT)  - #BDFL_AMP.V_TEST_LESS_DAYS  < FT_CUSTOMER_BASE.VALID_TO_DT
     )  
    ON  FTB_ACTIVITY_BASE_1.COMPANY_CD =  INLINE_VIEW_1.COMPANY_CD  
AND FTB_ACTIVITY_BASE_1.DIVISION_CD = INLINE_VIEW_1.DIVISION_CD 
AND FTB_ACTIVITY_BASE_1.CUSTOMER_CD = INLINE_VIEW_1.CUSTOMER_CD
     )  LEFT OUTER JOIN  <?= odiRef.getObjectName("L", "DM_CLC_STATUS", "LOG_BDFL_DMM", "D") ?> DM_CLC_STATUS  
    ON  DM_CLC_STATUS.CLC_STATUS_HK = CAST(STANDARD_HASH(NVL(INLINE_VIEW_1.STATUS_ID, 1)) AS VARCHAR2(63 CHAR) )
  ) INLINE_VIEW_2  LEFT OUTER JOIN  (
SELECT 
  CF_LAST_SALE_AGING_RANGE.COMPANY_CD AS COMPANY_CD ,
  CF_LAST_SALE_AGING_RANGE.DIVISION_CD AS DIVISION_CD ,
  CF_LAST_SALE_AGING_RANGE.AGE_CD AS AGE_CD ,
  CF_LAST_SALE_AGING_RANGE.AGING_CLUSTER_CD AS AGING_CLUSTER_CD   
FROM 
  <?= odiRef.getObjectName("L", "CF_LAST_SALE_AGING_RANGE", "LOG_BDFL_DMM", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE") ?> CF_LAST_SALE_AGING_RANGE  
WHERE
  (CF_LAST_SALE_AGING_RANGE.COMPANY_CD = '002'
) 
  ) CF_LAST_SALE_AGING_RANGE_1  
    ON  CF_LAST_SALE_AGING_RANGE_1.COMPANY_CD || '@' || CF_LAST_SALE_AGING_RANGE_1.AGE_CD = INLINE_VIEW_2.COL_5
AND INLINE_VIEW_2.DIVISION_CD_2 = CF_LAST_SALE_AGING_RANGE_1.DIVISION_CD
  ) INLINE_VIEW_3  LEFT OUTER JOIN  (
SELECT 
  FTB_ACTIVITY_BASE1.COMPANY_CD AS COMPANY_CD ,
  FTB_ACTIVITY_BASE1.DIVISION_CD AS DIVISION_CD ,
  FTB_ACTIVITY_BASE1.ACTIVITY_ID AS ACTIVITY_ID ,
  FTB_ACTIVITY_BASE1.ACTIVITY_DATE_DT AS ACTIVITY_DATE_DT ,
  FTB_ACTIVITY_BASE1.CUSTOMER_CD AS CUSTOMER_CD ,
  FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD AS ACTIVITY_TYPE_CD ,
  FTB_ACTIVITY_BASE1.MEDIATYPE_CD AS MEDIATYPE_CD   
FROM 
  <?= odiRef.getObjectName("L", "FTB_ACTIVITY_BASE", "LOG_BDFL", "", "D", "P", "#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET") ?> FTB_ACTIVITY_BASE1  
WHERE
  (FTB_ACTIVITY_BASE1.ACTIVITY_TYPE_CD <> 'TS'
AND FTB_ACTIVITY_BASE1.MEDIATYPE_CD IS NOT NULL
) 
  ) FTB_ACTIVITY_BASE1_1  
    ON  FTB_ACTIVITY_BASE1_1.COMPANY_CD =  INLINE_VIEW_3.COMPANY_CD_3  
AND FTB_ACTIVITY_BASE1_1.DIVISION_CD = INLINE_VIEW_3.DIVISION_CD_3 
AND FTB_ACTIVITY_BASE1_1.CUSTOMER_CD = INLINE_VIEW_3.CUSTOMER_CD_2
  ) INLINE_VIEW_4
where		(1=1)	
 and (INLINE_VIEW_4.COL_8 = 1)
)  ODI_GET_FROM
   ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e5b34ad8-8480-4dc6-8620-ad7901fe4fb4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[240]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Insert new rows]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[alter table <?= odiRef.getObjectName("L", "FT_TEST_ACTIVITY", "LOG_BDFL_DMM", "D") ?> truncate partition (#BDFL_AMP.V_CONTEXT_PARTITION_CODE_TARGET)  ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[38750f41-9539-4b9e-8265-27bdf94c6aad]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Truncate target table partition]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[IKM Oracle Control Append for BDFL (multi-partition)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[J]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0c0aed6c-ea8b-4d34-a4b2-01d25c10759e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_EDW_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[2]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[GENERIC_SQL]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
<?
String dblinkToSrc = "";
if ("".equals(dblinkToSrc)) {
  dblinkToSrc = odiRef.getInfo("SRC_LSCHEMA_NAME");
}
if ("TRUE".equals("TRUE")) {
  dblinkToSrc += "%UNIQUE_SESSION_TAG";
}
dblinkToSrc = dblinkToSrc.replaceAll(" ","");
dblinkToSrc = dblinkToSrc.replaceAll("-","");
dblinkToSrc = odiRef.getFormattedName(dblinkToSrc);
String srcUserName = odiRef.getInfo("SRC_USER_NAME");
String srcServerInstance = odiRef.getInfo("SRC_DSERV_NAME");
String srcSID = "";
if (srcServerInstance != null && srcServerInstance.trim().length() != 0) {
  srcSID = srcServerInstance;
} else {
  String srcJDBCURL = odiRef.getInfo("SRC_JAVA_URL");
  if (srcJDBCURL !=null && srcJDBCURL.trim().length() != 0) {
    srcSID = srcJDBCURL.substring(srcJDBCURL.lastIndexOf("@") + 1);
    srcSID = srcSID.substring(srcSID.lastIndexOf(":") + 1);
    if (srcSID.lastIndexOf("/") >= 0){
      srcSID = srcSID.substring(srcSID.lastIndexOf("/") + 1);
    }
  }
}
srcSID = srcSID.trim();
if (srcSID.length() == 0) {
  throw new OdiKMException("Failed calculating source SID.");
}
?>
create database link <?=dblinkToSrc ?> connect to <?=srcUserName ?> identified by <@=odiRef.getInfo("SRC_PASS") @> using '<?=srcSID ?>'
       ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b273bf57-34c5-44d7-8289-97374f135b08]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EB]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Create database link to source]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[LKM Oracle to Oracle Pull (DB Link)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1b36bebb-eb0e-49ca-9c04-156e016f0cd6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[MAP_CLEANUP]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefTechIntName" type="java.lang.String">null</Field>
	<Field name="DefTxt" type="java.lang.String">null</Field>
	<Field name="ExeChannel" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2d5bd3ae-8df7-4813-9dc9-a3bee644e917]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[SERIAL]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[EU]]></Field>
	<Field name="TaskName3" type="java.lang.String"><![CDATA[LOG_EDW_UNIT]]></Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[L]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpScenTask">
		<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColEncKey" type="java.lang.String">null</Field>
	<Field name="ColEncKeyVect" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColIsolLevel" type="java.lang.String"><![CDATA[D]]></Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[LOG_EDW]]></Field>
	<Field name="ColTechIntName" type="java.lang.String">null</Field>
	<Field name="ColTxt" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefEncKey" type="java.lang.String">null</Field>
	<Field name="DefEncKeyVect" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIndEnc" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefIsolLevel" type="java.lang.String"><![CDATA[2]]></Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[LOG_BDFL_DMM]]></Field>
	<Field name="DefTechIntName" type="java.lang.String"><![CDATA[GENERIC_SQL]]></Field>
	<Field name="DefTxt" type="java.lang.String"><![CDATA[
<?
String dblinkToSrc = "";
if ("".equals(dblinkToSrc)) {
  dblinkToSrc = odiRef.getInfo("SRC_LSCHEMA_NAME");
}
if ("TRUE".equals("TRUE")) {
  dblinkToSrc += "%UNIQUE_SESSION_TAG";
}
dblinkToSrc = dblinkToSrc.replaceAll(" ","");
dblinkToSrc = dblinkToSrc.replaceAll("-","");
dblinkToSrc = odiRef.getFormattedName(dblinkToSrc);
?>
drop database link <?=dblinkToSrc ?>
       ]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b01effb3-eb84-45f2-aed4-9bddbbd514b6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="Nno" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="ParScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="ScenNo" type="com.sunopsis.sql.DbInt"><![CDATA[14823]]></Field>
	<Field name="ScenTaskNo" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="TaskName1" type="java.lang.String"><![CDATA[Drop database link to source]]></Field>
	<Field name="TaskName2" type="java.lang.String"><![CDATA[LKM Oracle to Oracle Pull (DB Link)]]></Field>
	<Field name="TaskName3" type="java.lang.String">null</Field>
	<Field name="TaskType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PACKAGE.9251]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3b9b1045-d41f-4e38-86c7-aa807409888d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[BDFL_AMP.DMM_BDL_ES.PKG_BDL_ES_2_FT_TEST_ACTIVITY]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER.SNP_PACKAGE]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[8.10.29]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCEN.14823]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[21c978c2-5e38-45fe-9f20-de81c038fbee]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[BDFL_AMP.DMM_BDL_ES.PKG_BDL_ES_2_FT_TEST_ACTIVITY.PKG_BDL_ES_2_FT_TEST_ACTIVITY Version 001]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER.SNP_PACKAGE.SNP_SCEN]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[8.10.29.41]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_EXPTXTHEADER.65166]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4e248013-deaa-4bb3-9d12-95cee5482adb]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14823.0]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[20bef831-9433-466f-97a3-1c27272d7956]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14823.1]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7961ebf4-7b65-4481-b7cf-b71d3a0452dc]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14823.2]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9de6153a-19ed-42ef-926b-e559eebc94c4]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14823.3]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1ab5e2dc-fcc6-40ae-b7d8-de7612d597e0]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_SCENSTEP.14823.4]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[dc3ff38e-5129-4386-93dc-2d46c591583c]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpImportRep">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b0077bd8-1c01-492b-8c65-75d562351aca]]></Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepShortId" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="RepTimestamp" type="java.lang.String"><![CDATA[1510079777723]]></Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[76]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.09]]></Field>
</Object>
</SunopsisExport>
